<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>19 Nominal Predictors | (Re)Doing Bayesain Data Analysis</title>
  <meta name="description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="19 Nominal Predictors | (Re)Doing Bayesain Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19 Nominal Predictors | (Re)Doing Bayesain Data Analysis" />
  
  <meta name="twitter:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

<meta name="author" content="R Pruim">


<meta name="date" content="2019-04-24">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="multiple-metric-predictors.html">
<link rel="next" href="multiple-nominal-predictors.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">(Re)Doing Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What’s in These Notes</a></li>
<li class="part"><span><b>I The Basics: Models, Probability, Bayes, and R</b></span></li>
<li class="chapter" data-level="2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.1</b> The Steps of Bayesian Data Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-code"><i class="fa fa-check"></i><b>2.1.1</b> R code</a></li>
<li class="chapter" data-level="2.1.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-packages"><i class="fa fa-check"></i><b>2.1.2</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-1-which-coin-is-it"><i class="fa fa-check"></i><b>2.2</b> Example 1: Which coin is it?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#freedom-of-choice"><i class="fa fa-check"></i><b>2.2.1</b> Freedom of choice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#distributions"><i class="fa fa-check"></i><b>2.3</b> Distributions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#beta-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Beta distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#normal-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-2-height-vs-weight"><i class="fa fa-check"></i><b>2.4</b> Example 2: Height vs Weight</a><ul>
<li class="chapter" data-level="2.4.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#data"><i class="fa fa-check"></i><b>2.4.1</b> Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#describing-a-model-for-the-relationship-between-height-and-weight"><i class="fa fa-check"></i><b>2.4.2</b> Describing a model for the relationship between height and weight</a></li>
<li class="chapter" data-level="2.4.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#prior"><i class="fa fa-check"></i><b>2.4.3</b> Prior</a></li>
<li class="chapter" data-level="2.4.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior"><i class="fa fa-check"></i><b>2.4.4</b> Posterior</a></li>
<li class="chapter" data-level="2.4.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior-predictive-check"><i class="fa fa-check"></i><b>2.4.5</b> Posterior Predictive Check</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#where-do-we-go-from-here"><i class="fa fa-check"></i><b>2.5</b> Where do we go from here?</a></li>
<li class="chapter" data-level="2.6" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#ch02-exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
<li class="chapter" data-level="2.7" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#footnotes"><i class="fa fa-check"></i><b>2.7</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html"><i class="fa fa-check"></i><b>3</b> Some Useful Bits of R</a><ul>
<li class="chapter" data-level="3.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#style-guide"><i class="fa fa-check"></i><b>3.1</b> You Gotta Have Style</a><ul>
<li class="chapter" data-level="3.1.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#an-additional-note-about-homework"><i class="fa fa-check"></i><b>3.1.1</b> An additional note about homework</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors-lists-and-data-frames"><i class="fa fa-check"></i><b>3.2</b> Vectors, Lists, and Data Frames</a><ul>
<li class="chapter" data-level="3.2.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#lists"><i class="fa fa-check"></i><b>3.2.2</b> Lists</a></li>
<li class="chapter" data-level="3.2.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#data-frames-for-rectangular-data"><i class="fa fa-check"></i><b>3.2.3</b> Data frames for rectangular data</a></li>
<li class="chapter" data-level="3.2.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#other-types-of-data"><i class="fa fa-check"></i><b>3.2.4</b> Other types of data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#plotting-with-ggformula"><i class="fa fa-check"></i><b>3.3</b> Plotting with ggformula</a></li>
<li class="chapter" data-level="3.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#creating-data-with-expand.grid"><i class="fa fa-check"></i><b>3.4</b> Creating data with expand.grid()</a></li>
<li class="chapter" data-level="3.5" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#transforming-and-summarizing-data-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.5</b> Transforming and summarizing data dplyr and tidyr</a></li>
<li class="chapter" data-level="3.6" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#writing-functions"><i class="fa fa-check"></i><b>3.6</b> Writing Functions</a><ul>
<li class="chapter" data-level="3.6.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#why-write-functions"><i class="fa fa-check"></i><b>3.6.1</b> Why write functions?</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#function-parts"><i class="fa fa-check"></i><b>3.6.2</b> Function parts</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#the-function-function-has-its-function"><i class="fa fa-check"></i><b>3.6.3</b> The function() function has its function</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#some-common-error-messages"><i class="fa fa-check"></i><b>3.7</b> Some common error messages</a><ul>
<li class="chapter" data-level="3.7.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#object-not-found"><i class="fa fa-check"></i><b>3.7.1</b> object not found</a></li>
<li class="chapter" data-level="3.7.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#any-message-mentioning-yaml"><i class="fa fa-check"></i><b>3.7.2</b> Any message mentioning yaml</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#ch03-exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#footnotes-1"><i class="fa fa-check"></i><b>3.9</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a><ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#some-terminology"><i class="fa fa-check"></i><b>4.1</b> Some terminology</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#distributions-in-r"><i class="fa fa-check"></i><b>4.2</b> Distributions in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#example-normal-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Example: Normal distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability.html"><a href="probability.html#simulating-running-proportions"><i class="fa fa-check"></i><b>4.2.2</b> Simulating running proportions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#joint-marginal-and-conditional-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint, marginal, and conditional distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability.html"><a href="probability.html#example-hair-and-eye-color"><i class="fa fa-check"></i><b>4.3.1</b> Example: Hair and eye color</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability.html"><a href="probability.html#independence"><i class="fa fa-check"></i><b>4.3.2</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#ch04-exercises"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#footnotes-2"><i class="fa fa-check"></i><b>4.5</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule and the Grid Method</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#the-big-bayesian-idea"><i class="fa fa-check"></i><b>5.1</b> The Big Bayesian Idea</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#likelihood"><i class="fa fa-check"></i><b>5.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="5.1.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#when-bayes-is-easy"><i class="fa fa-check"></i><b>5.1.2</b> When Bayes is easy</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#estimating-the-bias-in-a-coin-using-the-grid-method"><i class="fa fa-check"></i><b>5.2</b> Estimating the bias in a coin using the Grid Method</a><ul>
<li class="chapter" data-level="5.2.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#creating-a-grid"><i class="fa fa-check"></i><b>5.2.1</b> Creating a Grid</a></li>
<li class="chapter" data-level="5.2.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#hdi-from-the-grid"><i class="fa fa-check"></i><b>5.2.2</b> HDI from the grid</a></li>
<li class="chapter" data-level="5.2.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#automating-the-grid"><i class="fa fa-check"></i><b>5.2.3</b> Automating the grid</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#working-on-the-log-scale"><i class="fa fa-check"></i><b>5.3</b> Working on the log scale</a></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#discrete-params"><i class="fa fa-check"></i><b>5.4</b> Discrete Parameters</a></li>
<li class="chapter" data-level="5.5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#ch05-exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
<li class="chapter" data-level="5.6" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#footnotes-3"><i class="fa fa-check"></i><b>5.6</b> Footnotes</a></li>
</ul></li>
<li class="part"><span><b>II Inferring a Binomial Probability</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-distributions-1"><i class="fa fa-check"></i><b>6.1</b> Beta distributions</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-and-bayes"><i class="fa fa-check"></i><b>6.2</b> Beta and Bayes</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-bernoulli-likelihood-function"><i class="fa fa-check"></i><b>6.2.1</b> The Bernoulli likelihood function</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-convenient-prior"><i class="fa fa-check"></i><b>6.2.2</b> A convenient prior</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#pros-and-cons-of-conjugate-priors"><i class="fa fa-check"></i><b>6.2.3</b> Pros and Cons of conjugate priors</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#getting-to-know-the-beta-distributions"><i class="fa fa-check"></i><b>6.3</b> Getting to know the Beta distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#important-facts"><i class="fa fa-check"></i><b>6.3.1</b> Important facts</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#alternative-parameterizations-of-beta-distributions"><i class="fa fa-check"></i><b>6.3.2</b> Alternative parameterizations of Beta distributions</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta_params"><i class="fa fa-check"></i><b>6.3.3</b> beta_params()</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#automating-bayesian-updates-for-a-proportion-beta-prior"><i class="fa fa-check"></i><b>6.3.4</b> Automating Bayesian updates for a proportion (beta prior)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#what-if-the-prior-isnt-a-beta-distribution"><i class="fa fa-check"></i><b>6.4</b> What if the prior isn’t a beta distribution?</a></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#ch06-exercises"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo (MCMC)</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#king-markov-and-adviser-metropolis"><i class="fa fa-check"></i><b>7.1</b> King Markov and Adviser Metropolis</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#quick-intro-to-markov-chains"><i class="fa fa-check"></i><b>7.2</b> Quick Intro to Markov Chains</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#more-info-please"><i class="fa fa-check"></i><b>7.2.1</b> More info, please</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#definition"><i class="fa fa-check"></i><b>7.2.2</b> Definition</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#time-homogeneous-markov-chains"><i class="fa fa-check"></i><b>7.2.3</b> Time-Homogeneous Markov Chains</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#matrix-representation"><i class="fa fa-check"></i><b>7.2.4</b> Matrix representation</a></li>
<li class="chapter" data-level="7.2.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#regular-markov-chains"><i class="fa fa-check"></i><b>7.2.5</b> Regular Markov Chains</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#back-to-king-markov"><i class="fa fa-check"></i><b>7.3</b> Back to King Markov</a></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#how-well-does-the-metropolis-algorithm-work"><i class="fa fa-check"></i><b>7.4</b> How well does the Metropolis Algorithm work?</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-to-any-island"><i class="fa fa-check"></i><b>7.4.1</b> Jumping to any island</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-only-to-neighbor-islands"><i class="fa fa-check"></i><b>7.4.2</b> Jumping only to neighbor islands</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#markov-chains-and-posterior-sampling"><i class="fa fa-check"></i><b>7.5</b> Markov Chains and Posterior Sampling</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-1-estimating-a-proportion"><i class="fa fa-check"></i><b>7.5.1</b> Example 1: Estimating a proportion</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-2-estimating-mean-and-variance"><i class="fa fa-check"></i><b>7.5.2</b> Example 2: Estimating mean and variance</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#issues-with-metropolis-algorithm"><i class="fa fa-check"></i><b>7.5.3</b> Issues with Metropolis Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#two-coins"><i class="fa fa-check"></i><b>7.6</b> Two coins</a><ul>
<li class="chapter" data-level="7.6.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#the-model"><i class="fa fa-check"></i><b>7.6.1</b> The model</a></li>
<li class="chapter" data-level="7.6.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#exact-analysis"><i class="fa fa-check"></i><b>7.6.2</b> Exact analysis</a></li>
<li class="chapter" data-level="7.6.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#metropolis"><i class="fa fa-check"></i><b>7.6.3</b> Metropolis</a></li>
<li class="chapter" data-level="7.6.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#gibbs-sampling"><i class="fa fa-check"></i><b>7.6.4</b> Gibbs sampling</a></li>
<li class="chapter" data-level="7.6.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#advantages-and-disadvantages-of-gibbs-vs-metropolis"><i class="fa fa-check"></i><b>7.6.5</b> Advantages and Disadvantages of Gibbs vs Metropolis</a></li>
<li class="chapter" data-level="7.6.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#so-what-do-we-learn-about-the-coins"><i class="fa fa-check"></i><b>7.6.6</b> So what do we learn about the coins?</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-posterior-sampling-big-picture"><i class="fa fa-check"></i><b>7.7</b> MCMC posterior sampling: Big picture</a><ul>
<li class="chapter" data-level="7.7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-markov-chain-monte-carlo"><i class="fa fa-check"></i><b>7.7.1</b> MCMC = Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="7.7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#posterior-sampling-random-walk-through-the-posterior"><i class="fa fa-check"></i><b>7.7.2</b> Posterior sampling: Random walk through the posterior</a></li>
<li class="chapter" data-level="7.7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#where-do-we-go-from-here-1"><i class="fa fa-check"></i><b>7.7.3</b> Where do we go from here?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#ch07-exercises"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html"><i class="fa fa-check"></i><b>8</b> JAGS – Just Another Gibbs Sampler</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#what-jags-is"><i class="fa fa-check"></i><b>8.1</b> What JAGS is</a><ul>
<li class="chapter" data-level="8.1.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#jags-documentation"><i class="fa fa-check"></i><b>8.1.1</b> JAGS documentation</a></li>
<li class="chapter" data-level="8.1.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#updating-c-and-clang"><i class="fa fa-check"></i><b>8.1.2</b> Updating C and CLANG</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-1-estimating-a-proportion-1"><i class="fa fa-check"></i><b>8.2</b> Example 1: estimating a proportion</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-1"><i class="fa fa-check"></i><b>8.2.1</b> The Model</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#load-data"><i class="fa fa-check"></i><b>8.2.2</b> Load Data</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#specify-the-model"><i class="fa fa-check"></i><b>8.2.3</b> Specify the model</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#run-the-model"><i class="fa fa-check"></i><b>8.2.4</b> Run the model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#extracting-information-from-a-jags-run"><i class="fa fa-check"></i><b>8.3</b> Extracting information from a JAGS run</a><ul>
<li class="chapter" data-level="8.3.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#posterior-1"><i class="fa fa-check"></i><b>8.3.1</b> posterior()</a></li>
<li class="chapter" data-level="8.3.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#side-note-posterior-sampling-and-the-grid-method"><i class="fa fa-check"></i><b>8.3.2</b> Side note: posterior sampling and the grid method</a></li>
<li class="chapter" data-level="8.3.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-coda"><i class="fa fa-check"></i><b>8.3.3</b> Using coda</a></li>
<li class="chapter" data-level="8.3.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-bayesplot"><i class="fa fa-check"></i><b>8.3.4</b> Using bayesplot</a></li>
<li class="chapter" data-level="8.3.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-kruschkes-functions"><i class="fa fa-check"></i><b>8.3.5</b> Using Kruschke’s functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#optional-arguments-to-jags"><i class="fa fa-check"></i><b>8.4</b> Optional arguments to jags()</a><ul>
<li class="chapter" data-level="8.4.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#number-and-size-of-chains"><i class="fa fa-check"></i><b>8.4.1</b> Number and size of chains</a></li>
<li class="chapter" data-level="8.4.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#starting-point-for-chains"><i class="fa fa-check"></i><b>8.4.2</b> Starting point for chains</a></li>
<li class="chapter" data-level="8.4.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#running-chains-in-parallel"><i class="fa fa-check"></i><b>8.4.3</b> Running chains in parallel</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-2-comparing-two-proportions"><i class="fa fa-check"></i><b>8.5</b> Example 2: comparing two proportions</a><ul>
<li class="chapter" data-level="8.5.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-data"><i class="fa fa-check"></i><b>8.5.1</b> The data</a></li>
<li class="chapter" data-level="8.5.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-2"><i class="fa fa-check"></i><b>8.5.2</b> The model</a></li>
<li class="chapter" data-level="8.5.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#describing-the-model-to-jags"><i class="fa fa-check"></i><b>8.5.3</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="8.5.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#fitting-the-model"><i class="fa fa-check"></i><b>8.5.4</b> Fitting the model</a></li>
<li class="chapter" data-level="8.5.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#inspecting-the-results"><i class="fa fa-check"></i><b>8.5.5</b> Inspecting the results</a></li>
<li class="chapter" data-level="8.5.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#difference-in-proportions"><i class="fa fa-check"></i><b>8.5.6</b> Difference in proportions</a></li>
<li class="chapter" data-level="8.5.7" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#sampling-from-the-prior"><i class="fa fa-check"></i><b>8.5.7</b> Sampling from the prior</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#ch08-exercises"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="heierarchical-models.html"><a href="heierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Heierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#gamma-distributions"><i class="fa fa-check"></i><b>9.1</b> Gamma Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#one-coin-from-one-mint"><i class="fa fa-check"></i><b>9.2</b> One coin from one mint</a></li>
<li class="chapter" data-level="9.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-one-mint"><i class="fa fa-check"></i><b>9.3</b> Multiple coins from one mint</a></li>
<li class="chapter" data-level="9.4" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-multiple-mints"><i class="fa fa-check"></i><b>9.4</b> Multiple coins from multiple mints</a></li>
<li class="chapter" data-level="9.5" data-path="heierarchical-models.html"><a href="heierarchical-models.html#therapeutic-touch"><i class="fa fa-check"></i><b>9.5</b> Therapeutic Touch</a><ul>
<li class="chapter" data-level="9.5.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#abstract"><i class="fa fa-check"></i><b>9.5.1</b> Abstract</a></li>
<li class="chapter" data-level="9.5.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#data-1"><i class="fa fa-check"></i><b>9.5.2</b> Data</a></li>
<li class="chapter" data-level="9.5.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#a-heierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> A heierarchical model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="heierarchical-models.html"><a href="heierarchical-models.html#other-parameterizations-we-might-have-tried"><i class="fa fa-check"></i><b>9.6</b> Other parameterizations we might have tried</a><ul>
<li class="chapter" data-level="9.6.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shape-parameters-for-beta"><i class="fa fa-check"></i><b>9.6.1</b> Shape parameters for Beta</a></li>
<li class="chapter" data-level="9.6.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#mean-instead-of-mode"><i class="fa fa-check"></i><b>9.6.2</b> Mean instead of mode</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shrinkage"><i class="fa fa-check"></i><b>9.7</b> Shrinkage</a></li>
<li class="chapter" data-level="9.8" data-path="heierarchical-models.html"><a href="heierarchical-models.html#example-baseball-batting-average"><i class="fa fa-check"></i><b>9.8</b> Example: Baseball Batting Average</a></li>
<li class="chapter" data-level="9.9" data-path="heierarchical-models.html"><a href="heierarchical-models.html#ch09-exercises"><i class="fa fa-check"></i><b>9.9</b> Exerciess</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> (Model Comparison)</a></li>
<li class="chapter" data-level="11" data-path="nhst.html"><a href="nhst.html"><i class="fa fa-check"></i><b>11</b> (NHST)</a></li>
<li class="chapter" data-level="12" data-path="point-null-hypotheses.html"><a href="point-null-hypotheses.html"><i class="fa fa-check"></i><b>12</b> (Point Null Hypotheses)</a></li>
<li class="chapter" data-level="13" data-path="goals-power-sample-size.html"><a href="goals-power-sample-size.html"><i class="fa fa-check"></i><b>13</b> (Goals, Power, Sample Size)</a></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#why-stan-might-work-better"><i class="fa fa-check"></i><b>14.1</b> Why Stan might work better</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#describing-a-model-to-stan"><i class="fa fa-check"></i><b>14.2</b> Describing a model to Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#samping-from-the-prior"><i class="fa fa-check"></i><b>14.3</b> Samping from the prior</a></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#ch14-exercises"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glm-overview.html"><a href="glm-overview.html"><i class="fa fa-check"></i><b>15</b> GLM Overview</a><ul>
<li class="chapter" data-level="15.1" data-path="glm-overview.html"><a href="glm-overview.html#data-consists-of-observations-of-variables"><i class="fa fa-check"></i><b>15.1</b> Data consists of observations of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="glm-overview.html"><a href="glm-overview.html#variable-roles"><i class="fa fa-check"></i><b>15.1.1</b> Variable Roles</a></li>
<li class="chapter" data-level="15.1.2" data-path="glm-overview.html"><a href="glm-overview.html#types-of-variables"><i class="fa fa-check"></i><b>15.1.2</b> Types of Variables</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="glm-overview.html"><a href="glm-overview.html#glm-framework"><i class="fa fa-check"></i><b>15.2</b> GLM Framework</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html"><i class="fa fa-check"></i><b>16</b> Estimating One and Two Means</a><ul>
<li class="chapter" data-level="16.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#basic-model-for-two-means"><i class="fa fa-check"></i><b>16.1</b> Basic Model for Two Means</a><ul>
<li class="chapter" data-level="16.1.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-2"><i class="fa fa-check"></i><b>16.1.1</b> Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model"><i class="fa fa-check"></i><b>16.1.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#an-old-sleep-study"><i class="fa fa-check"></i><b>16.2</b> An Old Sleep Study</a><ul>
<li class="chapter" data-level="16.2.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-3"><i class="fa fa-check"></i><b>16.2.1</b> Data</a></li>
<li class="chapter" data-level="16.2.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model-1"><i class="fa fa-check"></i><b>16.2.2</b> Model</a></li>
<li class="chapter" data-level="16.2.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#separate-standard-deviations-for-each-group"><i class="fa fa-check"></i><b>16.2.3</b> Separate standard deviations for each group</a></li>
<li class="chapter" data-level="16.2.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#comparison-to-t-test"><i class="fa fa-check"></i><b>16.2.4</b> Comparison to t-test</a></li>
<li class="chapter" data-level="16.2.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#rope-region-of-practical-equivalence"><i class="fa fa-check"></i><b>16.2.5</b> ROPE (Region of Practical Equivalence)</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#variations-on-the-theme"><i class="fa fa-check"></i><b>16.3</b> Variations on the theme</a><ul>
<li class="chapter" data-level="16.3.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-distributions-for-the-response"><i class="fa fa-check"></i><b>16.3.1</b> Other distributions for the response</a></li>
<li class="chapter" data-level="16.3.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-priors-for-sigma-or-tau"><i class="fa fa-check"></i><b>16.3.2</b> Other Priors for <span class="math inline">\(\sigma\)</span> (or <span class="math inline">\(\tau\)</span>)</a></li>
<li class="chapter" data-level="16.3.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#paired-comparisons"><i class="fa fa-check"></i><b>16.3.3</b> Paired Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#how-many-chains-how-long"><i class="fa fa-check"></i><b>16.4</b> How many chains? How long?</a><ul>
<li class="chapter" data-level="16.4.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#why-multiple-chains"><i class="fa fa-check"></i><b>16.4.1</b> Why multiple chains?</a></li>
<li class="chapter" data-level="16.4.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#what-large-n.eff-does-and-doesnt-do-for-us"><i class="fa fa-check"></i><b>16.4.2</b> What large n.eff does and doesn’t do for us</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#looking-at-likelihood"><i class="fa fa-check"></i><b>16.5</b> Looking at Likelihood</a></li>
<li class="chapter" data-level="16.6" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#ch16-exercises"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>17</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="17.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-deluxe-basic-model"><i class="fa fa-check"></i><b>17.1</b> The deluxe basic model</a><ul>
<li class="chapter" data-level="17.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#likelihood-1"><i class="fa fa-check"></i><b>17.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="17.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#priors"><i class="fa fa-check"></i><b>17.1.2</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#example-galtons-data"><i class="fa fa-check"></i><b>17.2</b> Example: Galton’s Data</a><ul>
<li class="chapter" data-level="17.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#describing-the-model-to-jags-1"><i class="fa fa-check"></i><b>17.2.1</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="17.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#problems-and-how-to-fix-them"><i class="fa fa-check"></i><b>17.2.2</b> Problems and how to fix them</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#centering-and-standardizing"><i class="fa fa-check"></i><b>17.3</b> Centering and Standardizing</a><ul>
<li class="chapter" data-level="17.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#beta_0-and-beta_1-are-still-correlated"><i class="fa fa-check"></i><b>17.3.1</b> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are still correlated</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#weve-fit-a-model-now-what"><i class="fa fa-check"></i><b>17.4</b> We’ve fit a model, now what?</a><ul>
<li class="chapter" data-level="17.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#estimate-parameters"><i class="fa fa-check"></i><b>17.4.1</b> Estimate parameters</a></li>
<li class="chapter" data-level="17.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#make-predictions"><i class="fa fa-check"></i><b>17.4.2</b> Make predictions</a></li>
<li class="chapter" data-level="17.4.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>17.4.3</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="17.4.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#posterior-predictive-checks-with-bayesplot"><i class="fa fa-check"></i><b>17.4.4</b> Posterior predictive checks with bayesplot</a></li>
<li class="chapter" data-level="17.4.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#ppc-with-custom-data"><i class="fa fa-check"></i><b>17.4.5</b> PPC with custom data</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#fitting-models-with-stan"><i class="fa fa-check"></i><b>17.5</b> Fitting models with Stan</a></li>
<li class="chapter" data-level="17.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#two-intercepts-model"><i class="fa fa-check"></i><b>17.6</b> Two Intercepts model</a></li>
<li class="chapter" data-level="17.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#ch17-exercises"><i class="fa fa-check"></i><b>17.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat"><i class="fa fa-check"></i><b>18.1</b> SAT</a><ul>
<li class="chapter" data-level="18.1.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-vs-expenditure"><i class="fa fa-check"></i><b>18.1.1</b> SAT vs expenditure</a></li>
<li class="chapter" data-level="18.1.2" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-vs-expenditure-and-percent-taking-the-test"><i class="fa fa-check"></i><b>18.1.2</b> SAT vs expenditure and percent taking the test</a></li>
<li class="chapter" data-level="18.1.3" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#whats-wrong-with-this-picture"><i class="fa fa-check"></i><b>18.1.3</b> What’s wrong with this picture?</a></li>
<li class="chapter" data-level="18.1.4" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#multiple-predictors-in-pictures"><i class="fa fa-check"></i><b>18.1.4</b> Multiple predictors in pictures</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#interaction"><i class="fa fa-check"></i><b>18.2</b> Interaction</a><ul>
<li class="chapter" data-level="18.2.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-with-interaction-term"><i class="fa fa-check"></i><b>18.2.1</b> SAT with interaction term</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#fitting-a-linear-model-with-brms"><i class="fa fa-check"></i><b>18.3</b> Fitting a linear model with brms</a><ul>
<li class="chapter" data-level="18.3.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#adjusting-the-model-with-brm"><i class="fa fa-check"></i><b>18.3.1</b> Adjusting the model with brm()</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#interpretting-a-model-with-an-interaction-term"><i class="fa fa-check"></i><b>18.4</b> Interpretting a model with an interaction term</a><ul>
<li class="chapter" data-level="18.4.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#thinking-about-the-noise"><i class="fa fa-check"></i><b>18.4.1</b> Thinking about the noise</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#ch18-exercises"><i class="fa fa-check"></i><b>18.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="nominal-predictors.html"><a href="nominal-predictors.html"><i class="fa fa-check"></i><b>19</b> Nominal Predictors</a><ul>
<li class="chapter" data-level="19.1" data-path="nominal-predictors.html"><a href="nominal-predictors.html#fruit-flies-study"><i class="fa fa-check"></i><b>19.1</b> Fruit flies Study</a></li>
<li class="chapter" data-level="19.2" data-path="nominal-predictors.html"><a href="nominal-predictors.html#model-1-out-of-the-box"><i class="fa fa-check"></i><b>19.2</b> Model 1: Out-of-the-box</a></li>
<li class="chapter" data-level="19.3" data-path="nominal-predictors.html"><a href="nominal-predictors.html#model-2-custom-priors"><i class="fa fa-check"></i><b>19.3</b> Model 2: Custom Priors</a></li>
<li class="chapter" data-level="19.4" data-path="nominal-predictors.html"><a href="nominal-predictors.html#models-3-and-4-alternate-parameterizations"><i class="fa fa-check"></i><b>19.4</b> Models 3 and 4: alternate parameterizations</a></li>
<li class="chapter" data-level="19.5" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-groups"><i class="fa fa-check"></i><b>19.5</b> Comparing groups</a><ul>
<li class="chapter" data-level="19.5.1" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-to-the-intercept-group"><i class="fa fa-check"></i><b>19.5.1</b> Comparing to the “intercept group”</a></li>
<li class="chapter" data-level="19.5.2" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-others-pairs-of-groups"><i class="fa fa-check"></i><b>19.5.2</b> Comparing others pairs of groups</a></li>
<li class="chapter" data-level="19.5.3" data-path="nominal-predictors.html"><a href="nominal-predictors.html#contrasts-comparing-groups-of-groups"><i class="fa fa-check"></i><b>19.5.3</b> Contrasts: Comparing “groups of groups”</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="nominal-predictors.html"><a href="nominal-predictors.html#more-variations"><i class="fa fa-check"></i><b>19.6</b> More Variations</a></li>
<li class="chapter" data-level="19.7" data-path="nominal-predictors.html"><a href="nominal-predictors.html#ch19-exercises"><i class="fa fa-check"></i><b>19.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#crop-yield-by-till-method-and-fertilizer"><i class="fa fa-check"></i><b>20.1</b> Crop Yield by Till Method and Fertilizer</a><ul>
<li class="chapter" data-level="20.1.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#what-does-sigma-represent"><i class="fa fa-check"></i><b>20.1.1</b> What does <span class="math inline">\(\sigma\)</span> represent?</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#split-plot-design"><i class="fa fa-check"></i><b>20.2</b> Split Plot Design</a></li>
<li class="chapter" data-level="20.3" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#which-model-should-we-use"><i class="fa fa-check"></i><b>20.3</b> Which model should we use?</a><ul>
<li class="chapter" data-level="20.3.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#modeling-choices"><i class="fa fa-check"></i><b>20.3.1</b> Modeling Choices</a></li>
<li class="chapter" data-level="20.3.2" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#measuring-a-model-prediction-error"><i class="fa fa-check"></i><b>20.3.2</b> Measuring a Model – Prediction Error</a></li>
<li class="chapter" data-level="20.3.3" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#overfitting-example"><i class="fa fa-check"></i><b>20.3.3</b> Overfitting Example</a></li>
<li class="chapter" data-level="20.3.4" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#measuring-fit-with-r2"><i class="fa fa-check"></i><b>20.3.4</b> Measuring fit with <span class="math inline">\(r^2\)</span></a></li>
<li class="chapter" data-level="20.3.5" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#leave-one-out-analysis"><i class="fa fa-check"></i><b>20.3.5</b> Leave One Out Analysis</a></li>
<li class="chapter" data-level="20.3.6" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#out-of-sample-prediction-error"><i class="fa fa-check"></i><b>20.3.6</b> Out-of-sample prediction error</a></li>
<li class="chapter" data-level="20.3.7" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#approximating-out-of-sample-prediction-error"><i class="fa fa-check"></i><b>20.3.7</b> Approximating out-of-sample prediction error</a></li>
<li class="chapter" data-level="20.3.8" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#the-deviance-scale"><i class="fa fa-check"></i><b>20.3.8</b> The deviance scale</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#using-loo"><i class="fa fa-check"></i><b>20.4</b> Using loo</a></li>
<li class="chapter" data-level="20.5" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#ch20-exercses"><i class="fa fa-check"></i><b>20.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotymous-response.html"><a href="dichotymous-response.html"><i class="fa fa-check"></i><b>21</b> Dichotymous Response</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">(Re)Doing Bayesain Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nominal-predictors" class="section level1">
<h1><span class="header-section-number">19</span> Nominal Predictors</h1>
<div id="fruit-flies-study" class="section level2">
<h2><span class="header-section-number">19.1</span> Fruit flies Study</h2>
<p>A study of fruit flies (Hanley &amp; Shapiro, 1994) considered whether the female
companions (none, 1 pregnant, 8 pregnant, 1 virgin, or 8 virgin) is associated
with differences in longevity of males (measured in days).
<!-- (A similar study on females had already shown that female fruit flies  --></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_violin</span>(longevity <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> FruitflyReduced) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_jitter</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">height =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_point</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">fun =</span> mean)</code></pre>
<pre><code>## No summary function supplied, defaulting to `mean_se()</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies-look-1.png" width="65%" /></p>
</div>
<div id="model-1-out-of-the-box" class="section level2">
<h2><span class="header-section-number">19.2</span> Model 1: Out-of-the-box</h2>
<p>It is easy enough to ask <code>brm()</code> to fit a model for us. Let’s just give it our
explanatory and response variables and see what happens.</p>
<pre class="sourceCode r"><code class="sourceCode r">flies_brm &lt;-<span class="st"> </span><span class="kw">brm</span>(longevity <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> FruitflyReduced)</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">flies_stan &lt;-<span class="st"> </span><span class="kw">stanfit</span>(flies_brm)
flies_stan</code></pre>
<pre><code>## Inference for Stan model: 2838b68e72ce876b17fbd0e486bccf49.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##                     mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff Rhat
## b_Intercept        63.59    0.06 3.00   57.62   61.64   63.63   65.57   69.59  2664    1
## b_groupPregnant1    1.21    0.08 4.22   -7.07   -1.68    1.16    3.98    9.56  2869    1
## b_groupPregnant8   -0.22    0.08 4.27   -8.67   -3.08   -0.23    2.66    7.87  2891    1
## b_groupVirgin1     -6.89    0.08 4.19  -14.97   -9.72   -7.00   -4.10    1.56  2998    1
## b_groupVirgin8    -24.83    0.08 4.23  -32.98  -27.52  -24.85  -22.06  -16.37  2955    1
## sigma              14.90    0.02 0.96   13.16   14.24   14.87   15.50   16.93  3841    1
## lp__             -519.59    0.04 1.77 -523.77 -520.54 -519.25 -518.29 -517.15  1802    1
## 
## Samples were drawn using NUTS(diag_e) at Wed Apr 24 08:17:00 2019.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_combo</span>(<span class="kw">as.mcmc.list</span>(flies_stan))</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies-brm-look-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas_ridges</span>(<span class="kw">as.mcmc.list</span>(flies_stan), <span class="dt">regex_pars =</span> <span class="st">&quot;b_g&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies-brm-look-2.png" width="65%" /></p>
<p>But what just happened? Why do we have 5 parameters starting with <code>b_</code>?
Our first clue comes from looking at the data that get sent to Stan.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">standata</span>(flies_brm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">lapply</span>(head)</code></pre>
<pre><code>## $N
## [1] 125
## 
## $Y
## [1] 35 37 49 46 63 39
## 
## $K
## [1] 5
## 
## $X
##   Intercept groupPregnant1 groupPregnant8 groupVirgin1 groupVirgin8
## 1         1              0              1            0            0
## 2         1              0              1            0            0
## 3         1              0              1            0            0
## 4         1              0              1            0            0
## 5         1              0              1            0            0
## 6         1              0              1            0            0
## 
## $prior_only
## [1] 0</code></pre>
<p>Our <code>group</code> variable has been turned into 4 (really 5, if you count
the intercept, which is all 1’s) new 0/1 variables. So our model is</p>
<p><span class="math display">\[\begin{align*}
\mathrm{longevity} &amp;= 
  \beta_0 \cdot 1 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \beta_4 x_4 + 
  \mathrm{noise}
  \\
  &amp; = \beta_0 \cdot 1 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \beta_4 x_4 + 
  {\sf Norm}(0, \sigma)
\end{align*}\]</span></p>
<p>where, for example,</p>
<p><span class="math display">\[\begin{align*}
x_1 &amp;= [\![ \mbox{group} = \mbox{Pregnant1} ]\!] \\
    &amp;= \begin{cases}
          1 &amp; \mbox{if group}   =  \mbox{Pregnant1} \\
          0 &amp; \mbox{if group} \neq \mbox{Pregnant1}
       \end{cases}
\end{align*}\]</span></p>
<p>In other words the distribution of longevity is</p>
<ul>
<li><span class="math inline">\({\sf Norm}(\beta_0, \sigma)\)</span> for the <code>None0</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_0 + \beta_1, \sigma)\)</span> for the <code>Pregnant1</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_0 + \beta_2, \sigma)\)</span> for the <code>Pregnant2</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_0 + \beta_3, \sigma)\)</span> for the <code>Virgin1</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_0 + \beta_4, \sigma)\)</span> for the <code>Virgin2</code> group</li>
</ul>
<p>Here are the default priors.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prior_summary</span>(flies_brm)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">prior</th>
<th align="left">class</th>
<th align="left">coef</th>
<th align="left">group</th>
<th align="left">resp</th>
<th align="left">dpar</th>
<th align="left">nlpar</th>
<th align="left">bound</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">b</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">b</td>
<td align="left">groupPregnant1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">b</td>
<td align="left">groupPregnant8</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">b</td>
<td align="left">groupVirgin1</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">b</td>
<td align="left">groupVirgin8</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">student_t(3, 58, 18)</td>
<td align="left">Intercept</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">student_t(3, 0, 18)</td>
<td align="left">sigma</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<ul>
<li>Flat improper priors for the <code>b_</code> parameters.</li>
<li>t-distribution with 3 degrees of freedom for the intercept (heavier tails than a normal distribution)
<ul>
<li>Note: This is really a prior for <span class="math inline">\(\alpha_0\)</span>, not <span class="math inline">\(\beta_0\)</span> since it is usually easier to
specify a prior for <span class="math inline">\(\alpha_0\)</span>. If for some reason we wanted to specify a prior for <span class="math inline">\(\beta_0\)</span>
instead, there is a little trick: use the formula <code>longevity ~ 0 + intercept + group</code>.</li>
<li>If you are curious where 58 and 18 came from, here’s a good guess:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">df_stats</span>(<span class="op">~</span><span class="st"> </span>longevity, <span class="dt">data =</span> FruitflyReduced, mean, sd)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">mean_longevity</th>
<th align="right">sd_longevity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">57.44</td>
<td align="right">17.56</td>
</tr>
</tbody>
</table>
<p>That is, the prior says that the mean response at the mean value of the predictor (in the data)
should be roughly the mean value of the responsss in the data, and our uncertainty is on the scale
of the variability in responses in the data.</p></li>
<li><p>“T” for <code>sigma</code>. (This is really a “half t”, since Stan knows the parameter must be positive.)</p></li>
</ul>
<!-- * "Gamma" distribution for `nu`.  Exponential is Gamma with shape = 1, `brm()` uses -->
<!-- shape = 2 by default.  (This gets truncated to the values above 1 by Stan.) -->
<!--     ```{r ch19-gamma-params} -->
<!--     gf_dist("gamma", shape = 2, rate = 0.1) %>%  -->
<!--       gf_lims(x = c(1, 50)) -->
<!--     ``` -->
</div>
<div id="model-2-custom-priors" class="section level2">
<h2><span class="header-section-number">19.3</span> Model 2: Custom Priors</h2>
<p>The out-of-the-box model above differs from the basic model in <em>DBDA</em>.</p>
<p><img src="images/Fig19-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We can get closer to the <em>DBDA</em> model using this:</p>
<pre class="sourceCode r"><code class="sourceCode r">flies2_brm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">brm</span>(longevity <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> FruitflyReduced,
      <span class="dt">prior =</span> <span class="kw">c</span>(
        <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;normal(60, 100)&quot;</span>),  <span class="co"># 100 = 5 * 20</span>
        <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="st">&quot;normal(0, 10)&quot;</span>),  <span class="co"># group = &quot;b&quot; is default; could be omitted</span>
        <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;uniform(20.0/1000.0, 20.0 * 1000.0)&quot;</span>)
      )
  )</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prior_summary</span>(flies2_brm)
<span class="kw">stancode</span>(flies2_brm)</code></pre>
<p>This still isn’t exactly the same as the model used by Kruschke. It turns out that there
are multiple ways to code the <span class="math inline">\(\beta\)</span>s. The model we just fit and one more are easy to do
with <code>brm()</code>. A third is used by Kruschke and takes a bit more work to fit using <code>brm()</code>.</p>
</div>
<div id="models-3-and-4-alternate-parameterizations" class="section level2">
<h2><span class="header-section-number">19.4</span> Models 3 and 4: alternate parameterizations</h2>
<p>If we remove the intercept in the <code>brm()</code> model, we get a model with a <span class="math inline">\(\beta_i\)</span> for each group
mean rather than <span class="math inline">\(\beta_0\)</span> for the first group and <span class="math inline">\(\beta_i\)</span> for the difference in group means
when <span class="math inline">\(i &gt; 0\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">flies3_brm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">brm</span>(
    longevity <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>group, <span class="dt">data =</span> FruitflyReduced,
    <span class="dt">prior =</span> <span class="kw">c</span>(
      <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="st">&quot;normal(60, 10)&quot;</span>),  <span class="co"># group = &quot;b&quot; is default; could be omitted</span>
      <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;uniform(20.0/1000.0, 20.0 * 1000.0)&quot;</span>)
    ),
    <span class="dt">sample_prior =</span> <span class="ot">TRUE</span>
  )</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prior_summary</span>(flies3_brm)
<span class="kw">stancode</span>(flies3_brm)</code></pre>
<p>This is equivalent to</p>
<p><span class="math display">\[\begin{align*}
\mathrm{longevity} &amp;= 
  \beta_0 x_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \beta_4 x_4 + 
  \mathrm{noise}
  \\
  &amp; = \beta_0 x_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \beta_4 x_4 + 
  {\sf Norm}(0, \sigma)
\end{align*}\]</span></p>
<p>where, for example,</p>
<p><span class="math display">\[\begin{align*}
x_1 &amp;= [\![ \mbox{group} = \mbox{Pregnant1} ]\!] \\
    &amp;= \begin{cases}
          1 &amp; \mbox{if group}   =  \mbox{Pregnant1} \\
          0 &amp; \mbox{if group} \neq \mbox{Pregnant1}
       \end{cases}
\end{align*}\]</span></p>
<p>In other words the distribution of longevity is</p>
<ul>
<li><span class="math inline">\({\sf Norm}(\beta_0, \sigma)\)</span> for the <code>None0</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_1, \sigma)\)</span> for the <code>Pregnant1</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_2, \sigma)\)</span> for the <code>Pregnant2</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_3, \sigma)\)</span> for the <code>Virgin1</code> group</li>
<li><span class="math inline">\({\sf Norm}(\beta_4, \sigma)\)</span> for the <code>Virgin2</code> group</li>
</ul>
<p>Kruschke uses an overspecified model that has 6 parameters: an intercept and 5 “offsets”.
An extra step has to be included to properly specify the model. His model is designed so
that <span class="math inline">\(\beta_0\)</span> is an overall average and the other <span class="math inline">\(\beta_i\)</span>’s give differences to that
overall average.</p>
<p>I haven’t figured out if there is an easy way to do this with <code>brm()</code>.
But with a little work, we can force it. The key to doing this is the use
of <code>stanvar()</code> to create additional lines of code that are injected into the
Stan code. We use <code>scode</code> to give the desired code (as a string) and
<code>block</code> to say which Stan block to put it in.</p>
<pre class="sourceCode r"><code class="sourceCode r">FruitflyReduced &lt;-
<span class="st">  </span>FruitflyReduced <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">one =</span> <span class="dv">1</span>)
flies4_brm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">brm</span>(
    longevity <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>one <span class="op">+</span><span class="st"> </span>group, <span class="dt">data =</span> FruitflyReduced,
    <span class="dt">prior =</span> <span class="kw">c</span>(
      <span class="kw">set_prior</span>(<span class="dt">coef =</span> <span class="st">&quot;one&quot;</span>, <span class="st">&quot;normal(60,10)&quot;</span>),
      <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="st">&quot;normal(0, 10)&quot;</span>),  <span class="co"># group = &quot;b&quot; is default; could be omitted</span>
      <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;uniform(20.0/1000.0, 20.0 * 1000.0)&quot;</span>)
    ),
    <span class="dt">sample_prior =</span> <span class="ot">TRUE</span>,
    <span class="dt">stanvars =</span> 
      <span class="kw">c</span>(
        <span class="co"># compute the average average</span>
        <span class="kw">stanvar</span>(<span class="dt">scode =</span> <span class="st">&quot;  real a_one = mean(b[2:K]) + b[1];&quot;</span>, <span class="dt">block =</span> <span class="st">&quot;genquant&quot;</span>),
        <span class="co"># compute the offsets to the average average</span>
        <span class="kw">stanvar</span>(<span class="dt">scode =</span> <span class="st">&quot;  vector[K - 1] a = b[1] + b[2:K] - a_one;&quot;</span>, <span class="dt">block =</span> <span class="st">&quot;genquant&quot;</span>)
      )
  )</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prior_summary</span>(flies4_brm)
<span class="kw">stancode</span>(flies4_brm)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.mcmc.list</span>(<span class="kw">stanfit</span>(flies4_brm)), <span class="dt">regex_pars =</span> <span class="kw">c</span>(<span class="st">&quot;a_one&quot;</span>, <span class="st">&quot;a</span><span class="ch">\\</span><span class="st">[&quot;</span>, <span class="st">&quot;^b_&quot;</span>))</code></pre>
<p><img src="Redoing_files/figure-html/ch19-kruschke-compare-1.png" width="65%" /></p>
<p>As we can see, the modes of the posteriors for the <code>a</code> and <code>b</code> parameters are similar
(because the prior on <code>b_one</code> kept <code>b_one</code> from drifting too far from where
<code>a_one</code> is centered), but the posteriors for the <code>a</code> parameters are significantly
narrower, so the conversion from <code>b</code>’s to <code>a</code>’s is important.</p>
</div>
<div id="comparing-groups" class="section level2">
<h2><span class="header-section-number">19.5</span> Comparing groups</h2>
<div id="comparing-to-the-intercept-group" class="section level3">
<h3><span class="header-section-number">19.5.1</span> Comparing to the “intercept group”</h3>
<p>Let’s return to model 2.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stanfit</span>(flies2_brm)</code></pre>
<pre><code>## Inference for Stan model: bf639a104df81234b81629296b75e83c.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##                     mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff Rhat
## b_Intercept        61.64    0.05 2.62   56.42   59.86   61.62   63.42   66.65  2955    1
## b_groupPregnant1    2.84    0.06 3.73   -4.41    0.34    2.82    5.29   10.03  3753    1
## b_groupPregnant8    1.55    0.06 3.71   -5.42   -1.04    1.60    4.06    8.70  3533    1
## b_groupVirgin1     -4.43    0.06 3.74  -11.74   -6.95   -4.44   -1.88    3.00  3461    1
## b_groupVirgin8    -21.03    0.06 3.78  -28.39  -23.60  -21.08  -18.46  -13.60  3905    1
## sigma              14.95    0.01 0.96   13.23   14.30   14.91   15.57   16.97  4553    1
## lp__             -543.20    0.04 1.76 -547.54 -544.10 -542.84 -541.91 -540.82  1860    1
## 
## Samples were drawn using NUTS(diag_e) at Wed Apr 24 08:17:51 2019.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).</code></pre>
<p>In this model, one group corresponds to the intercept of the model,
and comparisons of other groups to this group is a matter of investigating
the posterior distribution of one of the other <span class="math inline">\(\beta\)</span>’s.</p>
<pre class="sourceCode r"><code class="sourceCode r">flies_post &lt;-<span class="st"> </span><span class="kw">posterior</span>(flies_stan)
<span class="kw">names</span>(flies_post)</code></pre>
<pre><code>## [1] &quot;b_Intercept&quot;      &quot;b_groupPregnant1&quot; &quot;b_groupPregnant8&quot; &quot;b_groupVirgin1&quot;   &quot;b_groupVirgin8&quot;  
## [6] &quot;sigma&quot;            &quot;lp__&quot;             &quot;chain&quot;            &quot;iter&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_post</span>(flies_post<span class="op">$</span>b_groupPregnant1)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies-virgin1-1.png" width="65%" /></p>
<pre><code>## $posterior
##       ESS  mean median  mode
## var1 2985 1.208  1.162 1.206
## 
## $hdi
##   prob     lo    hi
## 1 0.95 -7.082 9.551</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hdi</span>(flies_post<span class="op">$</span>b_groupPregnant1)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">par</th>
<th align="right">lo</th>
<th align="right">hi</th>
<th align="right">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">var1</td>
<td align="right">-7.082</td>
<td align="right">9.551</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_post</span>(flies_post<span class="op">$</span>b_groupVirgin1)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies-virgin1-2.png" width="65%" /></p>
<pre><code>## $posterior
##       ESS   mean median   mode
## var1 3040 -6.895 -7.003 -7.352
## 
## $hdi
##   prob     lo    hi
## 1 0.95 -15.01 1.409</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas</span>(<span class="kw">as.mcmc.list</span>(flies_stan), <span class="dt">pars =</span> <span class="st">&quot;b_groupVirgin1&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.95</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies-virgin1-3.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hdi</span>(flies_post<span class="op">$</span>b_groupVirgin1)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">par</th>
<th align="right">lo</th>
<th align="right">hi</th>
<th align="right">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">var1</td>
<td align="right">-15.01</td>
<td align="right">1.409</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
</div>
<div id="comparing-others-pairs-of-groups" class="section level3">
<h3><span class="header-section-number">19.5.2</span> Comparing others pairs of groups</h3>
<p>What if we want to compare the <code>Virgin1</code> and <code>Virgin8</code> groups?
We can use the identity <span class="math inline">\(\beta_0 + \beta_i - (\beta_0 + \beta_j) = \beta_i - \beta_j\)</span>
to simplify the algebra and do it this way. (The same would work in model 3 or 4 as well.)</p>
<pre class="sourceCode r"><code class="sourceCode r">flies_post &lt;-
<span class="st">  </span>flies_post <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">dVirgin =</span> b_groupVirgin8 <span class="op">-</span><span class="st"> </span>b_groupVirgin1)
<span class="kw">plot_post</span>(flies_post<span class="op">$</span>dVirgin, <span class="dt">xlab =</span> <span class="st">&quot;Virgin8 - Virgin1&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-virgin1-v-virgin8-1.png" width="65%" /></p>
<pre><code>## $posterior
##       ESS   mean median   mode
## var1 4997 -17.93  -17.9 -17.77
## 
## $hdi
##   prob     lo     hi
## 1 0.95 -26.78 -10.29</code></pre>
</div>
<div id="contrasts-comparing-groups-of-groups" class="section level3">
<h3><span class="header-section-number">19.5.3</span> Contrasts: Comparing “groups of groups”</h3>
<p>What if we want to compare the two virgin groups to the 3 other groups?
This is a bit simpler to do using the model without an intercept term.</p>
<pre class="sourceCode r"><code class="sourceCode r">flies3_post &lt;-<span class="st"> </span><span class="kw">posterior</span>(flies3_brm)
<span class="kw">names</span>(flies3_post)</code></pre>
<pre><code>## [1] &quot;b_groupNone0&quot;     &quot;b_groupPregnant1&quot; &quot;b_groupPregnant8&quot; &quot;b_groupVirgin1&quot;   &quot;b_groupVirgin8&quot;  
## [6] &quot;sigma&quot;            &quot;prior_b&quot;          &quot;prior_sigma&quot;      &quot;lp__&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">flies3_post &lt;-
<span class="st">  </span>flies3_post <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">contrast =</span> 
      (b_groupVirgin8 <span class="op">+</span><span class="st"> </span>b_groupVirgin1)<span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>
<span class="st">      </span>(b_groupPregnant1 <span class="op">+</span><span class="st"> </span>b_groupPregnant8 <span class="op">+</span><span class="st"> </span>b_groupNone0) <span class="op">/</span><span class="st"> </span><span class="dv">3</span>
)
<span class="kw">plot_post</span>(flies3_post<span class="op">$</span>contrast, <span class="dt">xlab =</span> <span class="st">&quot;Virgin vs non-virgin groups&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/unnamed-chunk-20-1.png" width="65%" /></p>
<pre><code>## $posterior
##       ESS   mean median   mode
## var1 5960 -14.84 -14.85 -14.56
## 
## $hdi
##   prob     lo     hi
## 1 0.95 -19.64 -9.521</code></pre>
<p>The expression</p>
<p><span class="math display">\[\begin{align*}
\frac{\mu_3 + \mu_4}{2} - \frac{\mu_0 + \mu_1 + \mu_2}{3}
&amp;= 
-\frac13 \mu_0 -\frac13 \mu_1 -\frac13 \mu_2 + \frac12 \mu_3 + \frac12 \mu_4
\end{align*}\]</span></p>
<p>is an example of a <strong>contrast</strong>. A contrast is simply a linear combination of the
group means such that the sum of the coefficients is 0. Many interesting relationships
can be investigated using contrasts, and the brms package includes the <code>hypothesis()</code>
function to help us do this. (Note: because we included <code>sample_prior = TRUE</code> in the
call to <code>brm()</code> for this model, the plot below shows both prior and posterior distributions
for the contrast.)</p>
<pre class="sourceCode r"><code class="sourceCode r">h &lt;-
<span class="st">  </span><span class="kw">hypothesis</span>(
    flies3_brm,
    <span class="st">&quot;(groupVirgin8 + groupVirgin1) / 2 &lt; </span>
<span class="st">      (groupPregnant1 + groupPregnant8 + groupNone0) / 3&quot;</span>
  )
h</code></pre>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 ((groupVirgin8+gr... &lt; 0   -14.84      2.58     -Inf   -10.53        Inf         1    *
## ---
## &#39;*&#39;: The expected value under the hypothesis lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-hypothesis-1.png" width="65%" /></p>
<div id="multiple-hypotheses-at-once" class="section level4">
<h4><span class="header-section-number">19.5.3.1</span> Multiple Hypotheses at once</h4>
<p>We can even test multiple hypotheses at once.</p>
<pre class="sourceCode r"><code class="sourceCode r">h2 &lt;-
<span class="st">  </span><span class="kw">hypothesis</span>(
    flies3_brm,
    <span class="kw">c</span>(<span class="st">&quot;groupVirgin1 &lt; (groupPregnant1 + groupPregnant8 + groupNone0) / 3&quot;</span>,
      <span class="st">&quot;groupVirgin8 &lt; (groupPregnant1 + groupPregnant8 + groupNone0) / 3&quot;</span>)
  )
h2</code></pre>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (groupVirgin1)-((... &lt; 0    -6.57      3.24     -Inf    -1.21      37.46      0.97    *
## 2 (groupVirgin8)-((... &lt; 0   -23.12      3.33     -Inf   -17.60        Inf      1.00    *
## ---
## &#39;*&#39;: The expected value under the hypothesis lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h2)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-hypothesis2-1.png" width="65%" /></p>
</div>
<div id="equality-or-inequality" class="section level4">
<h4><span class="header-section-number">19.5.3.2</span> Equality or inequality?</h4>
<p>In the previous example, we expressed our contrast as an inequality. We can also express it
as an equality. The output that we get from <code>hypothesis()</code> is a bit different if we do so.</p>
<pre class="sourceCode r"><code class="sourceCode r">h3 &lt;-
<span class="st">  </span><span class="kw">hypothesis</span>(
    flies3_brm,
    <span class="kw">c</span>(<span class="st">&quot;groupVirgin1 = (groupPregnant1 + groupPregnant8 + groupNone0) / 3&quot;</span>,
      <span class="st">&quot;groupVirgin8 = (groupPregnant1 + groupPregnant8 + groupNone0) / 3&quot;</span>)
  )
h3</code></pre>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (groupVirgin1)-((... = 0    -6.57      3.24   -13.02     0.08       0.43       0.3     
## 2 (groupVirgin8)-((... = 0   -23.12      3.33   -29.55   -16.69       0.00       0.0    *
## ---
## &#39;*&#39;: The expected value under the hypothesis lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(h3)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-hypothesis3-1.png" width="65%" /></p>
<ul>
<li>The CI is 2-sided rather than 1-sided.</li>
<li>Evidence Ratio is defined differently.
<ul>
<li>For inequalities, this is the ratio of the posterior probabilities
for the inequality being true vs. false</li>
<li>For equalities, this is the ratio of the posterior density (of the equality
holding) to the prior density. (This only works if <code>sample_prior = TRUE</code> since
prior samples are required to make the calculation.)</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="more-variations" class="section level2">
<h2><span class="header-section-number">19.6</span> More Variations</h2>
<p>The models we have looked at above are very similar to a traditional ANOVA model, the key
features of which are</p>
<ul>
<li>normal distributions for each group (normal noise), and</li>
<li>same standard deviation in each group (homoskedasticity).</li>
</ul>
<p>In frequentist statistics, these are largely chosen for convenience (the
mathematics is much easier). But we can easily relax these restrictions using
Bayesian software. Let’s fit a model using</p>
<ul>
<li><p>t distributions instead normal distributions for the noise.</p>
<p>This will make the results more robust against outliers in our sample
or distributions with heavier tails.</p></li>
<li><p>different standard deviation parameters for each group.</p></li>
</ul>
<p>Both are easy to do with <code>brm()</code>. The main new feature is the use
of <code>bf()</code> to provide two formulas. The first describes the mean response (separate
means for each group). The second formula describes <code>sigma</code> (separate values for
each group). The rest should look familiar.</p>
<pre class="sourceCode r"><code class="sourceCode r">flies5_brm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">brm</span>(
    <span class="kw">bf</span>(longevity <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>group, sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>group),
    <span class="dt">data =</span> FruitflyReduced,
    <span class="dt">family =</span> <span class="kw">student</span>(),   <span class="co"># t distribution for the noise</span>
    <span class="dt">prior =</span> <span class="kw">c</span>(
      <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="st">&quot;normal(60, 10)&quot;</span>)
    ),
    <span class="dt">sample_prior =</span> <span class="ot">TRUE</span>
  )</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<p>The Stan code for this model includes the following model section.</p>
<pre class="stan"><code>model {
  vector[N] mu = X * b;
  vector[N] sigma = X_sigma * b_sigma;
  for (n in 1:N) {
    sigma[n] = exp(sigma[n]);
  }
  // priors including all constants
  target += normal_lpdf(b | 60, 10);
  target += gamma_lpdf(nu | 2, 0.1)
    - 1 * gamma_lccdf(1 | 2, 0.1);
  // likelihood including all constants
  if (!prior_only) {
    target += student_t_lpdf(Y | nu, mu, sigma);
  }
}</code></pre>
<p>Note that the values of <code>sigma</code> are on the log scale and are converted (via <code>exp()</code>)
to the natural scale before using them in the likelihood function.
The sort of encoding of groups is used for (log) <code>sigma</code> as was used for the
group means. Because we included <code>0</code> in our formula, we get a (log) <code>sigma</code> for
each group.
This is reported in the summary output for the brm model as a log link for sigma.</p>
<pre class="sourceCode r"><code class="sourceCode r">flies5_brm</code></pre>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: longevity ~ 0 + group 
##          sigma ~ 0 + group
##    Data: FruitflyReduced (Number of observations: 125) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##                      Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## groupNone0              63.01      3.25    56.56    69.12       8719 1.00
## groupPregnant1          64.17      3.24    57.83    70.48       7598 1.00
## groupPregnant8          63.38      2.96    57.52    69.01       8003 1.00
## groupVirgin1            57.14      2.86    51.56    62.60       7448 1.00
## groupVirgin8            40.09      2.51    35.23    45.18       6611 1.00
## sigma_groupNone0         2.78      0.15     2.51     3.10       7918 1.00
## sigma_groupPregnant1     2.74      0.16     2.45     3.07       7298 1.00
## sigma_groupPregnant8     2.67      0.16     2.38     2.99       6365 1.00
## sigma_groupVirgin1       2.68      0.16     2.39     3.00       7954 1.00
## sigma_groupVirgin8       2.49      0.16     2.20     2.81       8157 1.00
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## nu    27.54     14.49     8.31    63.88       6495 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_areas_ridges</span>(<span class="kw">as.mcmc.list</span>(<span class="kw">stanfit</span>(flies5_brm)), <span class="dt">regex_pars =</span> <span class="st">&quot;sigma&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies5-sigmas-1.png" width="65%" /></p>
<p>In this case, it doesn’t appear that there is a large difference among
the (log) standard deviations in the five groups, but it is noteable
that the group with the lowest longevity also has the smallest standard
deviation. It is not uncommon for variability to larger when values are
larger. Fortunately, it is no harder to fit a model with separate
standard deviations than with one standard deviation for all of the groups.
And if there substantial differences in the standard deviations,
a model that takes that into account will perform better.</p>
<p>If we prefer to see the standard deviations on the natural scale, we can
tell Stan to compute and store those values. The naming isn’t quite as nice,
however.</p>
<pre class="sourceCode r"><code class="sourceCode r">flies5a_brm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">brm</span>(
    <span class="kw">bf</span>(longevity <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>group, sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>group),
    <span class="dt">data =</span> FruitflyReduced,
    <span class="dt">family =</span> <span class="kw">student</span>(),   <span class="co"># t distribution for the noise</span>
    <span class="dt">prior =</span> <span class="kw">c</span>(
      <span class="kw">set_prior</span>(<span class="dt">class =</span> <span class="st">&quot;b&quot;</span>, <span class="st">&quot;normal(60, 10)&quot;</span>)
    ),
    <span class="dt">sample_prior =</span> <span class="ot">TRUE</span>,
    <span class="dt">stanvars =</span> 
      <span class="kw">stanvar</span>(
        <span class="dt">scode =</span> <span class="st">&quot;vector[K_sigma] b_rsigma = exp(b_sigma);&quot;</span>,
        <span class="dt">block =</span> <span class="st">&quot;genquant&quot;</span>)
  )</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">flies5a_stan &lt;-<span class="st"> </span><span class="kw">stanfit</span>(flies5a_brm)
<span class="kw">mcmc_areas_ridges</span>(<span class="kw">as.mcmc.list</span>(flies5a_stan), <span class="dt">regex_pars =</span> <span class="st">&quot;rsigma&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch19-flies5a-rsigma-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hdi</span>(<span class="kw">posterior</span>(flies5a_stan), <span class="dt">regex_pars =</span> <span class="st">&quot;rsigma&quot;</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">par</th>
<th align="right">lo</th>
<th align="right">hi</th>
<th align="right">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">b_rsigma.1</td>
<td align="right">11.919</td>
<td align="right">21.74</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="left">b_rsigma.2</td>
<td align="right">11.069</td>
<td align="right">20.47</td>
<td align="right">0.95</td>
</tr>
<tr class="odd">
<td align="left">b_rsigma.3</td>
<td align="right">10.220</td>
<td align="right">19.16</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="left">b_rsigma.4</td>
<td align="right">10.580</td>
<td align="right">19.42</td>
<td align="right">0.95</td>
</tr>
<tr class="odd">
<td align="left">b_rsigma.5</td>
<td align="right">8.795</td>
<td align="right">16.05</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
</div>
<div id="ch19-exercises" class="section level2">
<h2><span class="header-section-number">19.7</span> Exercises</h2>
<ol style="list-style-type: decimal">
<li><p>It turns out that larger fruit flies tend to live longer.
we can take this into account by adding <code>thorax</code> (the length of each
fruit fly’s thorax in mm) to our model. Since we are primarily interested
in the association between <code>group</code> and longevity, <code>thorax</code> is referred
to as a <strong>covariate</strong>. But if we were primarily interested in the relationship
between longevity and size, we could use the same model and call <code>group</code>
the covariate. Same model, different focus.</p>
<p>Fit two models: Let Model 1 be the model below and let Model 2 be
one just like it but without <code>thorax</code>. Then answer the questions that follow.
We’ll stick with the default priors for now, but it would be easy enough
to choose your own.</p>
<pre class="sourceCode r"><code class="sourceCode r">model1_brm &lt;-
<span class="st">  </span><span class="kw">brm</span>(
    <span class="kw">bf</span>(longevity <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>thorax, sigma <span class="op">~</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>thorax),
    <span class="dt">data =</span> FruitflyReduced, 
    <span class="dt">family =</span> <span class="kw">student</span>(),
  )</code></pre>
<ol style="list-style-type: lower-alpha">
<li><p>Does Model 1 think that longevity is different for large and small
fruit flies? How do you know? How can you quantify your answer?</p></li>
<li><p>We are primarily interested in whether the fruit flies that live with
virgin females live less long than the others (those that live
alone or with pregnant females).
Using each model, compute a 95% HDI for the contrast that measures this.
For Model 1, does it matter what value <code>thorax</code> has? (If yes, use <code>thorax = 0.8</code>
as an example.)
How do the two HDI’s compare? Why?</p></li>
<li><p>Using each model, compute a 95% HDI for
the contrast that compares just the Virgin1 flies to the three types of controls
(None0, Pregnant1, and Pregnant8). How do the two models compare?</p></li>
<li><p>Now compare the values for <code>sigma</code> in the two models. To do this, we
will need to specify both the group and the thorax size (since for different
combinations of these the models estimate different values of <code>sigma</code>). For
each of the combinations below, compute a 95% HDI for <code>sigma</code> in two models,
one with <code>thorax</code> and one without. Don’t forget to convert to the natural
scale. (Recall that <code>brm()</code> uses a log link for <code>sigma</code>.)</p>
<ol style="list-style-type: lower-roman">
<li>group: Pregnant1; thorax: 0.7mm, 0.8mm, 0.9mm [That’s three different HDI’s
for Model 1 and the same HDI 3 times for Model 2.]</li>
<li>group: Virgin8; thorax: 0.7mm, 0.8mm, 0.9mm</li>
</ol>
<p>How do the results compare for the two models?</p></li>
<li><p>Given the results above, is it important to include <code>thorax</code> in the model?
Explain.</p></li>
<li><p>Bonus (optional): Create a plot that shows the HDIs for <code>sigma</code> for every
combination of model, group, and thorax measurement of 0.6, 0.7, 0.8, or 0.9 mm.</p></li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-metric-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-nominal-predictors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Redoing.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
