<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>5 Bayes’ Rule and the Grid Method | (Re)Doing Bayesain Data Analysis</title>
  <meta name="description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="5 Bayes’ Rule and the Grid Method | (Re)Doing Bayesain Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Bayes’ Rule and the Grid Method | (Re)Doing Bayesain Data Analysis" />
  
  <meta name="twitter:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

<meta name="author" content="R Pruim">


<meta name="date" content="2019-04-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="probability.html">
<link rel="next" href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">(Re)Doing Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What’s in These Notes</a></li>
<li class="part"><span><b>I The Basics: Models, Probability, Bayes, and R</b></span></li>
<li class="chapter" data-level="2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.1</b> The Steps of Bayesian Data Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-code"><i class="fa fa-check"></i><b>2.1.1</b> R code</a></li>
<li class="chapter" data-level="2.1.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-packages"><i class="fa fa-check"></i><b>2.1.2</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-1-which-coin-is-it"><i class="fa fa-check"></i><b>2.2</b> Example 1: Which coin is it?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#freedom-of-choice"><i class="fa fa-check"></i><b>2.2.1</b> Freedom of choice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#distributions"><i class="fa fa-check"></i><b>2.3</b> Distributions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#beta-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Beta distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#normal-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-2-height-vs-weight"><i class="fa fa-check"></i><b>2.4</b> Example 2: Height vs Weight</a><ul>
<li class="chapter" data-level="2.4.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#data"><i class="fa fa-check"></i><b>2.4.1</b> Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#describing-a-model-for-the-relationship-between-height-and-weight"><i class="fa fa-check"></i><b>2.4.2</b> Describing a model for the relationship between height and weight</a></li>
<li class="chapter" data-level="2.4.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#prior"><i class="fa fa-check"></i><b>2.4.3</b> Prior</a></li>
<li class="chapter" data-level="2.4.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior"><i class="fa fa-check"></i><b>2.4.4</b> Posterior</a></li>
<li class="chapter" data-level="2.4.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior-predictive-check"><i class="fa fa-check"></i><b>2.4.5</b> Posterior Predictive Check</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#where-do-we-go-from-here"><i class="fa fa-check"></i><b>2.5</b> Where do we go from here?</a></li>
<li class="chapter" data-level="2.6" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#ch02-exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
<li class="chapter" data-level="2.7" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#footnotes"><i class="fa fa-check"></i><b>2.7</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html"><i class="fa fa-check"></i><b>3</b> Some Useful Bits of R</a><ul>
<li class="chapter" data-level="3.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#style-guide"><i class="fa fa-check"></i><b>3.1</b> You Gotta Have Style</a><ul>
<li class="chapter" data-level="3.1.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#an-additional-note-about-homework"><i class="fa fa-check"></i><b>3.1.1</b> An additional note about homework</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors-lists-and-data-frames"><i class="fa fa-check"></i><b>3.2</b> Vectors, Lists, and Data Frames</a><ul>
<li class="chapter" data-level="3.2.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#lists"><i class="fa fa-check"></i><b>3.2.2</b> Lists</a></li>
<li class="chapter" data-level="3.2.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#data-frames-for-rectangular-data"><i class="fa fa-check"></i><b>3.2.3</b> Data frames for rectangular data</a></li>
<li class="chapter" data-level="3.2.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#other-types-of-data"><i class="fa fa-check"></i><b>3.2.4</b> Other types of data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#plotting-with-ggformula"><i class="fa fa-check"></i><b>3.3</b> Plotting with ggformula</a></li>
<li class="chapter" data-level="3.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#creating-data-with-expand.grid"><i class="fa fa-check"></i><b>3.4</b> Creating data with expand.grid()</a></li>
<li class="chapter" data-level="3.5" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#transforming-and-summarizing-data-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.5</b> Transforming and summarizing data dplyr and tidyr</a></li>
<li class="chapter" data-level="3.6" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#writing-functions"><i class="fa fa-check"></i><b>3.6</b> Writing Functions</a><ul>
<li class="chapter" data-level="3.6.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#why-write-functions"><i class="fa fa-check"></i><b>3.6.1</b> Why write functions?</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#function-parts"><i class="fa fa-check"></i><b>3.6.2</b> Function parts</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#the-function-function-has-its-function"><i class="fa fa-check"></i><b>3.6.3</b> The function() function has its function</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#some-common-error-messages"><i class="fa fa-check"></i><b>3.7</b> Some common error messages</a><ul>
<li class="chapter" data-level="3.7.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#object-not-found"><i class="fa fa-check"></i><b>3.7.1</b> object not found</a></li>
<li class="chapter" data-level="3.7.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#any-message-mentioning-yaml"><i class="fa fa-check"></i><b>3.7.2</b> Any message mentioning yaml</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#ch03-exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#footnotes-1"><i class="fa fa-check"></i><b>3.9</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a><ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#some-terminology"><i class="fa fa-check"></i><b>4.1</b> Some terminology</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#distributions-in-r"><i class="fa fa-check"></i><b>4.2</b> Distributions in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#example-normal-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Example: Normal distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability.html"><a href="probability.html#simulating-running-proportions"><i class="fa fa-check"></i><b>4.2.2</b> Simulating running proportions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#joint-marginal-and-conditional-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint, marginal, and conditional distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability.html"><a href="probability.html#example-hair-and-eye-color"><i class="fa fa-check"></i><b>4.3.1</b> Example: Hair and eye color</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability.html"><a href="probability.html#independence"><i class="fa fa-check"></i><b>4.3.2</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#ch04-exercises"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#footnotes-2"><i class="fa fa-check"></i><b>4.5</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule and the Grid Method</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#the-big-bayesian-idea"><i class="fa fa-check"></i><b>5.1</b> The Big Bayesian Idea</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#likelihood"><i class="fa fa-check"></i><b>5.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="5.1.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#when-bayes-is-easy"><i class="fa fa-check"></i><b>5.1.2</b> When Bayes is easy</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#estimating-the-bias-in-a-coin-using-the-grid-method"><i class="fa fa-check"></i><b>5.2</b> Estimating the bias in a coin using the Grid Method</a><ul>
<li class="chapter" data-level="5.2.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#creating-a-grid"><i class="fa fa-check"></i><b>5.2.1</b> Creating a Grid</a></li>
<li class="chapter" data-level="5.2.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#hdi-from-the-grid"><i class="fa fa-check"></i><b>5.2.2</b> HDI from the grid</a></li>
<li class="chapter" data-level="5.2.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#automating-the-grid"><i class="fa fa-check"></i><b>5.2.3</b> Automating the grid</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#working-on-the-log-scale"><i class="fa fa-check"></i><b>5.3</b> Working on the log scale</a></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#discrete-params"><i class="fa fa-check"></i><b>5.4</b> Discrete Parameters</a></li>
<li class="chapter" data-level="5.5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#ch05-exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
<li class="chapter" data-level="5.6" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#footnotes-3"><i class="fa fa-check"></i><b>5.6</b> Footnotes</a></li>
</ul></li>
<li class="part"><span><b>II Inferring a Binomial Probability</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-distributions-1"><i class="fa fa-check"></i><b>6.1</b> Beta distributions</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-and-bayes"><i class="fa fa-check"></i><b>6.2</b> Beta and Bayes</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-bernoulli-likelihood-function"><i class="fa fa-check"></i><b>6.2.1</b> The Bernoulli likelihood function</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-convenient-prior"><i class="fa fa-check"></i><b>6.2.2</b> A convenient prior</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#pros-and-cons-of-conjugate-priors"><i class="fa fa-check"></i><b>6.2.3</b> Pros and Cons of conjugate priors</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#getting-to-know-the-beta-distributions"><i class="fa fa-check"></i><b>6.3</b> Getting to know the Beta distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#important-facts"><i class="fa fa-check"></i><b>6.3.1</b> Important facts</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#alternative-parameterizations-of-beta-distributions"><i class="fa fa-check"></i><b>6.3.2</b> Alternative parameterizations of Beta distributions</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta_params"><i class="fa fa-check"></i><b>6.3.3</b> beta_params()</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#automating-bayesian-updates-for-a-proportion-beta-prior"><i class="fa fa-check"></i><b>6.3.4</b> Automating Bayesian updates for a proportion (beta prior)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#what-if-the-prior-isnt-a-beta-distribution"><i class="fa fa-check"></i><b>6.4</b> What if the prior isn’t a beta distribution?</a></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#ch06-exercises"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo (MCMC)</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#king-markov-and-adviser-metropolis"><i class="fa fa-check"></i><b>7.1</b> King Markov and Adviser Metropolis</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#quick-intro-to-markov-chains"><i class="fa fa-check"></i><b>7.2</b> Quick Intro to Markov Chains</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#more-info-please"><i class="fa fa-check"></i><b>7.2.1</b> More info, please</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#definition"><i class="fa fa-check"></i><b>7.2.2</b> Definition</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#time-homogeneous-markov-chains"><i class="fa fa-check"></i><b>7.2.3</b> Time-Homogeneous Markov Chains</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#matrix-representation"><i class="fa fa-check"></i><b>7.2.4</b> Matrix representation</a></li>
<li class="chapter" data-level="7.2.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#regular-markov-chains"><i class="fa fa-check"></i><b>7.2.5</b> Regular Markov Chains</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#back-to-king-markov"><i class="fa fa-check"></i><b>7.3</b> Back to King Markov</a></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#how-well-does-the-metropolis-algorithm-work"><i class="fa fa-check"></i><b>7.4</b> How well does the Metropolis Algorithm work?</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-to-any-island"><i class="fa fa-check"></i><b>7.4.1</b> Jumping to any island</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-only-to-neighbor-islands"><i class="fa fa-check"></i><b>7.4.2</b> Jumping only to neighbor islands</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#markov-chains-and-posterior-sampling"><i class="fa fa-check"></i><b>7.5</b> Markov Chains and Posterior Sampling</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-1-estimating-a-proportion"><i class="fa fa-check"></i><b>7.5.1</b> Example 1: Estimating a proportion</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-2-estimating-mean-and-variance"><i class="fa fa-check"></i><b>7.5.2</b> Example 2: Estimating mean and variance</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#issues-with-metropolis-algorithm"><i class="fa fa-check"></i><b>7.5.3</b> Issues with Metropolis Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#two-coins"><i class="fa fa-check"></i><b>7.6</b> Two coins</a><ul>
<li class="chapter" data-level="7.6.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#the-model"><i class="fa fa-check"></i><b>7.6.1</b> The model</a></li>
<li class="chapter" data-level="7.6.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#exact-analysis"><i class="fa fa-check"></i><b>7.6.2</b> Exact analysis</a></li>
<li class="chapter" data-level="7.6.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#metropolis"><i class="fa fa-check"></i><b>7.6.3</b> Metropolis</a></li>
<li class="chapter" data-level="7.6.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#gibbs-sampling"><i class="fa fa-check"></i><b>7.6.4</b> Gibbs sampling</a></li>
<li class="chapter" data-level="7.6.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#advantages-and-disadvantages-of-gibbs-vs-metropolis"><i class="fa fa-check"></i><b>7.6.5</b> Advantages and Disadvantages of Gibbs vs Metropolis</a></li>
<li class="chapter" data-level="7.6.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#so-what-do-we-learn-about-the-coins"><i class="fa fa-check"></i><b>7.6.6</b> So what do we learn about the coins?</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-posterior-sampling-big-picture"><i class="fa fa-check"></i><b>7.7</b> MCMC posterior sampling: Big picture</a><ul>
<li class="chapter" data-level="7.7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-markov-chain-monte-carlo"><i class="fa fa-check"></i><b>7.7.1</b> MCMC = Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="7.7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#posterior-sampling-random-walk-through-the-posterior"><i class="fa fa-check"></i><b>7.7.2</b> Posterior sampling: Random walk through the posterior</a></li>
<li class="chapter" data-level="7.7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#where-do-we-go-from-here-1"><i class="fa fa-check"></i><b>7.7.3</b> Where do we go from here?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#ch07-exercises"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html"><i class="fa fa-check"></i><b>8</b> JAGS – Just Another Gibbs Sampler</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#what-jags-is"><i class="fa fa-check"></i><b>8.1</b> What JAGS is</a><ul>
<li class="chapter" data-level="8.1.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#jags-documentation"><i class="fa fa-check"></i><b>8.1.1</b> JAGS documentation</a></li>
<li class="chapter" data-level="8.1.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#updating-c-and-clang"><i class="fa fa-check"></i><b>8.1.2</b> Updating C and CLANG</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-1-estimating-a-proportion-1"><i class="fa fa-check"></i><b>8.2</b> Example 1: estimating a proportion</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-1"><i class="fa fa-check"></i><b>8.2.1</b> The Model</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#load-data"><i class="fa fa-check"></i><b>8.2.2</b> Load Data</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#specify-the-model"><i class="fa fa-check"></i><b>8.2.3</b> Specify the model</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#run-the-model"><i class="fa fa-check"></i><b>8.2.4</b> Run the model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#extracting-information-from-a-jags-run"><i class="fa fa-check"></i><b>8.3</b> Extracting information from a JAGS run</a><ul>
<li class="chapter" data-level="8.3.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#posterior-1"><i class="fa fa-check"></i><b>8.3.1</b> posterior()</a></li>
<li class="chapter" data-level="8.3.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#side-note-posterior-sampling-and-the-grid-method"><i class="fa fa-check"></i><b>8.3.2</b> Side note: posterior sampling and the grid method</a></li>
<li class="chapter" data-level="8.3.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-coda"><i class="fa fa-check"></i><b>8.3.3</b> Using coda</a></li>
<li class="chapter" data-level="8.3.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-bayesplot"><i class="fa fa-check"></i><b>8.3.4</b> Using bayesplot</a></li>
<li class="chapter" data-level="8.3.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-kruschkes-functions"><i class="fa fa-check"></i><b>8.3.5</b> Using Kruschke’s functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#optional-arguments-to-jags"><i class="fa fa-check"></i><b>8.4</b> Optional arguments to jags()</a><ul>
<li class="chapter" data-level="8.4.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#number-and-size-of-chains"><i class="fa fa-check"></i><b>8.4.1</b> Number and size of chains</a></li>
<li class="chapter" data-level="8.4.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#starting-point-for-chains"><i class="fa fa-check"></i><b>8.4.2</b> Starting point for chains</a></li>
<li class="chapter" data-level="8.4.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#running-chains-in-parallel"><i class="fa fa-check"></i><b>8.4.3</b> Running chains in parallel</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-2-comparing-two-proportions"><i class="fa fa-check"></i><b>8.5</b> Example 2: comparing two proportions</a><ul>
<li class="chapter" data-level="8.5.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-data"><i class="fa fa-check"></i><b>8.5.1</b> The data</a></li>
<li class="chapter" data-level="8.5.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-2"><i class="fa fa-check"></i><b>8.5.2</b> The model</a></li>
<li class="chapter" data-level="8.5.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#describing-the-model-to-jags"><i class="fa fa-check"></i><b>8.5.3</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="8.5.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#fitting-the-model"><i class="fa fa-check"></i><b>8.5.4</b> Fitting the model</a></li>
<li class="chapter" data-level="8.5.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#inspecting-the-results"><i class="fa fa-check"></i><b>8.5.5</b> Inspecting the results</a></li>
<li class="chapter" data-level="8.5.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#difference-in-proportions"><i class="fa fa-check"></i><b>8.5.6</b> Difference in proportions</a></li>
<li class="chapter" data-level="8.5.7" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#sampling-from-the-prior"><i class="fa fa-check"></i><b>8.5.7</b> Sampling from the prior</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#ch08-exercises"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="heierarchical-models.html"><a href="heierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Heierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#gamma-distributions"><i class="fa fa-check"></i><b>9.1</b> Gamma Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#one-coin-from-one-mint"><i class="fa fa-check"></i><b>9.2</b> One coin from one mint</a></li>
<li class="chapter" data-level="9.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-one-mint"><i class="fa fa-check"></i><b>9.3</b> Multiple coins from one mint</a></li>
<li class="chapter" data-level="9.4" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-multiple-mints"><i class="fa fa-check"></i><b>9.4</b> Multiple coins from multiple mints</a></li>
<li class="chapter" data-level="9.5" data-path="heierarchical-models.html"><a href="heierarchical-models.html#therapeutic-touch"><i class="fa fa-check"></i><b>9.5</b> Therapeutic Touch</a><ul>
<li class="chapter" data-level="9.5.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#abstract"><i class="fa fa-check"></i><b>9.5.1</b> Abstract</a></li>
<li class="chapter" data-level="9.5.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#data-1"><i class="fa fa-check"></i><b>9.5.2</b> Data</a></li>
<li class="chapter" data-level="9.5.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#a-heierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> A heierarchical model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="heierarchical-models.html"><a href="heierarchical-models.html#other-parameterizations-we-might-have-tried"><i class="fa fa-check"></i><b>9.6</b> Other parameterizations we might have tried</a><ul>
<li class="chapter" data-level="9.6.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shape-parameters-for-beta"><i class="fa fa-check"></i><b>9.6.1</b> Shape parameters for Beta</a></li>
<li class="chapter" data-level="9.6.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#mean-instead-of-mode"><i class="fa fa-check"></i><b>9.6.2</b> Mean instead of mode</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shrinkage"><i class="fa fa-check"></i><b>9.7</b> Shrinkage</a></li>
<li class="chapter" data-level="9.8" data-path="heierarchical-models.html"><a href="heierarchical-models.html#example-baseball-batting-average"><i class="fa fa-check"></i><b>9.8</b> Example: Baseball Batting Average</a></li>
<li class="chapter" data-level="9.9" data-path="heierarchical-models.html"><a href="heierarchical-models.html#ch09-exercises"><i class="fa fa-check"></i><b>9.9</b> Exerciess</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> (Model Comparison)</a></li>
<li class="chapter" data-level="11" data-path="nhst.html"><a href="nhst.html"><i class="fa fa-check"></i><b>11</b> (NHST)</a></li>
<li class="chapter" data-level="12" data-path="point-null-hypotheses.html"><a href="point-null-hypotheses.html"><i class="fa fa-check"></i><b>12</b> (Point Null Hypotheses)</a></li>
<li class="chapter" data-level="13" data-path="goals-power-sample-size.html"><a href="goals-power-sample-size.html"><i class="fa fa-check"></i><b>13</b> (Goals, Power, Sample Size)</a></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#why-stan-might-work-better"><i class="fa fa-check"></i><b>14.1</b> Why Stan might work better</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#describing-a-model-to-stan"><i class="fa fa-check"></i><b>14.2</b> Describing a model to Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#samping-from-the-prior"><i class="fa fa-check"></i><b>14.3</b> Samping from the prior</a></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#ch14-exercises"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glm-overview.html"><a href="glm-overview.html"><i class="fa fa-check"></i><b>15</b> GLM Overview</a><ul>
<li class="chapter" data-level="15.1" data-path="glm-overview.html"><a href="glm-overview.html#data-consists-of-observations-of-variables"><i class="fa fa-check"></i><b>15.1</b> Data consists of observations of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="glm-overview.html"><a href="glm-overview.html#variable-roles"><i class="fa fa-check"></i><b>15.1.1</b> Variable Roles</a></li>
<li class="chapter" data-level="15.1.2" data-path="glm-overview.html"><a href="glm-overview.html#types-of-variables"><i class="fa fa-check"></i><b>15.1.2</b> Types of Variables</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="glm-overview.html"><a href="glm-overview.html#glm-framework"><i class="fa fa-check"></i><b>15.2</b> GLM Framework</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html"><i class="fa fa-check"></i><b>16</b> Estimating One and Two Means</a><ul>
<li class="chapter" data-level="16.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#basic-model-for-two-means"><i class="fa fa-check"></i><b>16.1</b> Basic Model for Two Means</a><ul>
<li class="chapter" data-level="16.1.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-2"><i class="fa fa-check"></i><b>16.1.1</b> Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model"><i class="fa fa-check"></i><b>16.1.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#an-old-sleep-study"><i class="fa fa-check"></i><b>16.2</b> An Old Sleep Study</a><ul>
<li class="chapter" data-level="16.2.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-3"><i class="fa fa-check"></i><b>16.2.1</b> Data</a></li>
<li class="chapter" data-level="16.2.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model-1"><i class="fa fa-check"></i><b>16.2.2</b> Model</a></li>
<li class="chapter" data-level="16.2.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#separate-standard-deviations-for-each-group"><i class="fa fa-check"></i><b>16.2.3</b> Separate standard deviations for each group</a></li>
<li class="chapter" data-level="16.2.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#comparison-to-t-test"><i class="fa fa-check"></i><b>16.2.4</b> Comparison to t-test</a></li>
<li class="chapter" data-level="16.2.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#rope-region-of-practical-equivalence"><i class="fa fa-check"></i><b>16.2.5</b> ROPE (Region of Practical Equivalence)</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#variations-on-the-theme"><i class="fa fa-check"></i><b>16.3</b> Variations on the theme</a><ul>
<li class="chapter" data-level="16.3.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-distributions-for-the-response"><i class="fa fa-check"></i><b>16.3.1</b> Other distributions for the response</a></li>
<li class="chapter" data-level="16.3.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-priors-for-sigma-or-tau"><i class="fa fa-check"></i><b>16.3.2</b> Other Priors for <span class="math inline">\(\sigma\)</span> (or <span class="math inline">\(\tau\)</span>)</a></li>
<li class="chapter" data-level="16.3.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#paired-comparisons"><i class="fa fa-check"></i><b>16.3.3</b> Paired Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#how-many-chains-how-long"><i class="fa fa-check"></i><b>16.4</b> How many chains? How long?</a><ul>
<li class="chapter" data-level="16.4.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#why-multiple-chains"><i class="fa fa-check"></i><b>16.4.1</b> Why multiple chains?</a></li>
<li class="chapter" data-level="16.4.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#what-large-n.eff-does-and-doesnt-do-for-us"><i class="fa fa-check"></i><b>16.4.2</b> What large n.eff does and doesn’t do for us</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#looking-at-likelihood"><i class="fa fa-check"></i><b>16.5</b> Looking at Likelihood</a></li>
<li class="chapter" data-level="16.6" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#ch16-exercises"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>17</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="17.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-deluxe-basic-model"><i class="fa fa-check"></i><b>17.1</b> The deluxe basic model</a><ul>
<li class="chapter" data-level="17.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#likelihood-1"><i class="fa fa-check"></i><b>17.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="17.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#priors"><i class="fa fa-check"></i><b>17.1.2</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#example-galtons-data"><i class="fa fa-check"></i><b>17.2</b> Example: Galton’s Data</a><ul>
<li class="chapter" data-level="17.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#describing-the-model-to-jags-1"><i class="fa fa-check"></i><b>17.2.1</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="17.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#problems-and-how-to-fix-them"><i class="fa fa-check"></i><b>17.2.2</b> Problems and how to fix them</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#centering-and-standardizing"><i class="fa fa-check"></i><b>17.3</b> Centering and Standardizing</a><ul>
<li class="chapter" data-level="17.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#beta_0-and-beta_1-are-still-correlated"><i class="fa fa-check"></i><b>17.3.1</b> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are still correlated</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#weve-fit-a-model-now-what"><i class="fa fa-check"></i><b>17.4</b> We’ve fit a model, now what?</a><ul>
<li class="chapter" data-level="17.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#estimate-parameters"><i class="fa fa-check"></i><b>17.4.1</b> Estimate parameters</a></li>
<li class="chapter" data-level="17.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#make-predictions"><i class="fa fa-check"></i><b>17.4.2</b> Make predictions</a></li>
<li class="chapter" data-level="17.4.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>17.4.3</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="17.4.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#posterior-predictive-checks-with-bayesplot"><i class="fa fa-check"></i><b>17.4.4</b> Posterior predictive checks with bayesplot</a></li>
<li class="chapter" data-level="17.4.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#ppc-with-custom-data"><i class="fa fa-check"></i><b>17.4.5</b> PPC with custom data</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#fitting-models-with-stan"><i class="fa fa-check"></i><b>17.5</b> Fitting models with Stan</a></li>
<li class="chapter" data-level="17.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#two-intercepts-model"><i class="fa fa-check"></i><b>17.6</b> Two Intercepts model</a></li>
<li class="chapter" data-level="17.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#ch17-exercises"><i class="fa fa-check"></i><b>17.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat"><i class="fa fa-check"></i><b>18.1</b> SAT</a><ul>
<li class="chapter" data-level="18.1.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-vs-expenditure"><i class="fa fa-check"></i><b>18.1.1</b> SAT vs expenditure</a></li>
<li class="chapter" data-level="18.1.2" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-vs-expenditure-and-percent-taking-the-test"><i class="fa fa-check"></i><b>18.1.2</b> SAT vs expenditure and percent taking the test</a></li>
<li class="chapter" data-level="18.1.3" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#whats-wrong-with-this-picture"><i class="fa fa-check"></i><b>18.1.3</b> What’s wrong with this picture?</a></li>
<li class="chapter" data-level="18.1.4" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#multiple-predictors-in-pictures"><i class="fa fa-check"></i><b>18.1.4</b> Multiple predictors in pictures</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#interaction"><i class="fa fa-check"></i><b>18.2</b> Interaction</a><ul>
<li class="chapter" data-level="18.2.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-with-interaction-term"><i class="fa fa-check"></i><b>18.2.1</b> SAT with interaction term</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#fitting-a-linear-model-with-brms"><i class="fa fa-check"></i><b>18.3</b> Fitting a linear model with brms</a><ul>
<li class="chapter" data-level="18.3.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#adjusting-the-model-with-brm"><i class="fa fa-check"></i><b>18.3.1</b> Adjusting the model with brm()</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#interpretting-a-model-with-an-interaction-term"><i class="fa fa-check"></i><b>18.4</b> Interpretting a model with an interaction term</a><ul>
<li class="chapter" data-level="18.4.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#thinking-about-the-noise"><i class="fa fa-check"></i><b>18.4.1</b> Thinking about the noise</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#ch18-exercises"><i class="fa fa-check"></i><b>18.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="nominal-predictors.html"><a href="nominal-predictors.html"><i class="fa fa-check"></i><b>19</b> Nominal Predictors</a><ul>
<li class="chapter" data-level="19.1" data-path="nominal-predictors.html"><a href="nominal-predictors.html#fruit-flies-study"><i class="fa fa-check"></i><b>19.1</b> Fruit flies Study</a></li>
<li class="chapter" data-level="19.2" data-path="nominal-predictors.html"><a href="nominal-predictors.html#model-1-out-of-the-box"><i class="fa fa-check"></i><b>19.2</b> Model 1: Out-of-the-box</a></li>
<li class="chapter" data-level="19.3" data-path="nominal-predictors.html"><a href="nominal-predictors.html#model-2-custom-priors"><i class="fa fa-check"></i><b>19.3</b> Model 2: Custom Priors</a></li>
<li class="chapter" data-level="19.4" data-path="nominal-predictors.html"><a href="nominal-predictors.html#models-3-and-4-alternate-parameterizations"><i class="fa fa-check"></i><b>19.4</b> Models 3 and 4: alternate parameterizations</a></li>
<li class="chapter" data-level="19.5" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-groups"><i class="fa fa-check"></i><b>19.5</b> Comparing groups</a><ul>
<li class="chapter" data-level="19.5.1" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-to-the-intercept-group"><i class="fa fa-check"></i><b>19.5.1</b> Comparing to the “intercept group”</a></li>
<li class="chapter" data-level="19.5.2" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-others-pairs-of-groups"><i class="fa fa-check"></i><b>19.5.2</b> Comparing others pairs of groups</a></li>
<li class="chapter" data-level="19.5.3" data-path="nominal-predictors.html"><a href="nominal-predictors.html#contrasts-comparing-groups-of-groups"><i class="fa fa-check"></i><b>19.5.3</b> Contrasts: Comparing “groups of groups”</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="nominal-predictors.html"><a href="nominal-predictors.html#more-variations"><i class="fa fa-check"></i><b>19.6</b> More Variations</a></li>
<li class="chapter" data-level="19.7" data-path="nominal-predictors.html"><a href="nominal-predictors.html#ch19-exercises"><i class="fa fa-check"></i><b>19.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#crop-yield-by-till-method-and-fertilizer"><i class="fa fa-check"></i><b>20.1</b> Crop Yield by Till Method and Fertilizer</a></li>
<li class="chapter" data-level="20.2" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#split-plot-design"><i class="fa fa-check"></i><b>20.2</b> Split Plot Design</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotymous-response.html"><a href="dichotymous-response.html"><i class="fa fa-check"></i><b>21</b> Dichotymous Response</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">(Re)Doing Bayesain Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayes-rule-and-the-grid-method" class="section level1">
<h1><span class="header-section-number">5</span> Bayes’ Rule and the Grid Method</h1>
<div id="the-big-bayesian-idea" class="section level2">
<h2><span class="header-section-number">5.1</span> The Big Bayesian Idea</h2>
<ul>
<li>Model specifies</li>
</ul>
<p><span class="math display">\[\begin{align*}
\mbox{prior: } \quad  &amp; p(\mbox{parameter values})
\\
\mbox{likelihood: } \quad &amp; p(\mbox{data values} \mid \mbox{parameter values})
\end{align*}\]</span></p>
<ul>
<li>Bayes rule + data gives</li>
</ul>
<p><span class="math display">\[\begin{align*}
\mbox{posterior: } \quad  &amp; p(\mbox{parameter values} \mid \mbox{data values})
\end{align*}\]</span></p>
<p>Let’s let <span class="math inline">\(D\)</span> be the data values and <span class="math inline">\(\theta\)</span> the parameter values.
So the prior is <span class="math inline">\(p(\theta)\)</span>, and the posterior is <span class="math inline">\(p(\theta \mid D)\)</span>.
Recall that</p>
<p><span class="math display">\[\begin{align*}
p(D, \theta) &amp;= p(\theta) \cdot p(D \mid \theta) \\
             &amp;= p(D) \cdot p(\theta \mid D) \\[3mm]
p(D) \cdot p(\theta \mid D) &amp;= p(\theta) \cdot p(D \mid \theta) 
\end{align*}\]</span></p>
<p>Solving that last equation for <span class="math inline">\(p(\theta \mid D)\)</span> gives</p>
<p><span class="math display">\[\begin{align*}
p(\theta \mid D) 
  &amp;= \frac{ p(\theta) \cdot p(D \mid \theta)}{p(D)} \\
  &amp;= \frac{ p(\theta) \cdot p(D \mid \theta)}{\sum_{\theta^*} p(\theta^*) p(D \mid \theta^*)} \mbox{or}
  \frac{ p(\theta) \cdot p(D \mid \theta)}{\int p(\theta^*) p(D \mid \theta^*) \; d\theta^*} \\
\end{align*}\]</span></p>
<p><strong>Important facts about the denominator:</strong></p>
<ul>
<li>The denominator sums or integrates over all possible
numerators.</li>
<li>The denominator depends on <span class="math inline">\(D\)</span> but not on <span class="math inline">\(\theta\)</span>.<br />
</li>
<li>So it is just a normalizing constant that guarantees
that total probability is 1 for the posterior distribution.
That is, it converts the kernel into a pdf.</li>
<li>If we only need a kernel, we don’t need to compute the denominator.</li>
</ul>
<p>Another way of saying all this is that</p>
<p><span class="math display">\[\begin{align*}
p(\theta \mid D) 
  &amp;\propto  p(\theta) \cdot p(D \mid \theta) \\[3mm]
  \mbox{posterior} &amp; \propto \mbox{prior} \cdot \mbox{likelihood}
  \\[3mm]
  \mbox{kernel of posterior} &amp;= \mbox{prior} \cdot \mbox{likelihood}
\end{align*}\]</span></p>
<p>That last line is worth repeating. It’s the most important equation
in this course:</p>
<p><span class="math display">\[
\LARGE
\mbox{(kernel of) posterior} = \mbox{prior} \cdot \mbox{likelihood} 
\]</span></p>
<div id="likelihood" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Likelihood</h3>
<p>For a fixed data set <span class="math inline">\(D\)</span>,
<span class="math inline">\(p(\theta)\)</span> and <span class="math inline">\(p(\theta \mid D)\)</span> are pdfs (or pmfs) describing
the prior and posterior distributions of <span class="math inline">\(\theta\)</span>.</p>
<p>The likelihood function is different. If we consider <span class="math inline">\(p(D \mid \theta)\)</span>
to be a function of <span class="math inline">\(D\)</span>, it is not a pdf or pmf, and the total area under
the curve for all possible data sets need not be 1.</p>
<p>The likelihood function is specified by the model.
The model must tell us “how likely a given data set would be” for a
specified value of the parameters <span class="math inline">\(\theta\)</span>.</p>
</div>
<div id="when-bayes-is-easy" class="section level3">
<h3><span class="header-section-number">5.1.2</span> When Bayes is easy</h3>
<p>If the number of possible values for <span class="math inline">\(\theta\)</span> is small (so we
could just do all the arithmetic by brute force)
or if the integrals and sums are easy to compute, then
Bayesian updating (computing the posterior) is relatively easy.
We’ll start with examples (at least approximately) in those two happy
situations and worry about some of the complications a little bit later.</p>
</div>
</div>
<div id="estimating-the-bias-in-a-coin-using-the-grid-method" class="section level2">
<h2><span class="header-section-number">5.2</span> Estimating the bias in a coin using the Grid Method</h2>
<p>Big ideas:</p>
<ol style="list-style-type: decimal">
<li>Discretize the parameter space if it is not already discrete.</li>
<li>Compute prior and likelihood at each “grid point” in the (discretized) parameter space.</li>
<li>Compute (kernel of) posterior as prior <span class="math inline">\(\cdot\)</span> likelihood at each “grid point”.</li>
<li>Normalize to get posterior, if desired.</li>
</ol>
<p>Below we will see how to perform these four steps in R.</p>
<div id="creating-a-grid" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Creating a Grid</h3>
<p>The parameter is <span class="math inline">\(\theta\)</span> and we will discretize by selecting
1001 grid points from 0 to 1 by 0.001.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<pre class="sourceCode r"><code class="sourceCode r">CoinsGrid &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)
  ) 
<span class="kw">head</span>(CoinsGrid)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">theta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.000</td>
</tr>
<tr class="even">
<td align="right">0.001</td>
</tr>
<tr class="odd">
<td align="right">0.002</td>
</tr>
<tr class="even">
<td align="right">0.003</td>
</tr>
<tr class="odd">
<td align="right">0.004</td>
</tr>
<tr class="even">
<td align="right">0.005</td>
</tr>
</tbody>
</table>
<p>Now let’s add on a triangle prior with a peak when <span class="math inline">\(\theta = 0.5\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(triangle)
CoinsGrid &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">prior =</span> <span class="kw">dtriangle</span>(theta)        <span class="co"># triangle distribution</span>
  )
<span class="kw">gf_area</span>(prior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-grid-02-1.png" width="65%" /></p>
<p>Now the likelihood for a small data set: 1 success out of 4 trials.
This is the trickiest part. <code>dbinom(x, size = n, prob = theta)</code> will calculate
the probability that we want for a given value of <code>x</code>, <code>n</code>, and <code>theta</code>. We
want to do this</p>
<ul>
<li>for each value of <code>theta</code></li>
<li>but using the same values for <code>x</code> and <code>n</code> each time</li>
</ul>
<p><code>purrr:map_dbl()</code> helps us tell R how to do this. Each value of
<code>theta</code> gets plugged in for <code>.x</code> and a vector of numbers (dbl stands for
double – computer talk for real number) is returned.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
x &lt;-<span class="st"> </span><span class="dv">1</span>; n &lt;-<span class="st"> </span><span class="dv">4</span>
CoinsGrid &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">prior =</span> <span class="kw">dtriangle</span>(theta),        <span class="co"># triangle distribution</span>
    <span class="dt">likelihood =</span> <span class="kw">map_dbl</span>(theta, <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, .x))
 )
<span class="kw">gf_area</span>( prior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_area</span>( likelihood <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;green&quot;</span>) </code></pre>
<p><img src="Redoing_files/figure-html/ch05-grid-03-1.png" width="65%" /></p>
<p>Note: Likelihoods are NOT pmfs or pdfs, so the total area under a likelihood
function is usually not 1. We can make a normalized version for the purpose
of plotting. (Recall, we will normalize the posterior at the end anyway,
so it is fine if the likelihood is off by a constant multiple at this point
in the process.) We do this by dividing by sum of the likelihoods and by
the width of the spaces between grid points.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
x &lt;-<span class="st"> </span><span class="dv">1</span>; n &lt;-<span class="st"> </span><span class="dv">4</span>
CoinsGrid &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">prior =</span> <span class="kw">dtriangle</span>(theta),        <span class="co"># triangle distribution</span>
    <span class="dt">likelihood  =</span> <span class="kw">map_dbl</span>(theta, <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, .x)),
    <span class="dt">likelihood1 =</span> likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood) <span class="op">/</span><span class="st"> </span><span class="fl">0.001</span>    <span class="co"># &quot;normalized&quot;</span>
 )
<span class="kw">gf_area</span>( prior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_area</span>( likelihood1 <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;green&quot;</span>) </code></pre>
<p><img src="Redoing_files/figure-html/ch05-grid-04-1.png" width="65%" /></p>
<p>The hardest part of the coding (computing the likelihood) is now done.
Getting the posterior is as simple as computing a product.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
x &lt;-<span class="st"> </span><span class="dv">1</span>; n &lt;-<span class="st"> </span><span class="dv">4</span>
CoinsGrid &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">prior =</span> <span class="kw">dtriangle</span>(theta),        <span class="co"># triangle distribution</span>
    <span class="dt">likelihood  =</span> <span class="kw">map_dbl</span>(theta, <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, .x)),
    <span class="dt">likelihood1 =</span> likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood) <span class="op">/</span><span class="st"> </span><span class="fl">0.001</span>, <span class="co"># &quot;normalized&quot;</span>
    <span class="dt">posterior0 =</span> prior <span class="op">*</span><span class="st"> </span>likelihood,                    <span class="co"># unnormalized</span>
    <span class="dt">posterior =</span> posterior0 <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(posterior0) <span class="op">/</span><span class="st"> </span><span class="fl">0.001</span>    <span class="co"># normalized</span>
  )

<span class="kw">gf_area</span>( prior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_area</span>( likelihood1 <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;green&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_area</span>( posterior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) </code></pre>
<p><img src="Redoing_files/figure-html/ch05-grid-05-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_line</span>( prior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_line</span>( likelihood1 <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">color =</span> <span class="st">&quot;green&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_line</span>( posterior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid, <span class="dt">color =</span> <span class="st">&quot;steelblue&quot;</span>) </code></pre>
<p><img src="Redoing_files/figure-html/ch05-grid-05-2.png" width="65%" /></p>
</div>
<div id="hdi-from-the-grid" class="section level3">
<h3><span class="header-section-number">5.2.2</span> HDI from the grid</h3>
<p>The <strong>CalvinBayes</strong> packages includes a function <code>hdi_from_grid()</code> to compute
highest density intervals from a grid.
The basic idea of the algorithm used is to
sort the grid by the posterior values.
The mode will be at the end of the list, and the
“bottom 95%” will be the HDI (or some other percent if we choose a
different <code>level</code>).
This method works as long as the posterior is unimodal, increasing to the mode
from either side.</p>
<p><code>hdi_from_grid()</code> is slightly more complicated because it handles things like
multiple parameters and performs some standardization (so we can work with
kernels, for example). It does assume that the grid is uniform (ie, evenly
spaced).</p>
<p>We simply provide</p>
<ul>
<li>the data frame containing our grid calculations,</li>
<li><code>pars</code>: the name of the parameter (or parameters) for which
we want intervals (default is the first column in the grid),</li>
<li><code>prob</code>: the probability we want in covered by our interval (0.95 by default),</li>
<li><code>posterior</code>: the name of the column containing the posterior kernel values
(<code>&quot;posterior&quot;</code> by default)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(CalvinBayes)
<span class="kw">hdi_from_grid</span>(CoinsGrid, <span class="dt">pars =</span> <span class="st">&quot;theta&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.95</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">param</th>
<th align="right">lo</th>
<th align="right">hi</th>
<th align="right">prob</th>
<th align="right">height</th>
<th align="right">mode_height</th>
<th align="right">mode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">theta</td>
<td align="right">0.098</td>
<td align="right">0.681</td>
<td align="right">0.9501</td>
<td align="right">0.4833</td>
<td align="right">2.37</td>
<td align="right">0.4</td>
</tr>
</tbody>
</table>
<p>With this information in hand, we can add a representation of the 95%
HDI to our plot.</p>
<pre class="sourceCode r"><code class="sourceCode r">HDICoins &lt;-<span class="st"> </span><span class="kw">hdi_from_grid</span>(CoinsGrid, <span class="dt">pars =</span> <span class="st">&quot;theta&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.95</span>)
<span class="kw">gf_line</span>(posterior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGrid) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_hline</span>(<span class="dt">yintercept =</span> <span class="op">~</span>height, <span class="dt">data =</span> HDICoins, 
           <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_pointrangeh</span>(height <span class="op">~</span><span class="st"> </span>mode <span class="op">+</span><span class="st"> </span>lo <span class="op">+</span><span class="st"> </span>hi, <span class="dt">data =</span> HDICoins, 
             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">caption =</span> <span class="st">&quot;posterior mode and 95% HPI indicated in red&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-hdi-coins-1.png" width="65%" /></p>
</div>
<div id="automating-the-grid" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Automating the grid</h3>
<p>Note: This function is a bit different from <code>CalvinBayes::BernGrid()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">MyBernGrid &lt;-<span class="st"> </span><span class="cf">function</span>(
  x, n,                   <span class="co"># x successes in n tries</span>
  <span class="dt">prior =</span> dunif,          
  <span class="dt">resolution =</span> <span class="dv">1000</span>,      <span class="co"># number of intervals to use for grid</span>
  ...) {
  
  Grid &lt;-<span class="st"> </span>
<span class="st">    </span><span class="kw">expand.grid</span>(
      <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length.out =</span> resolution <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)
      ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>( <span class="co"># saving only the normalized version of each</span>
      <span class="dt">prior =</span> <span class="kw">prior</span>(theta, ...),
      <span class="dt">prior =</span> prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prior) <span class="op">*</span><span class="st"> </span>resolution,
      <span class="dt">likelihood  =</span> <span class="kw">dbinom</span>(x, n, theta),
      <span class="dt">likelihood =</span> likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood) <span class="op">*</span><span class="st"> </span>resolution,
      <span class="dt">posterior =</span> prior <span class="op">*</span><span class="st"> </span>likelihood,
      <span class="dt">posterior  =</span> posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(posterior) <span class="op">*</span><span class="st"> </span>resolution
    )
  
  H &lt;-<span class="st"> </span><span class="kw">hdi_from_grid</span>(Grid, <span class="dt">pars =</span> <span class="st">&quot;theta&quot;</span>, <span class="dt">prob =</span> <span class="fl">0.95</span>)
  
  <span class="kw">gf_line</span>(prior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> Grid, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;prior&quot;</span>, 
          <span class="dt">size =</span> <span class="fl">1.15</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_line</span>(likelihood <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> Grid, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;likelihood&quot;</span>, 
          <span class="dt">size =</span> <span class="fl">1.15</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_line</span>(posterior <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> Grid, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;posterior&quot;</span>,
          <span class="dt">size =</span> <span class="fl">1.15</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">gf_pointrangeh</span>( 
      height <span class="op">~</span><span class="st"> </span>mode <span class="op">+</span><span class="st"> </span>lo <span class="op">+</span><span class="st"> </span>hi, <span class="dt">data =</span> H,
      <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">gf_labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior/Likelihood/Posterior&quot;</span>, 
            <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;Data: n =&quot;</span>, n, <span class="st">&quot;, x =&quot;</span>, x)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">gf_refine</span>(
      <span class="kw">scale_color_manual</span>(
        <span class="dt">values =</span> <span class="kw">c</span>(
          <span class="st">&quot;prior&quot;</span> =<span class="st"> &quot;forestgreen&quot;</span>, 
          <span class="st">&quot;likelihood&quot;</span> =<span class="st"> &quot;blue&quot;</span>, 
          <span class="st">&quot;posterior&quot;</span> =<span class="st"> &quot;red&quot;</span>),
        <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;prior&quot;</span>, <span class="st">&quot;likelihood&quot;</span>, <span class="st">&quot;posterior&quot;</span>)
        )) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">print</span>()
  <span class="kw">invisible</span>(Grid)   <span class="co"># return the Grid, but don&#39;t show it</span>
}</code></pre>
<p>This function let’s us quickly explore several scenarios and compare
the results.</p>
<ul>
<li>How does changing the prior affect the posterior?</li>
<li>How does changing the data affect the posterior?</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(triangle)
<span class="kw">MyBernGrid</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dt">prior =</span> dtriangle, <span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">c =</span> <span class="fl">0.5</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MyBernGrid</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dt">prior =</span> dunif)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-2.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MyBernGrid</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dt">prior =</span> dtriangle, <span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">c =</span> <span class="fl">0.5</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-3.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MyBernGrid</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dt">prior =</span> dunif)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-4.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MyBernGrid</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dt">prior =</span> dtriangle, <span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">c =</span> <span class="fl">0.8</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-5.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MyBernGrid</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dt">prior =</span> dtriangle, <span class="dt">a =</span> <span class="dv">0</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">c =</span> <span class="fl">0.8</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-6.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MyBernGrid</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dt">prior =</span> dbeta, <span class="dt">shape1 =</span> <span class="dv">25</span>, <span class="dt">shape2 =</span> <span class="dv">12</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-use-myberngrid-7.png" width="65%" /></p>
</div>
</div>
<div id="working-on-the-log-scale" class="section level2">
<h2><span class="header-section-number">5.3</span> Working on the log scale</h2>
<p>Very often it is numerically better to work on the log scale, computing
the logs of the prior, likelihood, and posterior. There are at least two
reasons for this:</p>
<ul>
<li>Likelihoods are often very small, especially if there is a lot of data.
(Even with the most credible parameter values, the probability of getting
exactly the data set that was observed is very low.)</li>
<li>Likelihoods often involve products and exponentiation. Take logarithms turns
these into sums and products. In fact, we can often compute these logs without
first computing the prior, likelihood, or posterior. (It depends on the form
of those functions.)</li>
</ul>
<p>Let’s redo our previous example working on the log scale until the very end.</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>; n &lt;-<span class="st"> </span><span class="dv">4</span>
CoinsGridLog &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.001</span>)
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">logprior =</span> <span class="kw">log</span>(<span class="kw">dtriangle</span>(theta, <span class="dv">0</span>, <span class="dv">1</span>)),       <span class="co"># triangle distribution</span>
    <span class="dt">loglik  =</span> 
      <span class="kw">map_dbl</span>(theta, <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> n, <span class="dt">prob =</span> .x, <span class="dt">log =</span> <span class="ot">TRUE</span>)),
    <span class="dt">logpost =</span> logprior <span class="op">+</span><span class="st"> </span>loglik,
    <span class="dt">posterior =</span> <span class="kw">exp</span>(logpost),
    <span class="dt">posterior1 =</span> posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(posterior, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  )
<span class="kw">gf_line</span>(posterior1 <span class="op">~</span><span class="st"> </span>theta, <span class="dt">data =</span> CoinsGridLog)</code></pre>
<p><img src="Redoing_files/figure-html/ch05-logscale-1.png" width="65%" /></p>
</div>
<div id="discrete-params" class="section level2">
<h2><span class="header-section-number">5.4</span> Discrete Parameters</h2>
<p>Most of the parameters we will encounter will be able to take on
all values in some interval. If we have parameter that can only take
on a discrete set of values, then the grid method is exact if we make
a grid point for each of those values.
Usually we think of parameters taking on numerical values, but here is an
example where a parameter takes on categorical labels for values.</p>
<p>Suppose we have a medical test for a disease and we know the following
information.</p>
<ul>
<li>Only 1 person in 1000 has the disease in our population of interest</li>
<li>If a person is healthy, the probability that the test will be correct
is 97%. (97% = <strong>specificity</strong> = true negative rate)</li>
<li>If a person is diseased, the probability that the test will be correct
is 99%. (99% = <strong>sensitivity</strong> = true positive rate)</li>
</ul>
<p>If a person is tested and the test comes back “positive” (indicating disease),
what is the probability that the person actually has the disease?</p>
<p>Our parameter that we want to estimate is disease status, which can take
on only two possible values: healthy or diseased.</p>
<pre class="sourceCode r"><code class="sourceCode r">Disease_Grid &lt;-
<span class="st">  </span><span class="kw">tibble</span>(
    <span class="dt">status =</span> <span class="kw">c</span>(<span class="st">&quot;healthy&quot;</span>, <span class="st">&quot;sick&quot;</span>),
    <span class="dt">prior =</span> <span class="kw">c</span>(<span class="dv">999</span><span class="op">/</span><span class="dv">1000</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">1000</span>)
  )
Disease_Grid</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">status</th>
<th align="right">prior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">healthy</td>
<td align="right">0.999</td>
</tr>
<tr class="even">
<td align="left">sick</td>
<td align="right">0.001</td>
</tr>
</tbody>
</table>
<p>Now let’s add in the likelihood and posterior information assuming
a positive test result.</p>
<pre class="sourceCode r"><code class="sourceCode r">Disease_Grid &lt;-
<span class="st">  </span><span class="kw">tibble</span>(
    <span class="dt">status =</span> <span class="kw">c</span>(<span class="st">&quot;healthy&quot;</span>, <span class="st">&quot;sick&quot;</span>),
    <span class="dt">prior =</span> <span class="kw">c</span>(<span class="dv">999</span><span class="op">/</span><span class="dv">1000</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">1000</span>),
    <span class="dt">likelihood =</span> <span class="kw">c</span>(.<span class="dv">03</span>, <span class="fl">.99</span>),
    <span class="dt">posterior =</span> prior <span class="op">*</span><span class="st"> </span>likelihood,
    <span class="dt">posterior1 =</span> posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(posterior)
  )
Disease_Grid</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">status</th>
<th align="right">prior</th>
<th align="right">likelihood</th>
<th align="right">posterior</th>
<th align="right">posterior1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">healthy</td>
<td align="right">0.999</td>
<td align="right">0.03</td>
<td align="right">0.030</td>
<td align="right">0.968</td>
</tr>
<tr class="even">
<td align="left">sick</td>
<td align="right">0.001</td>
<td align="right">0.99</td>
<td align="right">0.001</td>
<td align="right">0.032</td>
</tr>
</tbody>
</table>
<p>So we have updated our belief from a 0.1% chance the person has the disease to a 3.2$
chance that they have the disease. That’s a sizable increase, but the
person is still most likely healthy, not diseased.</p>
</div>
<div id="ch05-exercises" class="section level2">
<h2><span class="header-section-number">5.5</span> Exercises</h2>
<!-- Exercise 5.2. 
[Purpose: Getting an intuition for the previous results by using “natural frequency” and “Markov” representations] -->
<ol style="list-style-type: decimal">
<li><p>More testing.</p>
<ol style="list-style-type: lower-alpha">
<li>Suppose that the population consists of 100,000 people. Compute how many
people would be expected to fall into each cell of Table 5.4 on page 104 of
<em>DBDA2e</em>. (To compute the expected number of people in a cell,
just multiply the cell probability by the size of the population.)</li>
</ol>
<p>You should find that out of 100,000 people, only 100 have the disease,
while 99,900 do not have the disease.
These marginal frequencies instantiate the prior
probability that <span class="math inline">\(p(\theta = \frown) = 0.001\)</span>.
Notice also the cell frequencies in
the column <span class="math inline">\(\theta = \frown\)</span>, which indicate that of 100 people
with the disease, 99 have a positive test result and 1 has a negative
test result. These cell
frequencies instantiate the hit rate of 0.99.
Your job for this part of the exercise is to fill in the frequencies of
the remaining cells of the table.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Take a good look at the frequencies in the table you just computed
for the previous part. These are the so-called “natural frequencies” of the
events, as opposed to the somewhat unintuitive expression in terms of
conditional probabilities (Gigerenzer &amp; Hoffrage, 1995). From the cell
frequencies alone, determine the proportion of people who have the disease,
given that their test result is positive.</li>
</ol>
<p>Your answer should match the result from applying Bayes’ rule to
the probabilities.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Now we’ll consider a related representation of the probabilities in terms
of natural frequencies, which is especially useful when we accumulate more
data. This type of representation is called a “Markov” representation by
Krauss, Martignon, and Hoffrage (1999). Suppose now we start with a
population of <span class="math inline">\(N = 10,000,000\)</span> people. We expect 99.9% of them (i.e.,
9,990,000) not to have the disease, and just 0.1% (i.e., 10,000) to have the
disease. Now consider how many people we expect to test positive. Of the
10,000 people who have the disease, 99%, (i.e., 9,900) will be expected to
test positive. Of the 9,990,000 people who do not have the disease, 5%
(i.e., 499,500) will be expected to test positive. Now consider re-testing
everyone who has tested positive on the first test. How many of them are
expected to show a negative result on the re-test?</p></li>
<li><p>What proportion of people who test positive at first and then negative on
retest, actually have the disease? In other words, of the total number of
people at the bottom of the diagram in the previous part (those are the
people who tested positive then negative), what proportion of them are in
the left branch of the tree? How does the result compare with your answer to
Exercise 5.1?</p></li>
</ol></li>
</ol>
<!-- Exercise 5.1. [Purpose: Iterative application of Bayes’ rule, and seeing how posterior probabilities change with inclusion of more data.]  -->
<ol start="2" style="list-style-type: decimal">
<li><p>Suppose we have a test with a 97% specificity and a 99% sensitivity just
like in Section <a href="bayes-rule-and-the-grid-method.html#discrete-params">5.4</a>.
Now suppose that a random person is selected, has a first test that is positive,
then is retested and has a second test that is negative.<br />
Taking into account both tests, and assuming the results of the two tests
are independent, what is the probability that the person has the disease?</p>
<p>Hint: We can use the the posterior after the first test as a prior for the
second test. Be sure to keep as many decimal digits as possible (use R and
don’t round intermediate results).</p>
<p>Note: In this problem we are assuming the the results of the two tests
are independent, which might not be the case for some medical tests.</p></li>
</ol>
<!-- Exercise 5.3. [Purpose: To see a hands-on example of data-order invariance.] -->
<ol start="3" style="list-style-type: decimal">
<li><p>Consider again the disease and diagnostic test of the previous exercise and Section <a href="bayes-rule-and-the-grid-method.html#discrete-params">5.4</a>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Suppose that a person selected at random from the population gets the
test and it comes back negative. Compute the probability that the person has
the disease.</p></li>
<li>The person then gets re-tested, and on the second test the result is
positive. Compute the probability that the person has the disease.</li>
<li><p>How does the result compare with your answer in the
previous exercise?</p></li>
</ol></li>
<li><p>Modify <code>MyBernGrid()</code> so that it takes an argument specifying the
probability for the HDI. Use it to create a plot showing 50% HDI for
theta using a symmetric triangle prior and data consisting of 3 success and
5 failures.</p></li>
</ol>
<!-- Grid with two parameters -->
<ol start="5" style="list-style-type: decimal">
<li><p>Let’s try the grid method for a model with two parameters. Suppose we
want to estimate the mean and standard deviation of the heights of 21-year-old
American men or women (your choice which group). First, lets get some data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(NHANES)
Men   &lt;-<span class="st"> </span>NHANES <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;male&quot;</span>, Age <span class="op">==</span><span class="st"> </span><span class="dv">21</span>)
Women &lt;-<span class="st"> </span>NHANES <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;female&quot;</span>, Age <span class="op">==</span><span class="st"> </span><span class="dv">21</span>)</code></pre>
<p><strong>Likelihood</strong>
Our model is that heights are normally distributed with mean <span class="math inline">\(\mu\)</span> and
standard deviation <span class="math inline">\(\sigma\)</span>:</p>
<p><strong>Prior.</strong> For our prior, let’s use something informed just a little bit by
what we know about people (we could do better with other priors, but that’s
not our goal at the moment):</p>
<ul>
<li>the mean height is somewhere between 5 and 7 feet (let’s use 150 and 200 cm which
are close to that)</li>
<li>the standard deviation is positive, but no more than 20 cm (so 95% of people are within 40 cm (~ 16 inches) of average – that seems like a pretty safe bet).</li>
<li>we will use a uniform prior over these ranges (even though you probably believe
that some parts of the ranges are much more credible than others).</li>
</ul>
<p>So our model is
<span class="math display">\[\begin{align*}
 \mathrm{Height} &amp; \sim {\sf Norm}(\mu, \sigma) \\
 \mu             &amp; \sim {\sf Unif}(150, 200) \\
 \sigma          &amp; \sim {\sf Unif}(0, 20) 
 \end{align*}\]</span></p>
<p><strong>Grid.</strong> Use a grid that has 200-500 values for each parameter.
Fill in the ?? below to create and update your grid.</p>
<p>Notes:</p>
<ul>
<li>It is more numerically stable to work on the log-scale as much as possible,</li>
<li>You may normalize if you want to, but it isn’t necessary for this problem.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
Height_Grid &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">expand.grid</span>(
    <span class="dt">mu      =</span> <span class="kw">seq</span>(??, ??, ?? =<span class="st"> </span>??),
    <span class="dt">sigma   =</span> <span class="kw">seq</span>(??, ??, ?? =<span class="st"> </span>??)    
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(sigma <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># remove sigma = 0</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">prior =</span> ??,
    <span class="dt">logprior =</span> ??,
    <span class="dt">loglik =</span> 
      <span class="kw">map2_dbl</span>(mu, sigma, 
               <span class="op">~</span><span class="st"> </span>?? )      <span class="co"># use .x for mu and .y for sigma</span>
    <span class="dt">logpost =</span> logprior <span class="op">+</span><span class="st"> </span>loglik,
    <span class="dt">posterior =</span> <span class="kw">exp</span>(logpost)
  )</code></pre>
<p>Once you have created and updated your grid, you can visualize your
posterior using a command like this (use <code>gf_lims()</code> if you want to zoom in
a bit):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_tile</span>(posterior <span class="op">~</span><span class="st"> </span>mu <span class="op">+</span><span class="st"> </span>sigma, <span class="dt">data =</span> Height_Grid) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_contour</span>(posterior <span class="op">~</span><span class="st"> </span>mu<span class="op">+</span><span class="st"> </span>sigma, <span class="dt">data =</span> Height_Grid, <span class="dt">color =</span> <span class="st">&quot;yellow&quot;</span>) </code></pre>
<p>Now answer the following questions.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Using the picture you just created,
what would you say are credible values for <span class="math inline">\(\mu\)</span> and for <span class="math inline">\(\sigma\)</span>?</p></li>
<li><p>Now use <code>hdi_from_grid()</code> to compute a 90% highest density (posterior)
intervals for each parameter. Do those make sense when you compare
to the picture?</p></li>
<li><p>Create a plot showing the posterior distribution for <span class="math inline">\(\mu\)</span> and a 90%
HDI for <span class="math inline">\(\mu\)</span>. [Hint: how can you get a grid for the marginal
distribution of <span class="math inline">\(\mu\)</span> from the grid for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>?]</p></li>
</ol></li>
<li><p>Redo the previous problem using a triangle prior for each parameter.
You may choose where to put the peak of the triangle.</p></li>
<li><p>Bob plays basketball.<br />
He shoots 70% of his shots from 2-point range and makes 48% of these shots.
He shoots 30% of his shots from 3-point range and makes 32% of these shots.
Joe just made a shot. What is the probability that it was a 3-point shot?</p>
<p>Do this problem twice. The first time, use probability rules, carefully
denoting the probabilities involved. (For any number that appears, I should
be able to tell from your notation where it came from.) The second time,
use the “grid method”.</p></li>
<li><p>Alice has 3 hats labeled with the letters H, A, and T.
In each hat are marbles of various colors.</p>
<table>
<thead>
<tr class="header">
<th align="center">Hat</th>
<th align="center">White marbles</th>
<th align="center">Red marbles</th>
<th align="center">Yellow marbles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">H</td>
<td align="center">4</td>
<td align="center">10</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">A</td>
<td align="center">6</td>
<td align="center">12</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">T</td>
<td align="center">5</td>
<td align="center">3</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<p>Alice randomly selects a hat by flipping two coins. If both are heads,
she chooses hat H. If both are tails, she chooses hat T. If there is
one head and one tail, she chooses hat A. Once that hat is selected,
she draws out two marbles.</p>
<ol style="list-style-type: lower-alpha">
<li><p>If the two marbles are both white, what is the probability that the hat
was hat A?</p></li>
<li><p>If there is one red marble and one yellow marble, what is the probability
that the hat was hat A?</p></li>
<li><p>If the two marbles are the same color, what is the probability that the
hat was hat A?</p></li>
</ol></li>
</ol>
</div>
<div id="footnotes-3" class="section level2">
<h2><span class="header-section-number">5.6</span> Footnotes</h2>

</div>
</div>



<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>There are other ways to do this, but <code>expand.grid()</code> will work
when we have more than one parameter, so we’ll start using it already
in the simpler case of a single parameter.<a href="bayes-rule-and-the-grid-method.html#fnref5" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probability.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Redoing.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
