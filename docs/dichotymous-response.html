<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>21 Dichotymous Response | (Re)Doing Bayesain Data Analysis</title>
  <meta name="description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="21 Dichotymous Response | (Re)Doing Bayesain Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="21 Dichotymous Response | (Re)Doing Bayesain Data Analysis" />
  
  <meta name="twitter:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

<meta name="author" content="R Pruim">


<meta name="date" content="2019-05-05">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="multiple-nominal-predictors.html">
<link rel="next" href="nominal-response.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">(Re)Doing Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What’s in These Notes</a></li>
<li class="part"><span><b>I The Basics: Models, Probability, Bayes, and R</b></span></li>
<li class="chapter" data-level="2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.1</b> The Steps of Bayesian Data Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-code"><i class="fa fa-check"></i><b>2.1.1</b> R code</a></li>
<li class="chapter" data-level="2.1.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-packages"><i class="fa fa-check"></i><b>2.1.2</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-1-which-coin-is-it"><i class="fa fa-check"></i><b>2.2</b> Example 1: Which coin is it?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#freedom-of-choice"><i class="fa fa-check"></i><b>2.2.1</b> Freedom of choice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#distributions"><i class="fa fa-check"></i><b>2.3</b> Distributions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#beta-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Beta distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#normal-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-2-height-vs-weight"><i class="fa fa-check"></i><b>2.4</b> Example 2: Height vs Weight</a><ul>
<li class="chapter" data-level="2.4.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#data"><i class="fa fa-check"></i><b>2.4.1</b> Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#describing-a-model-for-the-relationship-between-height-and-weight"><i class="fa fa-check"></i><b>2.4.2</b> Describing a model for the relationship between height and weight</a></li>
<li class="chapter" data-level="2.4.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#prior"><i class="fa fa-check"></i><b>2.4.3</b> Prior</a></li>
<li class="chapter" data-level="2.4.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior"><i class="fa fa-check"></i><b>2.4.4</b> Posterior</a></li>
<li class="chapter" data-level="2.4.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior-predictive-check"><i class="fa fa-check"></i><b>2.4.5</b> Posterior Predictive Check</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#where-do-we-go-from-here"><i class="fa fa-check"></i><b>2.5</b> Where do we go from here?</a></li>
<li class="chapter" data-level="2.6" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#ch02-exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
<li class="chapter" data-level="2.7" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#footnotes"><i class="fa fa-check"></i><b>2.7</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html"><i class="fa fa-check"></i><b>3</b> Some Useful Bits of R</a><ul>
<li class="chapter" data-level="3.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#style-guide"><i class="fa fa-check"></i><b>3.1</b> You Gotta Have Style</a><ul>
<li class="chapter" data-level="3.1.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#an-additional-note-about-homework"><i class="fa fa-check"></i><b>3.1.1</b> An additional note about homework</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors-lists-and-data-frames"><i class="fa fa-check"></i><b>3.2</b> Vectors, Lists, and Data Frames</a><ul>
<li class="chapter" data-level="3.2.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#lists"><i class="fa fa-check"></i><b>3.2.2</b> Lists</a></li>
<li class="chapter" data-level="3.2.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#data-frames-for-rectangular-data"><i class="fa fa-check"></i><b>3.2.3</b> Data frames for rectangular data</a></li>
<li class="chapter" data-level="3.2.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#other-types-of-data"><i class="fa fa-check"></i><b>3.2.4</b> Other types of data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#plotting-with-ggformula"><i class="fa fa-check"></i><b>3.3</b> Plotting with ggformula</a></li>
<li class="chapter" data-level="3.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#creating-data-with-expand.grid"><i class="fa fa-check"></i><b>3.4</b> Creating data with expand.grid()</a></li>
<li class="chapter" data-level="3.5" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#transforming-and-summarizing-data-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.5</b> Transforming and summarizing data dplyr and tidyr</a></li>
<li class="chapter" data-level="3.6" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#writing-functions"><i class="fa fa-check"></i><b>3.6</b> Writing Functions</a><ul>
<li class="chapter" data-level="3.6.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#why-write-functions"><i class="fa fa-check"></i><b>3.6.1</b> Why write functions?</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#function-parts"><i class="fa fa-check"></i><b>3.6.2</b> Function parts</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#the-function-function-has-its-function"><i class="fa fa-check"></i><b>3.6.3</b> The function() function has its function</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#some-common-error-messages"><i class="fa fa-check"></i><b>3.7</b> Some common error messages</a><ul>
<li class="chapter" data-level="3.7.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#object-not-found"><i class="fa fa-check"></i><b>3.7.1</b> object not found</a></li>
<li class="chapter" data-level="3.7.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#any-message-mentioning-yaml"><i class="fa fa-check"></i><b>3.7.2</b> Any message mentioning yaml</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#ch03-exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#footnotes-1"><i class="fa fa-check"></i><b>3.9</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a><ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#some-terminology"><i class="fa fa-check"></i><b>4.1</b> Some terminology</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#distributions-in-r"><i class="fa fa-check"></i><b>4.2</b> Distributions in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#example-normal-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Example: Normal distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability.html"><a href="probability.html#simulating-running-proportions"><i class="fa fa-check"></i><b>4.2.2</b> Simulating running proportions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#joint-marginal-and-conditional-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint, marginal, and conditional distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability.html"><a href="probability.html#example-hair-and-eye-color"><i class="fa fa-check"></i><b>4.3.1</b> Example: Hair and eye color</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability.html"><a href="probability.html#independence"><i class="fa fa-check"></i><b>4.3.2</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#ch04-exercises"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#footnotes-2"><i class="fa fa-check"></i><b>4.5</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule and the Grid Method</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#the-big-bayesian-idea"><i class="fa fa-check"></i><b>5.1</b> The Big Bayesian Idea</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#likelihood"><i class="fa fa-check"></i><b>5.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="5.1.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#when-bayes-is-easy"><i class="fa fa-check"></i><b>5.1.2</b> When Bayes is easy</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#estimating-the-bias-in-a-coin-using-the-grid-method"><i class="fa fa-check"></i><b>5.2</b> Estimating the bias in a coin using the Grid Method</a><ul>
<li class="chapter" data-level="5.2.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#creating-a-grid"><i class="fa fa-check"></i><b>5.2.1</b> Creating a Grid</a></li>
<li class="chapter" data-level="5.2.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#hdi-from-the-grid"><i class="fa fa-check"></i><b>5.2.2</b> HDI from the grid</a></li>
<li class="chapter" data-level="5.2.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#automating-the-grid"><i class="fa fa-check"></i><b>5.2.3</b> Automating the grid</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#working-on-the-log-scale"><i class="fa fa-check"></i><b>5.3</b> Working on the log scale</a></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#discrete-params"><i class="fa fa-check"></i><b>5.4</b> Discrete Parameters</a></li>
<li class="chapter" data-level="5.5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#ch05-exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
<li class="chapter" data-level="5.6" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#footnotes-3"><i class="fa fa-check"></i><b>5.6</b> Footnotes</a></li>
</ul></li>
<li class="part"><span><b>II Inferring a Binomial Probability</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-distributions-1"><i class="fa fa-check"></i><b>6.1</b> Beta distributions</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-and-bayes"><i class="fa fa-check"></i><b>6.2</b> Beta and Bayes</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-bernoulli-likelihood-function"><i class="fa fa-check"></i><b>6.2.1</b> The Bernoulli likelihood function</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-convenient-prior"><i class="fa fa-check"></i><b>6.2.2</b> A convenient prior</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#pros-and-cons-of-conjugate-priors"><i class="fa fa-check"></i><b>6.2.3</b> Pros and Cons of conjugate priors</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#getting-to-know-the-beta-distributions"><i class="fa fa-check"></i><b>6.3</b> Getting to know the Beta distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#important-facts"><i class="fa fa-check"></i><b>6.3.1</b> Important facts</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#alternative-parameterizations-of-beta-distributions"><i class="fa fa-check"></i><b>6.3.2</b> Alternative parameterizations of Beta distributions</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta_params"><i class="fa fa-check"></i><b>6.3.3</b> beta_params()</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#automating-bayesian-updates-for-a-proportion-beta-prior"><i class="fa fa-check"></i><b>6.3.4</b> Automating Bayesian updates for a proportion (beta prior)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#what-if-the-prior-isnt-a-beta-distribution"><i class="fa fa-check"></i><b>6.4</b> What if the prior isn’t a beta distribution?</a></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#ch06-exercises"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo (MCMC)</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#king-markov-and-adviser-metropolis"><i class="fa fa-check"></i><b>7.1</b> King Markov and Adviser Metropolis</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#quick-intro-to-markov-chains"><i class="fa fa-check"></i><b>7.2</b> Quick Intro to Markov Chains</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#more-info-please"><i class="fa fa-check"></i><b>7.2.1</b> More info, please</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#definition"><i class="fa fa-check"></i><b>7.2.2</b> Definition</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#time-homogeneous-markov-chains"><i class="fa fa-check"></i><b>7.2.3</b> Time-Homogeneous Markov Chains</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#matrix-representation"><i class="fa fa-check"></i><b>7.2.4</b> Matrix representation</a></li>
<li class="chapter" data-level="7.2.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#regular-markov-chains"><i class="fa fa-check"></i><b>7.2.5</b> Regular Markov Chains</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#back-to-king-markov"><i class="fa fa-check"></i><b>7.3</b> Back to King Markov</a></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#how-well-does-the-metropolis-algorithm-work"><i class="fa fa-check"></i><b>7.4</b> How well does the Metropolis Algorithm work?</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-to-any-island"><i class="fa fa-check"></i><b>7.4.1</b> Jumping to any island</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-only-to-neighbor-islands"><i class="fa fa-check"></i><b>7.4.2</b> Jumping only to neighbor islands</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#markov-chains-and-posterior-sampling"><i class="fa fa-check"></i><b>7.5</b> Markov Chains and Posterior Sampling</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-1-estimating-a-proportion"><i class="fa fa-check"></i><b>7.5.1</b> Example 1: Estimating a proportion</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-2-estimating-mean-and-variance"><i class="fa fa-check"></i><b>7.5.2</b> Example 2: Estimating mean and variance</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#issues-with-metropolis-algorithm"><i class="fa fa-check"></i><b>7.5.3</b> Issues with Metropolis Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#two-coins"><i class="fa fa-check"></i><b>7.6</b> Two coins</a><ul>
<li class="chapter" data-level="7.6.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#the-model"><i class="fa fa-check"></i><b>7.6.1</b> The model</a></li>
<li class="chapter" data-level="7.6.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#exact-analysis"><i class="fa fa-check"></i><b>7.6.2</b> Exact analysis</a></li>
<li class="chapter" data-level="7.6.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#metropolis"><i class="fa fa-check"></i><b>7.6.3</b> Metropolis</a></li>
<li class="chapter" data-level="7.6.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#gibbs-sampling"><i class="fa fa-check"></i><b>7.6.4</b> Gibbs sampling</a></li>
<li class="chapter" data-level="7.6.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#advantages-and-disadvantages-of-gibbs-vs-metropolis"><i class="fa fa-check"></i><b>7.6.5</b> Advantages and Disadvantages of Gibbs vs Metropolis</a></li>
<li class="chapter" data-level="7.6.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#so-what-do-we-learn-about-the-coins"><i class="fa fa-check"></i><b>7.6.6</b> So what do we learn about the coins?</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-posterior-sampling-big-picture"><i class="fa fa-check"></i><b>7.7</b> MCMC posterior sampling: Big picture</a><ul>
<li class="chapter" data-level="7.7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-markov-chain-monte-carlo"><i class="fa fa-check"></i><b>7.7.1</b> MCMC = Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="7.7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#posterior-sampling-random-walk-through-the-posterior"><i class="fa fa-check"></i><b>7.7.2</b> Posterior sampling: Random walk through the posterior</a></li>
<li class="chapter" data-level="7.7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#where-do-we-go-from-here-1"><i class="fa fa-check"></i><b>7.7.3</b> Where do we go from here?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#ch07-exercises"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html"><i class="fa fa-check"></i><b>8</b> JAGS – Just Another Gibbs Sampler</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#what-jags-is"><i class="fa fa-check"></i><b>8.1</b> What JAGS is</a><ul>
<li class="chapter" data-level="8.1.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#jags-documentation"><i class="fa fa-check"></i><b>8.1.1</b> JAGS documentation</a></li>
<li class="chapter" data-level="8.1.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#updating-c-and-clang"><i class="fa fa-check"></i><b>8.1.2</b> Updating C and CLANG</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-1-estimating-a-proportion-1"><i class="fa fa-check"></i><b>8.2</b> Example 1: estimating a proportion</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-1"><i class="fa fa-check"></i><b>8.2.1</b> The Model</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#load-data"><i class="fa fa-check"></i><b>8.2.2</b> Load Data</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#specify-the-model"><i class="fa fa-check"></i><b>8.2.3</b> Specify the model</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#run-the-model"><i class="fa fa-check"></i><b>8.2.4</b> Run the model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#extracting-information-from-a-jags-run"><i class="fa fa-check"></i><b>8.3</b> Extracting information from a JAGS run</a><ul>
<li class="chapter" data-level="8.3.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#posterior-1"><i class="fa fa-check"></i><b>8.3.1</b> posterior()</a></li>
<li class="chapter" data-level="8.3.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#side-note-posterior-sampling-and-the-grid-method"><i class="fa fa-check"></i><b>8.3.2</b> Side note: posterior sampling and the grid method</a></li>
<li class="chapter" data-level="8.3.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-coda"><i class="fa fa-check"></i><b>8.3.3</b> Using coda</a></li>
<li class="chapter" data-level="8.3.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-bayesplot"><i class="fa fa-check"></i><b>8.3.4</b> Using bayesplot</a></li>
<li class="chapter" data-level="8.3.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-kruschkes-functions"><i class="fa fa-check"></i><b>8.3.5</b> Using Kruschke’s functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#optional-arguments-to-jags"><i class="fa fa-check"></i><b>8.4</b> Optional arguments to jags()</a><ul>
<li class="chapter" data-level="8.4.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#number-and-size-of-chains"><i class="fa fa-check"></i><b>8.4.1</b> Number and size of chains</a></li>
<li class="chapter" data-level="8.4.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#starting-point-for-chains"><i class="fa fa-check"></i><b>8.4.2</b> Starting point for chains</a></li>
<li class="chapter" data-level="8.4.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#running-chains-in-parallel"><i class="fa fa-check"></i><b>8.4.3</b> Running chains in parallel</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-2-comparing-two-proportions"><i class="fa fa-check"></i><b>8.5</b> Example 2: comparing two proportions</a><ul>
<li class="chapter" data-level="8.5.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-data"><i class="fa fa-check"></i><b>8.5.1</b> The data</a></li>
<li class="chapter" data-level="8.5.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-2"><i class="fa fa-check"></i><b>8.5.2</b> The model</a></li>
<li class="chapter" data-level="8.5.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#describing-the-model-to-jags"><i class="fa fa-check"></i><b>8.5.3</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="8.5.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#fitting-the-model"><i class="fa fa-check"></i><b>8.5.4</b> Fitting the model</a></li>
<li class="chapter" data-level="8.5.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#inspecting-the-results"><i class="fa fa-check"></i><b>8.5.5</b> Inspecting the results</a></li>
<li class="chapter" data-level="8.5.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#difference-in-proportions"><i class="fa fa-check"></i><b>8.5.6</b> Difference in proportions</a></li>
<li class="chapter" data-level="8.5.7" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#sampling-from-the-prior"><i class="fa fa-check"></i><b>8.5.7</b> Sampling from the prior</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#ch08-exercises"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="heierarchical-models.html"><a href="heierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Heierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#gamma-distributions"><i class="fa fa-check"></i><b>9.1</b> Gamma Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#one-coin-from-one-mint"><i class="fa fa-check"></i><b>9.2</b> One coin from one mint</a></li>
<li class="chapter" data-level="9.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-one-mint"><i class="fa fa-check"></i><b>9.3</b> Multiple coins from one mint</a></li>
<li class="chapter" data-level="9.4" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-multiple-mints"><i class="fa fa-check"></i><b>9.4</b> Multiple coins from multiple mints</a></li>
<li class="chapter" data-level="9.5" data-path="heierarchical-models.html"><a href="heierarchical-models.html#therapeutic-touch"><i class="fa fa-check"></i><b>9.5</b> Therapeutic Touch</a><ul>
<li class="chapter" data-level="9.5.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#abstract"><i class="fa fa-check"></i><b>9.5.1</b> Abstract</a></li>
<li class="chapter" data-level="9.5.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#data-1"><i class="fa fa-check"></i><b>9.5.2</b> Data</a></li>
<li class="chapter" data-level="9.5.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#a-heierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> A heierarchical model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="heierarchical-models.html"><a href="heierarchical-models.html#other-parameterizations-we-might-have-tried"><i class="fa fa-check"></i><b>9.6</b> Other parameterizations we might have tried</a><ul>
<li class="chapter" data-level="9.6.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shape-parameters-for-beta"><i class="fa fa-check"></i><b>9.6.1</b> Shape parameters for Beta</a></li>
<li class="chapter" data-level="9.6.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#mean-instead-of-mode"><i class="fa fa-check"></i><b>9.6.2</b> Mean instead of mode</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shrinkage"><i class="fa fa-check"></i><b>9.7</b> Shrinkage</a></li>
<li class="chapter" data-level="9.8" data-path="heierarchical-models.html"><a href="heierarchical-models.html#example-baseball-batting-average"><i class="fa fa-check"></i><b>9.8</b> Example: Baseball Batting Average</a></li>
<li class="chapter" data-level="9.9" data-path="heierarchical-models.html"><a href="heierarchical-models.html#ch09-exercises"><i class="fa fa-check"></i><b>9.9</b> Exerciess</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> (Model Comparison)</a></li>
<li class="chapter" data-level="11" data-path="nhst.html"><a href="nhst.html"><i class="fa fa-check"></i><b>11</b> (NHST)</a></li>
<li class="chapter" data-level="12" data-path="point-null-hypotheses.html"><a href="point-null-hypotheses.html"><i class="fa fa-check"></i><b>12</b> (Point Null Hypotheses)</a></li>
<li class="chapter" data-level="13" data-path="goals-power-sample-size.html"><a href="goals-power-sample-size.html"><i class="fa fa-check"></i><b>13</b> (Goals, Power, Sample Size)</a></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#why-stan-might-work-better"><i class="fa fa-check"></i><b>14.1</b> Why Stan might work better</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#describing-a-model-to-stan"><i class="fa fa-check"></i><b>14.2</b> Describing a model to Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#samping-from-the-prior"><i class="fa fa-check"></i><b>14.3</b> Samping from the prior</a></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#ch14-exercises"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glm-overview.html"><a href="glm-overview.html"><i class="fa fa-check"></i><b>15</b> GLM Overview</a><ul>
<li class="chapter" data-level="15.1" data-path="glm-overview.html"><a href="glm-overview.html#data-consists-of-observations-of-variables"><i class="fa fa-check"></i><b>15.1</b> Data consists of observations of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="glm-overview.html"><a href="glm-overview.html#variable-roles"><i class="fa fa-check"></i><b>15.1.1</b> Variable Roles</a></li>
<li class="chapter" data-level="15.1.2" data-path="glm-overview.html"><a href="glm-overview.html#types-of-variables"><i class="fa fa-check"></i><b>15.1.2</b> Types of Variables</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="glm-overview.html"><a href="glm-overview.html#glm-framework"><i class="fa fa-check"></i><b>15.2</b> GLM Framework</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html"><i class="fa fa-check"></i><b>16</b> Estimating One and Two Means</a><ul>
<li class="chapter" data-level="16.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#basic-model-for-two-means"><i class="fa fa-check"></i><b>16.1</b> Basic Model for Two Means</a><ul>
<li class="chapter" data-level="16.1.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-2"><i class="fa fa-check"></i><b>16.1.1</b> Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model"><i class="fa fa-check"></i><b>16.1.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#an-old-sleep-study"><i class="fa fa-check"></i><b>16.2</b> An Old Sleep Study</a><ul>
<li class="chapter" data-level="16.2.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-3"><i class="fa fa-check"></i><b>16.2.1</b> Data</a></li>
<li class="chapter" data-level="16.2.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model-1"><i class="fa fa-check"></i><b>16.2.2</b> Model</a></li>
<li class="chapter" data-level="16.2.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#separate-standard-deviations-for-each-group"><i class="fa fa-check"></i><b>16.2.3</b> Separate standard deviations for each group</a></li>
<li class="chapter" data-level="16.2.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#comparison-to-t-test"><i class="fa fa-check"></i><b>16.2.4</b> Comparison to t-test</a></li>
<li class="chapter" data-level="16.2.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#rope-region-of-practical-equivalence"><i class="fa fa-check"></i><b>16.2.5</b> ROPE (Region of Practical Equivalence)</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#variations-on-the-theme"><i class="fa fa-check"></i><b>16.3</b> Variations on the theme</a><ul>
<li class="chapter" data-level="16.3.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-distributions-for-the-response"><i class="fa fa-check"></i><b>16.3.1</b> Other distributions for the response</a></li>
<li class="chapter" data-level="16.3.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-priors-for-sigma-or-tau"><i class="fa fa-check"></i><b>16.3.2</b> Other Priors for <span class="math inline">\(\sigma\)</span> (or <span class="math inline">\(\tau\)</span>)</a></li>
<li class="chapter" data-level="16.3.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#paired-comparisons"><i class="fa fa-check"></i><b>16.3.3</b> Paired Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#how-many-chains-how-long"><i class="fa fa-check"></i><b>16.4</b> How many chains? How long?</a><ul>
<li class="chapter" data-level="16.4.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#why-multiple-chains"><i class="fa fa-check"></i><b>16.4.1</b> Why multiple chains?</a></li>
<li class="chapter" data-level="16.4.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#what-large-n.eff-does-and-doesnt-do-for-us"><i class="fa fa-check"></i><b>16.4.2</b> What large n.eff does and doesn’t do for us</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#looking-at-likelihood"><i class="fa fa-check"></i><b>16.5</b> Looking at Likelihood</a></li>
<li class="chapter" data-level="16.6" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#ch16-exercises"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>17</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="17.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-deluxe-basic-model"><i class="fa fa-check"></i><b>17.1</b> The deluxe basic model</a><ul>
<li class="chapter" data-level="17.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#likelihood-1"><i class="fa fa-check"></i><b>17.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="17.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#priors"><i class="fa fa-check"></i><b>17.1.2</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#example-galtons-data"><i class="fa fa-check"></i><b>17.2</b> Example: Galton’s Data</a><ul>
<li class="chapter" data-level="17.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#describing-the-model-to-jags-1"><i class="fa fa-check"></i><b>17.2.1</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="17.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#problems-and-how-to-fix-them"><i class="fa fa-check"></i><b>17.2.2</b> Problems and how to fix them</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#centering-and-standardizing"><i class="fa fa-check"></i><b>17.3</b> Centering and Standardizing</a><ul>
<li class="chapter" data-level="17.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#beta_0-and-beta_1-are-still-correlated"><i class="fa fa-check"></i><b>17.3.1</b> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are still correlated</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#weve-fit-a-model-now-what"><i class="fa fa-check"></i><b>17.4</b> We’ve fit a model, now what?</a><ul>
<li class="chapter" data-level="17.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#estimate-parameters"><i class="fa fa-check"></i><b>17.4.1</b> Estimate parameters</a></li>
<li class="chapter" data-level="17.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#make-predictions"><i class="fa fa-check"></i><b>17.4.2</b> Make predictions</a></li>
<li class="chapter" data-level="17.4.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#posterior-predictive-checks"><i class="fa fa-check"></i><b>17.4.3</b> Posterior Predictive Checks</a></li>
<li class="chapter" data-level="17.4.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#posterior-predictive-checks-with-bayesplot"><i class="fa fa-check"></i><b>17.4.4</b> Posterior predictive checks with bayesplot</a></li>
<li class="chapter" data-level="17.4.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#ppc-with-custom-data"><i class="fa fa-check"></i><b>17.4.5</b> PPC with custom data</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#fitting-models-with-stan"><i class="fa fa-check"></i><b>17.5</b> Fitting models with Stan</a></li>
<li class="chapter" data-level="17.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#two-intercepts-model"><i class="fa fa-check"></i><b>17.6</b> Two Intercepts model</a></li>
<li class="chapter" data-level="17.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#ch17-exercises"><i class="fa fa-check"></i><b>17.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat"><i class="fa fa-check"></i><b>18.1</b> SAT</a><ul>
<li class="chapter" data-level="18.1.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-vs-expenditure"><i class="fa fa-check"></i><b>18.1.1</b> SAT vs expenditure</a></li>
<li class="chapter" data-level="18.1.2" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-vs-expenditure-and-percent-taking-the-test"><i class="fa fa-check"></i><b>18.1.2</b> SAT vs expenditure and percent taking the test</a></li>
<li class="chapter" data-level="18.1.3" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#whats-wrong-with-this-picture"><i class="fa fa-check"></i><b>18.1.3</b> What’s wrong with this picture?</a></li>
<li class="chapter" data-level="18.1.4" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#multiple-predictors-in-pictures"><i class="fa fa-check"></i><b>18.1.4</b> Multiple predictors in pictures</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#interaction"><i class="fa fa-check"></i><b>18.2</b> Interaction</a><ul>
<li class="chapter" data-level="18.2.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#sat-with-interaction-term"><i class="fa fa-check"></i><b>18.2.1</b> SAT with interaction term</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#fitting-a-linear-model-with-brms"><i class="fa fa-check"></i><b>18.3</b> Fitting a linear model with brms</a><ul>
<li class="chapter" data-level="18.3.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#adjusting-the-model-with-brm"><i class="fa fa-check"></i><b>18.3.1</b> Adjusting the model with brm()</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#interpretting-a-model-with-an-interaction-term"><i class="fa fa-check"></i><b>18.4</b> Interpretting a model with an interaction term</a><ul>
<li class="chapter" data-level="18.4.1" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#thinking-about-the-noise"><i class="fa fa-check"></i><b>18.4.1</b> Thinking about the noise</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="multiple-metric-predictors.html"><a href="multiple-metric-predictors.html#ch18-exercises"><i class="fa fa-check"></i><b>18.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="nominal-predictors.html"><a href="nominal-predictors.html"><i class="fa fa-check"></i><b>19</b> Nominal Predictors</a><ul>
<li class="chapter" data-level="19.1" data-path="nominal-predictors.html"><a href="nominal-predictors.html#fruit-flies-study"><i class="fa fa-check"></i><b>19.1</b> Fruit flies Study</a></li>
<li class="chapter" data-level="19.2" data-path="nominal-predictors.html"><a href="nominal-predictors.html#model-1-out-of-the-box"><i class="fa fa-check"></i><b>19.2</b> Model 1: Out-of-the-box</a></li>
<li class="chapter" data-level="19.3" data-path="nominal-predictors.html"><a href="nominal-predictors.html#model-2-custom-priors"><i class="fa fa-check"></i><b>19.3</b> Model 2: Custom Priors</a></li>
<li class="chapter" data-level="19.4" data-path="nominal-predictors.html"><a href="nominal-predictors.html#models-3-and-4-alternate-parameterizations"><i class="fa fa-check"></i><b>19.4</b> Models 3 and 4: alternate parameterizations</a></li>
<li class="chapter" data-level="19.5" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-groups"><i class="fa fa-check"></i><b>19.5</b> Comparing groups</a><ul>
<li class="chapter" data-level="19.5.1" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-to-the-intercept-group"><i class="fa fa-check"></i><b>19.5.1</b> Comparing to the “intercept group”</a></li>
<li class="chapter" data-level="19.5.2" data-path="nominal-predictors.html"><a href="nominal-predictors.html#comparing-others-pairs-of-groups"><i class="fa fa-check"></i><b>19.5.2</b> Comparing others pairs of groups</a></li>
<li class="chapter" data-level="19.5.3" data-path="nominal-predictors.html"><a href="nominal-predictors.html#contrasts-comparing-groups-of-groups"><i class="fa fa-check"></i><b>19.5.3</b> Contrasts: Comparing “groups of groups”</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="nominal-predictors.html"><a href="nominal-predictors.html#more-variations"><i class="fa fa-check"></i><b>19.6</b> More Variations</a></li>
<li class="chapter" data-level="19.7" data-path="nominal-predictors.html"><a href="nominal-predictors.html#ch19-exercises"><i class="fa fa-check"></i><b>19.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#crop-yield-by-till-method-and-fertilizer"><i class="fa fa-check"></i><b>20.1</b> Crop Yield by Till Method and Fertilizer</a><ul>
<li class="chapter" data-level="20.1.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#what-does-sigma-represent"><i class="fa fa-check"></i><b>20.1.1</b> What does <span class="math inline">\(\sigma\)</span> represent?</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#split-plot-design"><i class="fa fa-check"></i><b>20.2</b> Split Plot Design</a></li>
<li class="chapter" data-level="20.3" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#which-model-should-we-use"><i class="fa fa-check"></i><b>20.3</b> Which model should we use?</a><ul>
<li class="chapter" data-level="20.3.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#modeling-choices"><i class="fa fa-check"></i><b>20.3.1</b> Modeling Choices</a></li>
<li class="chapter" data-level="20.3.2" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#measuring-a-model-prediction-error"><i class="fa fa-check"></i><b>20.3.2</b> Measuring a Model – Prediction Error</a></li>
<li class="chapter" data-level="20.3.3" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#out-of-sample-prediction-error"><i class="fa fa-check"></i><b>20.3.3</b> Out-of-sample prediction error</a></li>
<li class="chapter" data-level="20.3.4" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#approximating-out-of-sample-prediction-error"><i class="fa fa-check"></i><b>20.3.4</b> Approximating out-of-sample prediction error</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#using-loo"><i class="fa fa-check"></i><b>20.4</b> Using loo</a></li>
<li class="chapter" data-level="20.5" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#overfitting-example"><i class="fa fa-check"></i><b>20.5</b> Overfitting Example</a><ul>
<li class="chapter" data-level="20.5.1" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#brains-data"><i class="fa fa-check"></i><b>20.5.1</b> Brains Data</a></li>
<li class="chapter" data-level="20.5.2" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#measuring-fit-with-r2"><i class="fa fa-check"></i><b>20.5.2</b> Measuring fit with <span class="math inline">\(r^2\)</span></a></li>
<li class="chapter" data-level="20.5.3" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#leave-one-out-analysis"><i class="fa fa-check"></i><b>20.5.3</b> Leave One Out Analysis</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="multiple-nominal-predictors.html"><a href="multiple-nominal-predictors.html#ch20-exercses"><i class="fa fa-check"></i><b>20.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotymous-response.html"><a href="dichotymous-response.html"><i class="fa fa-check"></i><b>21</b> Dichotymous Response</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotymous-response.html"><a href="dichotymous-response.html#what-model"><i class="fa fa-check"></i><b>21.1</b> What Model?</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotymous-response.html"><a href="dichotymous-response.html#a-method-with-issues-linear-regression"><i class="fa fa-check"></i><b>21.1.1</b> A method with issues: Linear regression</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotymous-response.html"><a href="dichotymous-response.html#the-usual-approach-logistic-regression"><i class="fa fa-check"></i><b>21.1.2</b> The usual approach: Logistic regression</a></li>
<li class="chapter" data-level="21.1.3" data-path="dichotymous-response.html"><a href="dichotymous-response.html#other-approaches"><i class="fa fa-check"></i><b>21.1.3</b> Other approaches</a></li>
<li class="chapter" data-level="21.1.4" data-path="dichotymous-response.html"><a href="dichotymous-response.html#preparing-the-data"><i class="fa fa-check"></i><b>21.1.4</b> Preparing the data</a></li>
<li class="chapter" data-level="21.1.5" data-path="dichotymous-response.html"><a href="dichotymous-response.html#specifying-family-and-link-function-in-brm"><i class="fa fa-check"></i><b>21.1.5</b> Specifying family and link function in brm()</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotymous-response.html"><a href="dichotymous-response.html#interpretting-logistic-regression-models"><i class="fa fa-check"></i><b>21.2</b> Interpretting Logistic Regression Models</a></li>
<li class="chapter" data-level="21.3" data-path="dichotymous-response.html"><a href="dichotymous-response.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-response.html"><a href="nominal-response.html"><i class="fa fa-check"></i><b>22</b> Nominal Response</a></li>
<li class="chapter" data-level="23" data-path="ordinal-response.html"><a href="ordinal-response.html"><i class="fa fa-check"></i><b>23</b> Ordinal Response</a></li>
<li class="chapter" data-level="24" data-path="count-response.html"><a href="count-response.html"><i class="fa fa-check"></i><b>24</b> Count Response</a><ul>
<li class="chapter" data-level="24.1" data-path="count-response.html"><a href="count-response.html#hair-and-eye-color-data"><i class="fa fa-check"></i><b>24.1</b> Hair and eye color data</a></li>
<li class="chapter" data-level="24.2" data-path="count-response.html"><a href="count-response.html#are-hair-and-eye-color-independent"><i class="fa fa-check"></i><b>24.2</b> Are hair and eye color independent?</a></li>
<li class="chapter" data-level="24.3" data-path="count-response.html"><a href="count-response.html#poisson-model"><i class="fa fa-check"></i><b>24.3</b> Poisson model</a></li>
<li class="chapter" data-level="24.4" data-path="count-response.html"><a href="count-response.html#exercises"><i class="fa fa-check"></i><b>24.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="this-and-that.html"><a href="this-and-that.html"><i class="fa fa-check"></i><b>25</b> This and That</a><ul>
<li class="chapter" data-level="25.1" data-path="this-and-that.html"><a href="this-and-that.html#wells-in-bangledesh"><i class="fa fa-check"></i><b>25.1</b> Wells in Bangledesh</a><ul>
<li class="chapter" data-level="25.1.1" data-path="this-and-that.html"><a href="this-and-that.html#the-data-1"><i class="fa fa-check"></i><b>25.1.1</b> The data</a></li>
<li class="chapter" data-level="25.1.2" data-path="this-and-that.html"><a href="this-and-that.html#the-question"><i class="fa fa-check"></i><b>25.1.2</b> The Question</a></li>
<li class="chapter" data-level="25.1.3" data-path="this-and-that.html"><a href="this-and-that.html#distance-as-a-predictor"><i class="fa fa-check"></i><b>25.1.3</b> Distance as a predictor</a></li>
<li class="chapter" data-level="25.1.4" data-path="this-and-that.html"><a href="this-and-that.html#updating-a-model-without-recompiling"><i class="fa fa-check"></i><b>25.1.4</b> Updating a model without recompiling</a></li>
<li class="chapter" data-level="25.1.5" data-path="this-and-that.html"><a href="this-and-that.html#interpreting-coefficients-discrete-change"><i class="fa fa-check"></i><b>25.1.5</b> Interpreting coefficients – discrete change</a></li>
<li class="chapter" data-level="25.1.6" data-path="this-and-that.html"><a href="this-and-that.html#interpreting-coefficients-the-divide-by-4-trick"><i class="fa fa-check"></i><b>25.1.6</b> Interpreting coefficients – the divide by 4 trick</a></li>
<li class="chapter" data-level="25.1.7" data-path="this-and-that.html"><a href="this-and-that.html#other-predictors-arsenic"><i class="fa fa-check"></i><b>25.1.7</b> Other predictors: arsenic</a></li>
<li class="chapter" data-level="25.1.8" data-path="this-and-that.html"><a href="this-and-that.html#still-more-predictors"><i class="fa fa-check"></i><b>25.1.8</b> Still more predictors</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="this-and-that.html"><a href="this-and-that.html#gelmanhill-principles-for-buiding-models"><i class="fa fa-check"></i><b>25.2</b> Gelman/Hill Principles for Buiding Models</a><ul>
<li class="chapter" data-level="25.2.1" data-path="this-and-that.html"><a href="this-and-that.html#example-bicycling"><i class="fa fa-check"></i><b>25.2.1</b> Example: Bicycling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">(Re)Doing Bayesain Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dichotymous-response" class="section level1">
<h1><span class="header-section-number">21</span> Dichotymous Response</h1>
<div id="what-model" class="section level2">
<h2><span class="header-section-number">21.1</span> What Model?</h2>
<p>Let’s suppose we want to predict a person’s gender from their height and weight.
What sort of model should we use? Give a particular height and weight, a person
might be male or female. So for a given height/weight combination, the
distribution of gender is a <strong>Bernoulli random variable</strong>. Our goal is to
convert the height/weight combination into the <strong>parameter <span class="math inline">\(\theta\)</span></strong> specifying
what proportion of people with that height and weign combination are
male (or female).</p>
<p>So our model looks something like</p>
<p><span class="math display">\[\begin{align*}
Y      &amp;\sim {\sf Bern}(\theta) \\
\theta &amp;= \mathrm{f}(\texttt{height}, \texttt{weight})
\end{align*}\]</span></p>
<p>But what functions should we use for <span class="math inline">\(f\)</span>?</p>
<div id="a-method-with-issues-linear-regression" class="section level3">
<h3><span class="header-section-number">21.1.1</span> A method with issues: Linear regression</h3>
<p>One obvious thing to try is a linear function:</p>
<p><span class="math display">\[\begin{align*}
Y      &amp;\sim {\sf Bern}(\theta) \\
\theta &amp;= \beta_0 + 
          \beta_{\texttt{height}} \texttt{height} + 
          \beta_{\texttt{weight}} \texttt{weight}
\end{align*}\]</span></p>
<p>An interaction term could easily be added as well.
This model is basically converting the dichotymous response into a quantitative
variable (0’s and 1’s) and using the same sort of regression model we have used
for metric variables, but with a different noise distribution.</p>
<p>One problem with this model is that our linear function might well return
values outside the interval <span class="math inline">\([0, 1]\)</span>. This would cause two problems:</p>
<ul>
<li>It is making a prediction we know is incorrect.</li>
<li>The Bernoulli random variable needs a value of <span class="math inline">\(\theta\)</span> between 0 and 1,
so our likelihood function would be broken.</li>
</ul>
<p>This model is still sometimes use (but with normal noise rather than Bernoulli
noise to avoid breaking the likelihood function). But there are better approaches.</p>
</div>
<div id="the-usual-approach-logistic-regression" class="section level3">
<h3><span class="header-section-number">21.1.2</span> The usual approach: Logistic regression</h3>
<p>We would like to use a linear function, but convert its range from
<span class="math inline">\((-\infty, \infty)\)</span> to <span class="math inline">\((0, 1)\)</span>. Alternatively, we can convert the
the range <span class="math inline">\((0,1)\)</span> to <span class="math inline">\((-\infty, \infty)\)</span> and parameterize the Bernoulli distribution
differently.</p>
<p>The most common transformation used the log odds transformation:
<span class="math display">\[
\begin{array}{rcl}
\mathrm{probability} &amp; \theta &amp; (0, 1) \\
\mathrm{odds} &amp; \theta \mapsto \frac{\theta}{1- \theta} &amp; (0, \infty) \\
\mathrm{log\  odds} &amp; \theta \mapsto \log(\frac{\theta}{1- \theta}) &amp; (-\infty, \infty) \\
\end{array}
\]</span></p>
<p>Read backwards, this is the logistic transformation</p>
<span class="math display">\[\begin{array}{rcl}
\mathrm{log\  odds} &amp; x  &amp; (-\infty, \infty) \\
\mathrm{odds} &amp; x \mapsto e^x  &amp; (0, \infty) \\
\mathrm{probability} &amp; x \mapsto \frac{e^x}{1 + e^x} &amp; (0, 1) \\
\end{array}\]</span>
<p>These functions are available via the mosaic packge as <code>logit()</code> and <code>ilogit()</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">logit</code></pre>
<pre><code>## function(x)
## {
##   log(x/(1 - x))
## }
## &lt;bytecode: 0x7f927d1bcca8&gt;
## &lt;environment: namespace:mosaicCore&gt;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">ilogit</code></pre>
<pre><code>## function (x)
## {
##   exp(x)/(1 + exp(x))
## }
## &lt;bytecode: 0x7f927d94b8d8&gt;
## &lt;environment: namespace:mosaicCore&gt;</code></pre>
<p>The inverse logit function is also called the <strong>logistic function</strong> and
the logistic regression model is</p>
<p><span class="math display">\[\begin{align*}
Y      &amp;\sim {\sf Bern}(\theta) \\
\theta &amp;= \mathrm{logistic}(\beta_0 + 
          \beta_{\texttt{height}} \texttt{height} + 
          \beta_{\texttt{weight}} \texttt{weight})
          \\
\mathrm{logit}(\theta) &amp;= \beta_0 + 
          \beta_{\texttt{height}} \texttt{height} + 
          \beta_{\texttt{weight}} \texttt{weight}
\end{align*}\]</span></p>
<p>The logit function is called the <strong>link function</strong> and the logistic function
is the <strong>inverse link function</strong>.</p>
</div>
<div id="other-approaches" class="section level3">
<h3><span class="header-section-number">21.1.3</span> Other approaches</h3>
<p>We could do a similar thing with any pair of functions that convert back and forth
between <span class="math inline">\((0,1)\)</span> and <span class="math inline">\((-\infty, \infty)\)</span>. For any random variable, the cdf (cumulative
distribution function) has domain <span class="math inline">\((-\infty, \infty)\)</span> and range <span class="math inline">\((0,1)\)</span>, so</p>
<ul>
<li>Any cdf/inverse cdf pair can be used in place of the logistic tranformation.
<ul>
<li>using <code>pnorm()</code> and <code>qnorm()</code> is called **probit regression*.</li>
</ul></li>
<li>We can also work this backwards and create a random variable that has the
logistic function as its cdf. The random variable is called (wait for it)
the <strong>logistic random variable</strong>.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_function</span>(ilogit, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;logistic&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_function</span>(pnorm, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;probit (standard)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_function</span>(pnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">sd =</span> <span class="fl">1.8</span>), 
              <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;probit (mean = 0, sd = 1.8)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch21-logit-probit-plots-1.png" width="65%" /></p>
</div>
<div id="preparing-the-data" class="section level3">
<h3><span class="header-section-number">21.1.4</span> Preparing the data</h3>
<p>We will use a subset of the <code>NHANES</code> data for this example.
This is a different data set from the example in the book (which uses
synthetic data). Since the data there are in pounds and inches, we’ll convert
the NHANES data to these units.
As in other models, we need to convert our dichotymous variable into 0’s and 1’s.
We certainly want to remove children from the model since height and weight patterns
are different for children and adults. In fact, we’ll just select
out the 22-year-olds.
While we are at it, we’ll get rid of the variables we don’t need and remove
any rows with missing values in those three rows.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(NHANES)
<span class="kw">library</span>(brms)
nhanes &lt;-<span class="st"> </span>
<span class="st">  </span>NHANES <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">weight =</span> Weight <span class="op">*</span><span class="st"> </span><span class="fl">2.2</span>,
    <span class="dt">height =</span> Height <span class="op">/</span><span class="st"> </span><span class="fl">2.54</span>,
    <span class="dt">male =</span> <span class="kw">as.numeric</span>(NHANES<span class="op">$</span>Gender <span class="op">==</span><span class="st"> &quot;male&quot;</span>),
  ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Age <span class="op">==</span><span class="st"> </span><span class="dv">22</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(male, height, weight) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(.))  <span class="co"># remove rows where any of the 3 variables is missing</span></code></pre>
</div>
<div id="specifying-family-and-link-function-in-brm" class="section level3">
<h3><span class="header-section-number">21.1.5</span> Specifying family and link function in brm()</h3>
<p>Compared to our usual linear regression model, we need to make two adjustments:</p>
<ol style="list-style-type: decimal">
<li>Use the Bernoulli family of distriutions for the noise</li>
<li>Use the logit link (logistic inverse link) function to translate back and forth
between the linear part of the model and the distribution.</li>
</ol>
<p>Both are done simultaneously when we set the <code>family</code> argument in <code>brm()</code>. Each
family comes with a default link function, but we can override that if we like.</p>
<p>So for logistic and probit regression, we use</p>
<pre class="sourceCode r"><code class="sourceCode r">logistic_brm &lt;-
<span class="st">  </span><span class="kw">brm</span>(male <span class="op">~</span><span class="st"> </span>height <span class="op">+</span><span class="st"> </span>weight, <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> logit), <span class="dt">data =</span> nhanes)</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">probit_brm &lt;-
<span class="st">  </span><span class="kw">brm</span>(male <span class="op">~</span><span class="st"> </span>height <span class="op">+</span><span class="st"> </span>weight, <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> probit), <span class="dt">data =</span> nhanes)</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<p>The rest of the model behaves as before. In particular, a t-distribution is used
for the intercept and improper uniform distributions are used for the other
regression coefficients. This model doesn’t have a <span class="math inline">\(\sigma\)</span> parameter.
(The variance of a Bernoulli distribution is determined by the probability
parameter.)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prior_summary</span>(logistic_brm)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">prior</th>
<th align="left">class</th>
<th align="left">coef</th>
<th align="left">group</th>
<th align="left">resp</th>
<th align="left">dpar</th>
<th align="left">nlpar</th>
<th align="left">bound</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">b</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">b</td>
<td align="left">height</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">b</td>
<td align="left">weight</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">student_t(3, 0, 10)</td>
<td align="left">Intercept</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="interpretting-logistic-regression-models" class="section level2">
<h2><span class="header-section-number">21.2</span> Interpretting Logistic Regression Models</h2>
<p>Beore getting our model with two predictors, let’s look at a model with
only one predictor.</p>
<pre class="sourceCode r"><code class="sourceCode r">male_by_weight_brm &lt;-
<span class="st">  </span><span class="kw">brm</span>(male <span class="op">~</span><span class="st"> </span>weight, <span class="dt">family =</span> <span class="kw">bernoulli</span>(), <span class="dt">data =</span> nhanes)</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## recompiling to avoid crashing R session</code></pre>
<pre><code>## Start sampling</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">male_by_weight_brm</code></pre>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: male ~ weight 
##    Data: nhanes (Number of observations: 135) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept    -2.12      0.82    -3.78    -0.58       3545 1.00
## weight        0.01      0.00     0.00     0.02       3499 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcmc_combo</span>(<span class="kw">as.mcmc.list</span>(<span class="kw">stanfit</span>(male_by_weight_brm)))</code></pre>
<p><img src="Redoing_files/figure-html/ch21-male-weight-2-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot_post</span>(<span class="kw">posterior</span>(male_by_weight_brm)<span class="op">$</span>b_weight)</code></pre>
<p><img src="Redoing_files/figure-html/ch21-male-weight-2-2.png" width="65%" /></p>
<pre><code>## $posterior
##       ESS    mean  median    mode
## var1 3459 0.01261 0.01246 0.01218
## 
## $hdi
##   prob      lo      hi
## 1 0.95 0.00397 0.02292</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">marginal_effects</span>(male_by_weight_brm) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot</span>(<span class="dt">plot =</span> <span class="ot">FALSE</span>)
p<span class="op">$</span>weight <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_jitter</span>(male <span class="op">~</span><span class="st"> </span>weight, <span class="dt">data =</span> nhanes, <span class="dt">inherit =</span> <span class="ot">FALSE</span>,
            <span class="dt">width =</span> <span class="dv">0</span>, <span class="dt">height =</span> <span class="fl">0.03</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch21-male-weight-2-3.png" width="65%" /></p>
<p>Things we learn from this model:</p>
<ul>
<li><p>There is clearly a upward trend – heavier people are more likely to be male
than lighter people are. This is seen in the posterior distribution for
<span class="math inline">\(\beta_{\mathrm{weight}}\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hdi</span>(<span class="kw">posterior</span>(male_by_weight_brm), <span class="dt">pars =</span> <span class="st">&quot;b_weight&quot;</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">par</th>
<th align="right">lo</th>
<th align="right">hi</th>
<th align="right">mode</th>
<th align="right">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">b_weight</td>
<td align="right">0.004</td>
<td align="right">0.0229</td>
<td align="right">0.0123</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table></li>
<li><p>The rise is gentle, not steep. There is no weight at which we abruptly
believe gender is much more likely to be male above that weight and
female below that weight.</p></li>
<li><p>For a given value of <span class="math inline">\(\theta = \langle \beta_0, \beta_{\mathrm{weight}}\rangle\)</span>
we can compute the weight at which the model believes the gender split is 50/50.
Probability is 0.5 when the odds is 1 and the log odds is 0. And
<span class="math inline">\(\beta_0 + \beta_{\mathrm{weight}} \mathrm{weight} = 0\)</span> when
<span class="math inline">\(\mathrm{weight} = -\beta_0 / \beta_{\mathrm{weight}}\)</span>.
A 95% HDI For this value is quite wide.</p>
<pre class="sourceCode r"><code class="sourceCode r">Post &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">posterior</span>(male_by_weight_brm) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fifty_fifty =</span> <span class="op">-</span><span class="st"> </span>b_Intercept <span class="op">/</span><span class="st"> </span>b_weight)
h &lt;-<span class="st"> </span><span class="kw">hdi</span>(Post, <span class="dt">pars =</span> <span class="st">&quot;fifty_fifty&quot;</span>); h</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">par</th>
<th align="right">lo</th>
<th align="right">hi</th>
<th align="right">mode</th>
<th align="right">prob</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fifty_fifty</td>
<td align="right">126.6</td>
<td align="right">204.3</td>
<td align="right">172.6</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>weight  <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gf_segment</span>(<span class="fl">0.5</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">~</span><span class="st"> </span>lo <span class="op">+</span><span class="st"> </span>hi, <span class="dt">data =</span> h, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">inherit =</span> <span class="ot">FALSE</span>)  </code></pre>
<p><img src="Redoing_files/figure-html/ch21-fifty-fifty-1.png" width="65%" /></p></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">logistic_brm</code></pre>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: male ~ height + weight 
##    Data: nhanes (Number of observations: 135) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Eff.Sample Rhat
## Intercept   -64.73     10.86   -87.60   -45.91       3159 1.00
## height        0.95      0.16     0.67     1.28       3223 1.00
## weight        0.01      0.01    -0.01     0.02       3696 1.00
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<div id="robust-logistic-regression" class="section level2">
<h2><span class="header-section-number">21.3</span> Robust Logistic Regression</h2>
<p>For models with metric response, using t distribuitons instead of
normal distributions made the models more robust (less influenced by
unusually large or small values in the data).</p>
<p>Logistic regression can also
be strongly influenced by unusual observations. In our example, if there
is an unusually heavy woman or an unusually light man, the likelihood will
be very small unless we flatten the logistic curve. But we cannot
simply replace a normal distribution with a t distribution because
our likelihood does not involve a normal distribution.</p>
<!-- Kruschke suggests a different idea for how to make logistic regression  -->
<!-- more robust: using a mixture model. In this model, most of the responses -->
<!-- are modeled by our logistic regression model, but some portion $\alpha$ -->
<!-- is just a 50-50 split of the two outcomes.  In mathematical notation, -->
<!-- $$ -->
<!-- Y \sim \alpha {\sf Bern}(0.5) : (1-\alpha) {\sf Bern}(\theta)  -->
<!-- $$ -->
<!-- All we need to do is add a suitable prior on $\alpha$ and describe this mixture -->
<!-- distribution to Stan via `brm()`. -->
<!-- ```{r ch21-robust, cache = TRUE, results = "hide"} -->
<!-- robust <- -->
<!--   brm(data = my_data,  -->
<!--       family = binomial(link = "identity"), -->
<!--       bf(male ~  -->
<!--            a * .5 + (1 - a) * 1 / (1 + exp(-1 * (b0 + b1 * weight_z))), -->
<!--          a + b0 + b1  ~ 1, -->
<!--          nl = TRUE), -->
<!--       prior = c(prior(normal(0, 2), nlpar = "b0"), -->
<!--                 prior(normal(0, 2), nlpar = "b1"), -->
<!--                 prior(beta(1, 9),   nlpar = "a"))) -->
<!-- ``` -->
<p>Kruschke recommends a methods that fits a mixture of the usual
logistic regression model and a model that is “just guessing” (50-50 chance
of being male or female). That Stan development folks (and others)
recommend a different appraoch: Fit the model with an inverse t cdf.
This is like a probit model, but with more flexibility. In particular,
if the degrees of freedom is small, the inverse t cdf will approach its
assymptotes more slowly than the probit or logistic models do.</p>
<p>Getting <code>brm()</code> to fit this model requires a few extra steps:</p>
<ul>
<li>define the inverse t cdf function using <code>stanvars</code></li>
<li>use an identity link (since we will be coding in the link/inverse link
manually).</li>
<li>turn off linear model evaluation of the main formula with <code>nl = TRUE</code>.
(This can be used for other non-linear model situations as well.)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define inverse robit function (Stan syntax)</span>
stan_inv_robit &lt;-<span class="st"> &quot;</span>
<span class="st">  real inv_robit(real y, real nu) {</span>
<span class="st">    return student_t_cdf(y, nu, 0, (nu - 2) / nu);</span>
<span class="st">  }</span>
<span class="st">&quot;</span>
bform &lt;-<span class="st"> </span><span class="kw">bf</span>(
  male <span class="op">~</span><span class="st"> </span><span class="kw">inv_robit</span>(theta, nu),
  <span class="co"># non-linear -- use algebra as is in *main* formula</span>
  <span class="dt">nl =</span> <span class="ot">TRUE</span>,        
  <span class="co"># theta = theta_Intercept + theta_weight * weight + theta_height * height</span>
  theta <span class="op">~</span><span class="st"> </span>weight <span class="op">+</span><span class="st"> </span>height,  
  nu <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,            <span class="co"># nu = nu_Intercept (ie. just one value of nu)</span>
  <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="st">&quot;identity&quot;</span>)           <span class="co"># identity link function</span>
)

bprior &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">nlpar =</span> <span class="st">&quot;theta&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">prior</span>(<span class="kw">gamma</span>(<span class="dv">2</span>, <span class="fl">0.1</span>), <span class="dt">nlpar =</span> <span class="st">&quot;nu&quot;</span>, <span class="dt">lb =</span> <span class="dv">2</span>) 

robit_brm &lt;-<span class="st"> </span>
<span class="st">  </span><span class="kw">brm</span>(bform, <span class="dt">prior =</span> bprior, <span class="dt">data =</span> nhanes,
      <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dt">scode =</span> stan_inv_robit, <span class="dt">block =</span> <span class="st">&quot;functions&quot;</span>)
  )</code></pre>
<pre><code>## Compiling the C++ model</code></pre>
<pre><code>## Start sampling</code></pre>
<pre><code>## Warning: There were 3 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See
## http://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded</code></pre>
<pre><code>## Warning: Examine the pairs() plot to diagnose sampling problems</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prior_summary</span>(robit_brm)
robit_brm
<span class="kw">loo</span>(robit_brm, <span class="dt">reloo =</span> <span class="ot">TRUE</span>)
<span class="kw">loo</span>(logistic_brm, <span class="dt">reloo =</span> <span class="ot">TRUE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">new_data &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(
  <span class="dt">height =</span> <span class="kw">seq</span>(<span class="dv">60</span>, <span class="dv">75</span>, <span class="dt">by =</span> <span class="dv">3</span>),
  <span class="dt">weight =</span> <span class="kw">seq</span>(<span class="dv">125</span>,<span class="dv">225</span>, <span class="dt">by =</span> <span class="dv">25</span>)
)
<span class="kw">bind_cols</span>(
  new_data,
  <span class="kw">data.frame</span>(<span class="kw">predict</span>(logistic_brm, <span class="dt">newdata =</span> new_data, <span class="dt">transform =</span> ilogit))
)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
<th align="right">Estimate</th>
<th align="right">Est.Error</th>
<th align="right">Q2.5</th>
<th align="right">Q97.5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">60</td>
<td align="right">125</td>
<td align="right">0.5006</td>
<td align="right">0.0121</td>
<td align="right">0.5000</td>
<td align="right">0.5000</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">125</td>
<td align="right">0.5051</td>
<td align="right">0.0341</td>
<td align="right">0.5000</td>
<td align="right">0.5000</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">125</td>
<td align="right">0.5631</td>
<td align="right">0.1030</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">125</td>
<td align="right">0.6947</td>
<td align="right">0.0841</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">125</td>
<td align="right">0.7275</td>
<td align="right">0.0283</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">125</td>
<td align="right">0.7307</td>
<td align="right">0.0097</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">150</td>
<td align="right">0.5006</td>
<td align="right">0.0115</td>
<td align="right">0.5000</td>
<td align="right">0.5000</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">150</td>
<td align="right">0.5069</td>
<td align="right">0.0394</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">150</td>
<td align="right">0.5741</td>
<td align="right">0.1079</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">150</td>
<td align="right">0.7023</td>
<td align="right">0.0763</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">150</td>
<td align="right">0.7284</td>
<td align="right">0.0246</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">150</td>
<td align="right">0.7308</td>
<td align="right">0.0073</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">175</td>
<td align="right">0.5003</td>
<td align="right">0.0082</td>
<td align="right">0.5000</td>
<td align="right">0.5000</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">175</td>
<td align="right">0.5098</td>
<td align="right">0.0466</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">175</td>
<td align="right">0.5835</td>
<td align="right">0.1110</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">175</td>
<td align="right">0.7069</td>
<td align="right">0.0707</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">175</td>
<td align="right">0.7289</td>
<td align="right">0.0221</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">175</td>
<td align="right">0.7309</td>
<td align="right">0.0052</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">200</td>
<td align="right">0.5007</td>
<td align="right">0.0126</td>
<td align="right">0.5000</td>
<td align="right">0.5000</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">200</td>
<td align="right">0.5113</td>
<td align="right">0.0499</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">200</td>
<td align="right">0.5964</td>
<td align="right">0.1139</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">200</td>
<td align="right">0.7119</td>
<td align="right">0.0638</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">200</td>
<td align="right">0.7296</td>
<td align="right">0.0186</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">200</td>
<td align="right">0.7309</td>
<td align="right">0.0052</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">225</td>
<td align="right">0.5014</td>
<td align="right">0.0178</td>
<td align="right">0.5000</td>
<td align="right">0.5000</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">225</td>
<td align="right">0.5136</td>
<td align="right">0.0543</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">225</td>
<td align="right">0.6095</td>
<td align="right">0.1154</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">225</td>
<td align="right">0.7133</td>
<td align="right">0.0615</td>
<td align="right">0.5000</td>
<td align="right">0.7311</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">225</td>
<td align="right">0.7297</td>
<td align="right">0.0175</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">225</td>
<td align="right">0.7310</td>
<td align="right">0.0037</td>
<td align="right">0.7311</td>
<td align="right">0.7311</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">marginal_effects</span>(
  logistic_brm, <span class="dt">effects =</span> <span class="st">&quot;height&quot;</span>,
  <span class="dt">conditions =</span> <span class="kw">data.frame</span>(<span class="dt">weight =</span> <span class="kw">seq</span>(<span class="dv">125</span>, <span class="dv">225</span>, <span class="dt">by =</span> <span class="dv">25</span>)))</code></pre>
<p><img src="Redoing_files/figure-html/ch21-predict-1.png" width="65%" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-nominal-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nominal-response.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Redoing.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
