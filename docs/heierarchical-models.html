<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>9 Heierarchical Models | (Re)Doing Bayesain Data Analysis</title>
  <meta name="description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="9 Heierarchical Models | (Re)Doing Bayesain Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Heierarchical Models | (Re)Doing Bayesain Data Analysis" />
  
  <meta name="twitter:description" content="Code, exercises and discussion to accompany a course taught from Kruschke’s Doing Bayesian Data Analysis (2ed)" />
  

<meta name="author" content="R Pruim">


<meta name="date" content="2019-03-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="jags-just-another-gibbs-sampler.html">
<link rel="next" href="model-comparison.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">(Re)Doing Bayesian Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> What’s in These Notes</a></li>
<li class="part"><span><b>I The Basics: Models, Probability, Bayes, and R</b></span></li>
<li class="chapter" data-level="2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.1</b> The Steps of Bayesian Data Analysis</a><ul>
<li class="chapter" data-level="2.1.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-code"><i class="fa fa-check"></i><b>2.1.1</b> R code</a></li>
<li class="chapter" data-level="2.1.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#r-packages"><i class="fa fa-check"></i><b>2.1.2</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-1-which-coin-is-it"><i class="fa fa-check"></i><b>2.2</b> Example 1: Which coin is it?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#freedom-of-choice"><i class="fa fa-check"></i><b>2.2.1</b> Freedom of choice</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#distributions"><i class="fa fa-check"></i><b>2.3</b> Distributions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#beta-distributions"><i class="fa fa-check"></i><b>2.3.1</b> Beta distributions</a></li>
<li class="chapter" data-level="2.3.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#normal-distributions"><i class="fa fa-check"></i><b>2.3.2</b> Normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#example-2-height-vs-weight"><i class="fa fa-check"></i><b>2.4</b> Example 2: Height vs Weight</a><ul>
<li class="chapter" data-level="2.4.1" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#data"><i class="fa fa-check"></i><b>2.4.1</b> Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#describing-a-model-for-the-relationship-between-height-and-weight"><i class="fa fa-check"></i><b>2.4.2</b> Describing a model for the relationship between height and weight</a></li>
<li class="chapter" data-level="2.4.3" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#prior"><i class="fa fa-check"></i><b>2.4.3</b> Prior</a></li>
<li class="chapter" data-level="2.4.4" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior"><i class="fa fa-check"></i><b>2.4.4</b> Posterior</a></li>
<li class="chapter" data-level="2.4.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#posterior-predictive-check"><i class="fa fa-check"></i><b>2.4.5</b> Posterior Predictive Check</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#where-do-we-go-from-here"><i class="fa fa-check"></i><b>2.5</b> Where do we go from here?</a></li>
<li class="chapter" data-level="2.6" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#ch02-exercises"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
<li class="chapter" data-level="2.7" data-path="credibility-models-and-parameters.html"><a href="credibility-models-and-parameters.html#footnotes"><i class="fa fa-check"></i><b>2.7</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html"><i class="fa fa-check"></i><b>3</b> Some Useful Bits of R</a><ul>
<li class="chapter" data-level="3.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#style-guide"><i class="fa fa-check"></i><b>3.1</b> You Gotta Have Style</a><ul>
<li class="chapter" data-level="3.1.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#an-additional-note-about-homework"><i class="fa fa-check"></i><b>3.1.1</b> An additional note about homework</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors-lists-and-data-frames"><i class="fa fa-check"></i><b>3.2</b> Vectors, Lists, and Data Frames</a><ul>
<li class="chapter" data-level="3.2.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#lists"><i class="fa fa-check"></i><b>3.2.2</b> Lists</a></li>
<li class="chapter" data-level="3.2.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#data-frames-for-rectangular-data"><i class="fa fa-check"></i><b>3.2.3</b> Data frames for rectangular data</a></li>
<li class="chapter" data-level="3.2.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#other-types-of-data"><i class="fa fa-check"></i><b>3.2.4</b> Other types of data</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#plotting-with-ggformula"><i class="fa fa-check"></i><b>3.3</b> Plotting with ggformula</a></li>
<li class="chapter" data-level="3.4" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#creating-data-with-expand.grid"><i class="fa fa-check"></i><b>3.4</b> Creating data with expand.grid()</a></li>
<li class="chapter" data-level="3.5" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#transforming-and-summarizing-data-dplyr-and-tidyr"><i class="fa fa-check"></i><b>3.5</b> Transforming and summarizing data dplyr and tidyr</a></li>
<li class="chapter" data-level="3.6" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#writing-functions"><i class="fa fa-check"></i><b>3.6</b> Writing Functions</a><ul>
<li class="chapter" data-level="3.6.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#why-write-functions"><i class="fa fa-check"></i><b>3.6.1</b> Why write functions?</a></li>
<li class="chapter" data-level="3.6.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#function-parts"><i class="fa fa-check"></i><b>3.6.2</b> Function parts</a></li>
<li class="chapter" data-level="3.6.3" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#the-function-function-has-its-function"><i class="fa fa-check"></i><b>3.6.3</b> The function() function has its function</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#some-common-error-messages"><i class="fa fa-check"></i><b>3.7</b> Some common error messages</a><ul>
<li class="chapter" data-level="3.7.1" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#object-not-found"><i class="fa fa-check"></i><b>3.7.1</b> object not found</a></li>
<li class="chapter" data-level="3.7.2" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#any-message-mentioning-yaml"><i class="fa fa-check"></i><b>3.7.2</b> Any message mentioning yaml</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#ch03-exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="some-useful-bits-of-r.html"><a href="some-useful-bits-of-r.html#footnotes-1"><i class="fa fa-check"></i><b>3.9</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>4</b> Probability</a><ul>
<li class="chapter" data-level="4.1" data-path="probability.html"><a href="probability.html#some-terminology"><i class="fa fa-check"></i><b>4.1</b> Some terminology</a></li>
<li class="chapter" data-level="4.2" data-path="probability.html"><a href="probability.html#distributions-in-r"><i class="fa fa-check"></i><b>4.2</b> Distributions in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability.html"><a href="probability.html#example-normal-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Example: Normal distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability.html"><a href="probability.html#simulating-running-proportions"><i class="fa fa-check"></i><b>4.2.2</b> Simulating running proportions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability.html"><a href="probability.html#joint-marginal-and-conditional-distributions"><i class="fa fa-check"></i><b>4.3</b> Joint, marginal, and conditional distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability.html"><a href="probability.html#example-hair-and-eye-color"><i class="fa fa-check"></i><b>4.3.1</b> Example: Hair and eye color</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability.html"><a href="probability.html#independence"><i class="fa fa-check"></i><b>4.3.2</b> Independence</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="probability.html"><a href="probability.html#ch04-exercises"><i class="fa fa-check"></i><b>4.4</b> Exercises</a></li>
<li class="chapter" data-level="4.5" data-path="probability.html"><a href="probability.html#footnotes-2"><i class="fa fa-check"></i><b>4.5</b> Footnotes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule and the Grid Method</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#the-big-bayesian-idea"><i class="fa fa-check"></i><b>5.1</b> The Big Bayesian Idea</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#likelihood"><i class="fa fa-check"></i><b>5.1.1</b> Likelihood</a></li>
<li class="chapter" data-level="5.1.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#when-bayes-is-easy"><i class="fa fa-check"></i><b>5.1.2</b> When Bayes is easy</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#estimating-the-bias-in-a-coin-using-the-grid-method"><i class="fa fa-check"></i><b>5.2</b> Estimating the bias in a coin using the Grid Method</a><ul>
<li class="chapter" data-level="5.2.1" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#creating-a-grid"><i class="fa fa-check"></i><b>5.2.1</b> Creating a Grid</a></li>
<li class="chapter" data-level="5.2.2" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#hdi-from-the-grid"><i class="fa fa-check"></i><b>5.2.2</b> HDI from the grid</a></li>
<li class="chapter" data-level="5.2.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#automating-the-grid"><i class="fa fa-check"></i><b>5.2.3</b> Automating the grid</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#working-on-the-log-scale"><i class="fa fa-check"></i><b>5.3</b> Working on the log scale</a></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#discrete-params"><i class="fa fa-check"></i><b>5.4</b> Discrete Parameters</a></li>
<li class="chapter" data-level="5.5" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#ch05-exercises"><i class="fa fa-check"></i><b>5.5</b> Exercises</a></li>
<li class="chapter" data-level="5.6" data-path="bayes-rule-and-the-grid-method.html"><a href="bayes-rule-and-the-grid-method.html#footnotes-3"><i class="fa fa-check"></i><b>5.6</b> Footnotes</a></li>
</ul></li>
<li class="part"><span><b>II Inferring a Binomial Probability</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-distributions-1"><i class="fa fa-check"></i><b>6.1</b> Beta distributions</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta-and-bayes"><i class="fa fa-check"></i><b>6.2</b> Beta and Bayes</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-bernoulli-likelihood-function"><i class="fa fa-check"></i><b>6.2.1</b> The Bernoulli likelihood function</a></li>
<li class="chapter" data-level="6.2.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-convenient-prior"><i class="fa fa-check"></i><b>6.2.2</b> A convenient prior</a></li>
<li class="chapter" data-level="6.2.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#pros-and-cons-of-conjugate-priors"><i class="fa fa-check"></i><b>6.2.3</b> Pros and Cons of conjugate priors</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#getting-to-know-the-beta-distributions"><i class="fa fa-check"></i><b>6.3</b> Getting to know the Beta distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#important-facts"><i class="fa fa-check"></i><b>6.3.1</b> Important facts</a></li>
<li class="chapter" data-level="6.3.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#alternative-parameterizations-of-beta-distributions"><i class="fa fa-check"></i><b>6.3.2</b> Alternative parameterizations of Beta distributions</a></li>
<li class="chapter" data-level="6.3.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#beta_params"><i class="fa fa-check"></i><b>6.3.3</b> beta_params()</a></li>
<li class="chapter" data-level="6.3.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#automating-bayesian-updates-for-a-proportion-beta-prior"><i class="fa fa-check"></i><b>6.3.4</b> Automating Bayesian updates for a proportion (beta prior)</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#what-if-the-prior-isnt-a-beta-distribution"><i class="fa fa-check"></i><b>6.4</b> What if the prior isn’t a beta distribution?</a></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#ch06-exercises"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo (MCMC)</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#king-markov-and-adviser-metropolis"><i class="fa fa-check"></i><b>7.1</b> King Markov and Adviser Metropolis</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#quick-intro-to-markov-chains"><i class="fa fa-check"></i><b>7.2</b> Quick Intro to Markov Chains</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#more-info-please"><i class="fa fa-check"></i><b>7.2.1</b> More info, please</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#definition"><i class="fa fa-check"></i><b>7.2.2</b> Definition</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#time-homogeneous-markov-chains"><i class="fa fa-check"></i><b>7.2.3</b> Time-Homogeneous Markov Chains</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#matrix-representation"><i class="fa fa-check"></i><b>7.2.4</b> Matrix representation</a></li>
<li class="chapter" data-level="7.2.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#regular-markov-chains"><i class="fa fa-check"></i><b>7.2.5</b> Regular Markov Chains</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#back-to-king-markov"><i class="fa fa-check"></i><b>7.3</b> Back to King Markov</a></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#how-well-does-the-metropolis-algorithm-work"><i class="fa fa-check"></i><b>7.4</b> How well does the Metropolis Algorithm work?</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-to-any-island"><i class="fa fa-check"></i><b>7.4.1</b> Jumping to any island</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#jumping-only-to-neighbor-islands"><i class="fa fa-check"></i><b>7.4.2</b> Jumping only to neighbor islands</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#markov-chains-and-posterior-sampling"><i class="fa fa-check"></i><b>7.5</b> Markov Chains and Posterior Sampling</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-1-estimating-a-proportion"><i class="fa fa-check"></i><b>7.5.1</b> Example 1: Estimating a proportion</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#example-2-estimating-mean-and-variance"><i class="fa fa-check"></i><b>7.5.2</b> Example 2: Estimating mean and variance</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#issues-with-metropolis-algorithm"><i class="fa fa-check"></i><b>7.5.3</b> Issues with Metropolis Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#two-coins"><i class="fa fa-check"></i><b>7.6</b> Two coins</a><ul>
<li class="chapter" data-level="7.6.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#the-model"><i class="fa fa-check"></i><b>7.6.1</b> The model</a></li>
<li class="chapter" data-level="7.6.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#exact-analysis"><i class="fa fa-check"></i><b>7.6.2</b> Exact analysis</a></li>
<li class="chapter" data-level="7.6.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#metropolis"><i class="fa fa-check"></i><b>7.6.3</b> Metropolis</a></li>
<li class="chapter" data-level="7.6.4" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#gibbs-sampling"><i class="fa fa-check"></i><b>7.6.4</b> Gibbs sampling</a></li>
<li class="chapter" data-level="7.6.5" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#advantages-and-disadvantages-of-gibbs-vs-metropolis"><i class="fa fa-check"></i><b>7.6.5</b> Advantages and Disadvantages of Gibbs vs Metropolis</a></li>
<li class="chapter" data-level="7.6.6" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#so-what-do-we-learn-about-the-coins"><i class="fa fa-check"></i><b>7.6.6</b> So what do we learn about the coins?</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-posterior-sampling-big-picture"><i class="fa fa-check"></i><b>7.7</b> MCMC posterior sampling: Big picture</a><ul>
<li class="chapter" data-level="7.7.1" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#mcmc-markov-chain-monte-carlo"><i class="fa fa-check"></i><b>7.7.1</b> MCMC = Markov chain Monte Carlo</a></li>
<li class="chapter" data-level="7.7.2" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#posterior-sampling-random-walk-through-the-posterior"><i class="fa fa-check"></i><b>7.7.2</b> Posterior sampling: Random walk through the posterior</a></li>
<li class="chapter" data-level="7.7.3" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#where-do-we-go-from-here-1"><i class="fa fa-check"></i><b>7.7.3</b> Where do we go from here?</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="markov-chain-monte-carlo-mcmc.html"><a href="markov-chain-monte-carlo-mcmc.html#ch07-exercises"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html"><i class="fa fa-check"></i><b>8</b> JAGS – Just Another Gibbs Sampler</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#what-jags-is"><i class="fa fa-check"></i><b>8.1</b> What JAGS is</a><ul>
<li class="chapter" data-level="8.1.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#jags-documentation"><i class="fa fa-check"></i><b>8.1.1</b> JAGS documentation</a></li>
<li class="chapter" data-level="8.1.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#updating-c-and-clang"><i class="fa fa-check"></i><b>8.1.2</b> Updating C and CLANG</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-1-estimating-a-proportion-1"><i class="fa fa-check"></i><b>8.2</b> Example 1: estimating a proportion</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-1"><i class="fa fa-check"></i><b>8.2.1</b> The Model</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#load-data"><i class="fa fa-check"></i><b>8.2.2</b> Load Data</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#specify-the-model"><i class="fa fa-check"></i><b>8.2.3</b> Specify the model</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#run-the-model"><i class="fa fa-check"></i><b>8.2.4</b> Run the model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#extracting-information-from-a-jags-run"><i class="fa fa-check"></i><b>8.3</b> Extracting information from a JAGS run</a><ul>
<li class="chapter" data-level="8.3.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#posterior-1"><i class="fa fa-check"></i><b>8.3.1</b> posterior()</a></li>
<li class="chapter" data-level="8.3.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#side-note-posterior-sampling-and-the-grid-method"><i class="fa fa-check"></i><b>8.3.2</b> Side note: posterior sampling and the grid method</a></li>
<li class="chapter" data-level="8.3.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-coda"><i class="fa fa-check"></i><b>8.3.3</b> Using coda</a></li>
<li class="chapter" data-level="8.3.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-bayesplot"><i class="fa fa-check"></i><b>8.3.4</b> Using bayesplot</a></li>
<li class="chapter" data-level="8.3.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#using-kruschkes-functions"><i class="fa fa-check"></i><b>8.3.5</b> Using Kruschke’s functions</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#optional-arguments-to-jags"><i class="fa fa-check"></i><b>8.4</b> Optional arguments to jags()</a><ul>
<li class="chapter" data-level="8.4.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#number-and-size-of-chains"><i class="fa fa-check"></i><b>8.4.1</b> Number and size of chains</a></li>
<li class="chapter" data-level="8.4.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#starting-point-for-chains"><i class="fa fa-check"></i><b>8.4.2</b> Starting point for chains</a></li>
<li class="chapter" data-level="8.4.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#running-chains-in-parallel"><i class="fa fa-check"></i><b>8.4.3</b> Running chains in parallel</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#example-2-comparing-two-proportions"><i class="fa fa-check"></i><b>8.5</b> Example 2: comparing two proportions</a><ul>
<li class="chapter" data-level="8.5.1" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-data"><i class="fa fa-check"></i><b>8.5.1</b> The data</a></li>
<li class="chapter" data-level="8.5.2" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#the-model-2"><i class="fa fa-check"></i><b>8.5.2</b> The model</a></li>
<li class="chapter" data-level="8.5.3" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#describing-the-model-to-jags"><i class="fa fa-check"></i><b>8.5.3</b> Describing the model to JAGS</a></li>
<li class="chapter" data-level="8.5.4" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#fitting-the-model"><i class="fa fa-check"></i><b>8.5.4</b> Fitting the model</a></li>
<li class="chapter" data-level="8.5.5" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#inspecting-the-results"><i class="fa fa-check"></i><b>8.5.5</b> Inspecting the results</a></li>
<li class="chapter" data-level="8.5.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#difference-in-proportions"><i class="fa fa-check"></i><b>8.5.6</b> Difference in proportions</a></li>
<li class="chapter" data-level="8.5.7" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#sampling-from-the-prior"><i class="fa fa-check"></i><b>8.5.7</b> Sampling from the prior</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="jags-just-another-gibbs-sampler.html"><a href="jags-just-another-gibbs-sampler.html#ch08-exercises"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="heierarchical-models.html"><a href="heierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Heierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#gamma-distributions"><i class="fa fa-check"></i><b>9.1</b> Gamma Distributions</a></li>
<li class="chapter" data-level="9.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#one-coin-from-one-mint"><i class="fa fa-check"></i><b>9.2</b> One coin from one mint</a></li>
<li class="chapter" data-level="9.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-one-mint"><i class="fa fa-check"></i><b>9.3</b> Multiple coins from one mint</a></li>
<li class="chapter" data-level="9.4" data-path="heierarchical-models.html"><a href="heierarchical-models.html#multiple-coins-from-multiple-mints"><i class="fa fa-check"></i><b>9.4</b> Multiple coins from multiple mints</a></li>
<li class="chapter" data-level="9.5" data-path="heierarchical-models.html"><a href="heierarchical-models.html#therapeutic-touch"><i class="fa fa-check"></i><b>9.5</b> Therapeutic Touch</a><ul>
<li class="chapter" data-level="9.5.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#abstract"><i class="fa fa-check"></i><b>9.5.1</b> Abstract</a></li>
<li class="chapter" data-level="9.5.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#data-1"><i class="fa fa-check"></i><b>9.5.2</b> Data</a></li>
<li class="chapter" data-level="9.5.3" data-path="heierarchical-models.html"><a href="heierarchical-models.html#a-heierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> A heierarchical model</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="heierarchical-models.html"><a href="heierarchical-models.html#other-parameterizations-we-might-have-tried"><i class="fa fa-check"></i><b>9.6</b> Other parameterizations we might have tried</a><ul>
<li class="chapter" data-level="9.6.1" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shape-parameters-for-beta"><i class="fa fa-check"></i><b>9.6.1</b> Shape parameters for Beta</a></li>
<li class="chapter" data-level="9.6.2" data-path="heierarchical-models.html"><a href="heierarchical-models.html#mean-instead-of-mode"><i class="fa fa-check"></i><b>9.6.2</b> Mean instead of mode</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="heierarchical-models.html"><a href="heierarchical-models.html#shrinkage"><i class="fa fa-check"></i><b>9.7</b> Shrinkage</a></li>
<li class="chapter" data-level="9.8" data-path="heierarchical-models.html"><a href="heierarchical-models.html#example-baseball-batting-average"><i class="fa fa-check"></i><b>9.8</b> Example: Baseball Batting Average</a></li>
<li class="chapter" data-level="9.9" data-path="heierarchical-models.html"><a href="heierarchical-models.html#ch09-exercises"><i class="fa fa-check"></i><b>9.9</b> Exerciess</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10</b> (Model Comparison)</a></li>
<li class="chapter" data-level="11" data-path="nhst.html"><a href="nhst.html"><i class="fa fa-check"></i><b>11</b> (NHST)</a></li>
<li class="chapter" data-level="12" data-path="point-null-hypotheses.html"><a href="point-null-hypotheses.html"><i class="fa fa-check"></i><b>12</b> (Point Null Hypotheses)</a></li>
<li class="chapter" data-level="13" data-path="goals-power-sample-size.html"><a href="goals-power-sample-size.html"><i class="fa fa-check"></i><b>13</b> (Goals, Power, Sample Size)</a></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#why-stan-might-work-better"><i class="fa fa-check"></i><b>14.1</b> Why Stan might work better</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#describing-a-model-to-stan"><i class="fa fa-check"></i><b>14.2</b> Describing a model to Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#samping-from-the-prior"><i class="fa fa-check"></i><b>14.3</b> Samping from the prior</a></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#exercises"><i class="fa fa-check"></i><b>14.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="glm-overview.html"><a href="glm-overview.html"><i class="fa fa-check"></i><b>15</b> GLM Overview</a><ul>
<li class="chapter" data-level="15.1" data-path="glm-overview.html"><a href="glm-overview.html#data-consists-of-observations-of-variables"><i class="fa fa-check"></i><b>15.1</b> Data consists of observations of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="glm-overview.html"><a href="glm-overview.html#variable-roles"><i class="fa fa-check"></i><b>15.1.1</b> Variable Roles</a></li>
<li class="chapter" data-level="15.1.2" data-path="glm-overview.html"><a href="glm-overview.html#types-of-variables"><i class="fa fa-check"></i><b>15.1.2</b> Types of Variables</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="glm-overview.html"><a href="glm-overview.html#glm-framework"><i class="fa fa-check"></i><b>15.2</b> GLM Framework</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html"><i class="fa fa-check"></i><b>16</b> Estimating One and Two Means</a><ul>
<li class="chapter" data-level="16.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#basic-model-for-two-means"><i class="fa fa-check"></i><b>16.1</b> Basic Model for Two Means</a><ul>
<li class="chapter" data-level="16.1.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-2"><i class="fa fa-check"></i><b>16.1.1</b> Data</a></li>
<li class="chapter" data-level="16.1.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model"><i class="fa fa-check"></i><b>16.1.2</b> Model</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#an-old-sleep-study"><i class="fa fa-check"></i><b>16.2</b> An Old Sleep Study</a><ul>
<li class="chapter" data-level="16.2.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#data-3"><i class="fa fa-check"></i><b>16.2.1</b> Data</a></li>
<li class="chapter" data-level="16.2.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#model-1"><i class="fa fa-check"></i><b>16.2.2</b> Model</a></li>
<li class="chapter" data-level="16.2.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#separate-standard-deviations-for-each-group"><i class="fa fa-check"></i><b>16.2.3</b> Separate standard deviations for each group</a></li>
<li class="chapter" data-level="16.2.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#comparison-to-t-test"><i class="fa fa-check"></i><b>16.2.4</b> Comparison to t-test</a></li>
<li class="chapter" data-level="16.2.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#rope-region-of-practical-equivalence"><i class="fa fa-check"></i><b>16.2.5</b> ROPE (Region of Practical Equivalence)</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#variations-on-the-theme"><i class="fa fa-check"></i><b>16.3</b> Variations on the theme</a><ul>
<li class="chapter" data-level="16.3.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-distributions-for-the-response"><i class="fa fa-check"></i><b>16.3.1</b> Other distributions for the response</a></li>
<li class="chapter" data-level="16.3.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#other-priors-for-sigma-or-tau"><i class="fa fa-check"></i><b>16.3.2</b> Other Priors for <span class="math inline">\(\sigma\)</span> (or <span class="math inline">\(\tau\)</span>)</a></li>
<li class="chapter" data-level="16.3.3" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#paired-comparisons"><i class="fa fa-check"></i><b>16.3.3</b> Paired Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#how-many-chains-how-long"><i class="fa fa-check"></i><b>16.4</b> How many chains? How long?</a><ul>
<li class="chapter" data-level="16.4.1" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#why-multiple-chains"><i class="fa fa-check"></i><b>16.4.1</b> Why multiple chains?</a></li>
<li class="chapter" data-level="16.4.2" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#what-large-n.eff-does-and-doesnt-do-for-us"><i class="fa fa-check"></i><b>16.4.2</b> What large n.eff does and doesn’t do for us</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#looking-at-likelihood"><i class="fa fa-check"></i><b>16.5</b> Looking at Likelihood</a></li>
<li class="chapter" data-level="16.6" data-path="estimating-one-and-two-means.html"><a href="estimating-one-and-two-means.html#exercises-1"><i class="fa fa-check"></i><b>16.6</b> Exercises</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">(Re)Doing Bayesain Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="heierarchical-models" class="section level1">
<h1><span class="header-section-number">9</span> Heierarchical Models</h1>
<div id="gamma-distributions" class="section level2">
<h2><span class="header-section-number">9.1</span> Gamma Distributions</h2>
<p>We will use gamma distributions for some of our priors in this chapter.
Gamma distributions have support <span class="math inline">\((0,\infty)\)</span> and are skewed to the right.
Both R and JAGS paramterize the gamma distributions with two parameters
called shape and rate.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dist</span>(<span class="st">&quot;gamma&quot;</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Gamma(2, 3)&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">gf_dist</span>(<span class="st">&quot;gamma&quot;</span>, <span class="dt">shape =</span> <span class="dv">4</span>, <span class="dt">rate =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Gamma(4, 3)&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">gf_dist</span>(<span class="st">&quot;gamma&quot;</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="dv">6</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Gamma(2, 6)&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">gf_dist</span>(<span class="st">&quot;gamma&quot;</span>, <span class="dt">shape =</span> <span class="dv">4</span>, <span class="dt">rate =</span> <span class="dv">6</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Gamma(4, 6)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_labs</span>(<span class="dt">title =</span> <span class="st">&quot;Some Gamma distributions&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch09-gamma-plot-1.png" width="65%" /></p>
<p>The mean, mode, standard deviation can be calcuated from the shape <span class="math inline">\(s\)</span> and rate
<span class="math inline">\(r\)</span> as follows:</p>
<p><span class="math display">\[\begin{align*}
\mu &amp;= \frac{s}{r}
\\
\omega &amp;= \frac{s−1}{r} \qquad (s &gt; 1)
\\
\sigma &amp; = \frac{\sqrt{s}}{r}
\end{align*}\]</span>
In addition, the scale parameter (1/rate) is sometimes used in place
of the rate parameter.
The <code>gamma_params()</code> function will automate conversion between various
parameterizations. It works just like <code>beta_params()</code> that we have seen before.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gamma_params</span>(<span class="dt">mode =</span> <span class="dv">15</span>, <span class="dt">sd =</span> <span class="dv">10</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="Redoing_files/figure-html/gamma-params-1.png" width="65%" /></p>
<table>
<thead>
<tr class="header">
<th align="right">shape</th>
<th align="right">rate</th>
<th align="right">scale</th>
<th align="right">mode</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">0.2</td>
<td align="right">5</td>
<td align="right">15</td>
<td align="right">20</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<p>As the shape parameter gets larger and larger, the gamma distribution becomes
less and less skewed (and more and more like a normal distribution):</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dist</span>(<span class="st">&quot;gamma&quot;</span>, <span class="dt">shape =</span> <span class="dv">25</span>, <span class="dt">rate =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Gamma(25, 5)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_dist</span>(<span class="st">&quot;norm&quot;</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Norm(5, 1)&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch09-gamma-normal-1.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dist</span>(<span class="st">&quot;gamma&quot;</span>, <span class="dt">shape =</span> <span class="dv">100</span>, <span class="dt">rate =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Gamma(25, 5)&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_dist</span>(<span class="st">&quot;norm&quot;</span>, <span class="dt">mean =</span> <span class="dv">20</span>, <span class="dt">sd =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;Norm(5, 1)&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch09-gamma-normal-2.png" width="65%" /></p>
</div>
<div id="one-coin-from-one-mint" class="section level2">
<h2><span class="header-section-number">9.2</span> One coin from one mint</h2>
<p><img src="images/Fig9-1.png" width="65%" /></p>
</div>
<div id="multiple-coins-from-one-mint" class="section level2">
<h2><span class="header-section-number">9.3</span> Multiple coins from one mint</h2>
<p><img src="images/Fig9-4.png" width="65%" /></p>
</div>
<div id="multiple-coins-from-multiple-mints" class="section level2">
<h2><span class="header-section-number">9.4</span> Multiple coins from multiple mints</h2>
<p><img src="images/Fig9-7.png" width="65%" /></p>
</div>
<div id="therapeutic-touch" class="section level2">
<h2><span class="header-section-number">9.5</span> Therapeutic Touch</h2>
<p>The study is described in the text. The article reporting on the study
can be found at <a href="https://jamanetwork.com/journals/jama/fullarticle/187390" class="uri">https://jamanetwork.com/journals/jama/fullarticle/187390</a>.
Here’s the abstract:</p>
<div id="abstract" class="section level3">
<h3><span class="header-section-number">9.5.1</span> Abstract</h3>
<p><strong>Context.</strong>— Therapeutic Touch (TT) is a widely used nursing practice rooted in
mysticism but alleged to have a scientific basis. Practitioners of TT claim to
treat many medical conditions by using their hands to manipulate a “human energy
field” perceptible above the patient’s skin.</p>
<p><strong>Objective.</strong>— To investigate whether TT practitioners can actually perceive a
“human energy field.”</p>
<p><strong>Design.</strong>— Twenty-one practitioners with TT experience for from 1 to 27 years
were tested under blinded conditions to determine whether they could correctly
identify which of their hands was closest to the investigator’s hand. Placement
of the investigator’s hand was determined by flipping a coin. Fourteen
practitioners were tested 10 times each, and 7 practitioners were tested 20
times each.</p>
<p><strong>Main Outcome Measure.</strong>— Practitioners of TT were asked to state whether the
investigator’s unseen hand hovered above their right hand or their left hand. To
show the validity of TT theory, the practitioners should have been able to
locate the investigator’s hand 100% of the time. A score of 50% would be
expected through chance alone.</p>
<p><strong>Results.</strong>— Practitioners of TT identified the correct hand in only 123 (44%)
of 280 trials, which is close to what would be expected for random chance. There
was no significant correlation between the practitioner’s score and length of
experience (r=0.23). The statistical power of this experiment was sufficient to
conclude that if TT practitioners could reliably detect a human energy field,
the study would have demonstrated this.</p>
<p><strong>Conclusions.</strong>— Twenty-one experienced TT practitioners were unable to detect
the investigator’s “energy field.” Their failure to substantiate TT’s most
fundamental claim is unrefuted evidence that the claims of TT are groundless and
that further professional use is unjustified.</p>
</div>
<div id="data-1" class="section level3">
<h3><span class="header-section-number">9.5.2</span> Data</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mosaic)
<span class="kw">head</span>(TherapeuticTouch, <span class="dv">3</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">y</th>
<th align="left">s</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">S01</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="left">S01</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="left">S01</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_barh</span>(s <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> TherapeuticTouch, <span class="dt">fill =</span> <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(y))</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-data-1.png" width="65%" /></p>
</div>
<div id="a-heierarchical-model" class="section level3">
<h3><span class="header-section-number">9.5.3</span> A heierarchical model</h3>
<p>Big ideas:</p>
<ul>
<li><p>The ten trials for each subject are a sample from the many
trials that could have been done.</p>
<ul>
<li>distribution of results: <span class="math inline">\({\sf Bern}(\theta_s)\)</span> – each subject
has a potentially different <span class="math inline">\(\theta_s\)</span>.</li>
</ul></li>
<li><p>The subjects themselves are just a sample from all of the
TT practitioners that could have been in the study.</p>
<ul>
<li><p>So the <span class="math inline">\(\theta_s\)</span> values are a sample from a distribution
of <span class="math inline">\(\theta\)</span> values for all TT practititioners and tell
us something about that distribution.</p></li>
<li><p>We will assume a beta distribution for this,
where the parameters are unknown and estimated from the data.</p></li>
</ul></li>
<li><p>Use the data to estimate both the individual level
<span class="math inline">\(\theta_s\)</span> values and the group level parameters of the beta
distribution.</p></li>
<li><p>Parameterization of the beta distribution for <span class="math inline">\(\theta_s\)</span>.</p>
<ul>
<li><p>We are primarily interested in the mean or mode of
this distribution (typical value of <span class="math inline">\(\theta\)</span> for TT
practitioner).</p></li>
<li><p>Many combinations of shape parameters give the same
mean (or mode), and they are highly correlated. For example,
<span class="math inline">\({\sf Beta}(2,4)\)</span>,
<span class="math inline">\({\sf Beta}(20,40)\)</span>, and
<span class="math inline">\({\sf Beta}(200,400)\)</span>
all have a mean of 1/3.</p></li>
<li><p>We will parameterize this Beta distribution with
<strong>mode</strong> (<span class="math inline">\(\omega\)</span>), and <strong>concentration</strong> (<span class="math inline">\(\kappa\)</span>)</p></li>
<li><p>We will need to convert mode and concentration into the
two shape parameters, since JAGS and R use the
two shape parameters.</p></li>
</ul>
<p><span class="math display">\[\begin{align}
  \alpha &amp;= \omega  (\kappa - 2) + 1\\
  \beta  &amp;= (1 - \omega) (\kappa - 2) + 1)
  \end{align}\]</span></p></li>
<li><p><span class="math inline">\(\omega\)</span> and <span class="math inline">\(\kappa\)</span> will need priors</p>
<ul>
<li><span class="math inline">\(\omega\)</span>: Beta</li>
<li><span class="math inline">\(\kappa - 2\)</span>: Gamma (because <span class="math inline">\(\kappa &gt;2\)</span>)</li>
</ul></li>
</ul>
<p>Putting this altogether we have the following picture:</p>
<p><img src="images/Fig9-7.png" width="65%" /></p>
<p>Now we code it up for JAGS.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gamma_params</span>(<span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">shape</th>
<th align="right">rate</th>
<th align="right">scale</th>
<th align="left">mode</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.01</td>
<td align="right">0.01</td>
<td align="right">100</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">touch_model &lt;-<span class="st"> </span><span class="cf">function</span>() {
   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Ntotal) {
     y[i] <span class="op">~</span><span class="st"> </span><span class="kw">dbern</span>(theta[s[i]])
   }
  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Nsubj) {
    theta[s] <span class="op">~</span><span class="st"> </span><span class="kw">dbeta</span>(omega <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>omega) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)
  }
  omega <span class="op">~</span><span class="st"> </span><span class="kw">dbeta</span>(<span class="dv">1</span>, <span class="dv">1</span>)
  kappa &lt;-<span class="st"> </span>kappaMinusTwo <span class="op">+</span><span class="st"> </span><span class="dv">2</span>
  kappaMinusTwo <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)     <span class="co"># mean = 1, sd = 10</span>
  }</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
TouchData &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">Ntotal =</span> <span class="kw">nrow</span>(TherapeuticTouch),
  <span class="dt">Nsubj =</span> <span class="kw">length</span>(<span class="kw">unique</span>(TherapeuticTouch<span class="op">$</span>s)),
  <span class="dt">y =</span> TherapeuticTouch<span class="op">$</span>y,
  <span class="co"># must convert subjects to sequence 1:Nsubj</span>
  <span class="dt">s =</span> <span class="kw">as.numeric</span>(<span class="kw">factor</span>(TherapeuticTouch<span class="op">$</span>s))
)
touch_jags &lt;-
<span class="st">  </span><span class="kw">jags</span>(
  <span class="dt">data =</span> TouchData,
  <span class="dt">model =</span> touch_model,
  <span class="dt">parameters.to.save =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;kappa&quot;</span>, <span class="st">&quot;omega&quot;</span>),
)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags</code></pre>
<pre><code>## Inference for Bugs model at &quot;/var/folders/py/txwd26jx5rq83f4nn0f5fmmm0000gn/T//RtmpClV83u/modelaef323d32c02.txt&quot;, fit using jags,
##  3 chains, each with 2000 iterations (first 1000 discarded)
##  n.sims = 3000 iterations saved
##           mu.vect sd.vect    2.5%     25%     50%     75%   97.5%  Rhat
## kappa      52.286  54.028   8.932  20.025  34.399  65.489 210.966 1.056
## omega       0.439   0.035   0.367   0.416   0.439   0.462   0.508 1.004
## theta[1]    0.363   0.088   0.175   0.305   0.369   0.426   0.517 1.016
## theta[2]    0.384   0.084   0.208   0.331   0.389   0.444   0.536 1.015
## theta[3]    0.409   0.081   0.241   0.358   0.414   0.463   0.564 1.005
## theta[4]    0.411   0.083   0.236   0.357   0.415   0.467   0.564 1.020
## theta[5]    0.409   0.080   0.244   0.358   0.411   0.461   0.563 1.010
## theta[6]    0.410   0.082   0.235   0.359   0.414   0.464   0.562 1.006
## theta[7]    0.409   0.080   0.244   0.359   0.412   0.461   0.560 1.019
## theta[8]    0.410   0.080   0.243   0.360   0.413   0.462   0.565 1.012
## theta[9]    0.407   0.080   0.247   0.356   0.410   0.459   0.561 1.008
## theta[10]   0.409   0.081   0.238   0.358   0.413   0.463   0.559 1.008
## theta[11]   0.433   0.077   0.276   0.384   0.433   0.483   0.588 1.004
## theta[12]   0.433   0.081   0.278   0.383   0.434   0.485   0.593 1.005
## theta[13]   0.434   0.078   0.280   0.385   0.434   0.484   0.587 1.002
## theta[14]   0.432   0.080   0.272   0.380   0.432   0.482   0.593 1.001
## theta[15]   0.433   0.080   0.275   0.381   0.434   0.484   0.590 1.004
## theta[16]   0.457   0.080   0.300   0.408   0.454   0.504   0.624 1.002
## theta[17]   0.456   0.079   0.295   0.406   0.453   0.506   0.621 1.002
## theta[18]   0.454   0.081   0.295   0.401   0.453   0.504   0.626 1.003
## theta[19]   0.457   0.078   0.313   0.407   0.454   0.505   0.618 1.001
## theta[20]   0.455   0.080   0.298   0.403   0.452   0.508   0.612 1.003
## theta[21]   0.457   0.082   0.296   0.404   0.455   0.510   0.621 1.005
## theta[22]   0.457   0.079   0.311   0.405   0.454   0.507   0.625 1.003
## theta[23]   0.480   0.083   0.328   0.425   0.474   0.529   0.658 1.008
## theta[24]   0.482   0.083   0.327   0.427   0.476   0.531   0.660 1.003
## theta[25]   0.506   0.088   0.351   0.446   0.497   0.562   0.691 1.008
## theta[26]   0.507   0.088   0.354   0.446   0.498   0.560   0.700 1.003
## theta[27]   0.505   0.087   0.355   0.445   0.495   0.559   0.695 1.008
## theta[28]   0.527   0.093   0.374   0.460   0.517   0.581   0.735 1.008
## deviance  378.963   5.156 368.591 375.437 379.284 382.411 388.755 1.010
##           n.eff
## kappa        44
## omega      1100
## theta[1]    210
## theta[2]    190
## theta[3]    970
## theta[4]    270
## theta[5]    500
## theta[6]   1100
## theta[7]    180
## theta[8]    510
## theta[9]    650
## theta[10]   710
## theta[11]  1700
## theta[12]   710
## theta[13]  3000
## theta[14]  3000
## theta[15]  3000
## theta[16]  3000
## theta[17]  1600
## theta[18]  3000
## theta[19]  3000
## theta[20]  3000
## theta[21]  1000
## theta[22]  1800
## theta[23]   510
## theta[24]  1300
## theta[25]   260
## theta[26]   680
## theta[27]   250
## theta[28]   300
## deviance    220
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 13.2 and DIC = 392.1
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<p>What do we learn from a quick look at this output?</p>
<ul>
<li>The Rhat values look good</li>
<li>The autocorrelation varies from parameter to parameter. For some parameters,
it looks like it will take a much longer run to get a large effective sample size.</li>
</ul>
<p>So let’s do a larger run.</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags &lt;-
<span class="st">  </span><span class="kw">jags.parallel</span>(
  <span class="dt">data =</span> TouchData,
  <span class="dt">model =</span> touch_model,
  <span class="dt">parameters.to.save =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;kappa&quot;</span>, <span class="st">&quot;omega&quot;</span>),
  <span class="dt">n.burnin =</span> <span class="dv">1000</span>,
  <span class="dt">n.iter =</span> <span class="dv">41000</span>,
  <span class="dt">n.chains =</span> <span class="dv">5</span>,
  <span class="dt">n.thin =</span> <span class="dv">10</span>,
  <span class="dt">jags.seed =</span> <span class="dv">54321</span>
)    </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags</code></pre>
<pre><code>## Inference for Bugs model at &quot;touch_model&quot;, fit using jags,
##  5 chains, each with 41000 iterations (first 1000 discarded), n.thin = 10
##  n.sims = 20000 iterations saved
##           mu.vect sd.vect    2.5%     25%     50%     75%   97.5%  Rhat
## kappa      55.710  55.745   8.632  21.295  37.091  68.780 210.357 1.001
## omega       0.435   0.037   0.362   0.412   0.436   0.460   0.508 1.001
## theta[1]    0.360   0.087   0.169   0.305   0.367   0.422   0.513 1.001
## theta[2]    0.384   0.084   0.206   0.332   0.389   0.441   0.536 1.001
## theta[3]    0.407   0.080   0.240   0.357   0.410   0.460   0.560 1.001
## theta[4]    0.407   0.080   0.239   0.357   0.410   0.461   0.560 1.001
## theta[5]    0.408   0.080   0.240   0.359   0.411   0.460   0.561 1.001
## theta[6]    0.407   0.080   0.240   0.357   0.410   0.459   0.561 1.001
## theta[7]    0.407   0.080   0.241   0.358   0.410   0.459   0.559 1.001
## theta[8]    0.407   0.080   0.238   0.357   0.411   0.459   0.560 1.001
## theta[9]    0.408   0.080   0.241   0.358   0.411   0.460   0.563 1.001
## theta[10]   0.408   0.080   0.242   0.358   0.411   0.460   0.563 1.001
## theta[11]   0.431   0.079   0.274   0.382   0.431   0.481   0.591 1.001
## theta[12]   0.430   0.079   0.271   0.380   0.430   0.480   0.588 1.001
## theta[13]   0.431   0.079   0.272   0.381   0.430   0.481   0.588 1.001
## theta[14]   0.430   0.078   0.276   0.380   0.430   0.479   0.590 1.001
## theta[15]   0.431   0.078   0.274   0.382   0.432   0.481   0.590 1.001
## theta[16]   0.454   0.080   0.300   0.402   0.451   0.503   0.622 1.001
## theta[17]   0.454   0.080   0.303   0.402   0.451   0.503   0.624 1.001
## theta[18]   0.455   0.080   0.301   0.403   0.451   0.505   0.624 1.001
## theta[19]   0.454   0.080   0.301   0.402   0.452   0.502   0.626 1.001
## theta[20]   0.454   0.079   0.300   0.403   0.452   0.502   0.620 1.001
## theta[21]   0.455   0.080   0.303   0.403   0.452   0.504   0.621 1.001
## theta[22]   0.455   0.080   0.302   0.402   0.451   0.504   0.622 1.001
## theta[23]   0.477   0.083   0.327   0.422   0.471   0.527   0.659 1.001
## theta[24]   0.476   0.082   0.328   0.422   0.470   0.526   0.657 1.001
## theta[25]   0.501   0.087   0.349   0.441   0.492   0.553   0.691 1.001
## theta[26]   0.500   0.086   0.351   0.441   0.493   0.551   0.691 1.001
## theta[27]   0.500   0.086   0.350   0.441   0.493   0.553   0.691 1.001
## theta[28]   0.525   0.093   0.370   0.460   0.514   0.581   0.733 1.001
## deviance  379.089   5.187 368.486 375.671 379.322 382.640 388.787 1.001
##           n.eff
## kappa      8100
## omega      8900
## theta[1]  19000
## theta[2]  20000
## theta[3]  20000
## theta[4]  19000
## theta[5]   8400
## theta[6]  20000
## theta[7]   8100
## theta[8]  12000
## theta[9]   6900
## theta[10] 13000
## theta[11] 20000
## theta[12] 20000
## theta[13] 10000
## theta[14] 20000
## theta[15] 20000
## theta[16] 20000
## theta[17] 20000
## theta[18] 20000
## theta[19] 20000
## theta[20] 20000
## theta[21] 20000
## theta[22] 18000
## theta[23] 12000
## theta[24] 15000
## theta[25]  9700
## theta[26] 20000
## theta[27]  9900
## theta[28] 20000
## deviance  20000
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 13.5 and DIC = 392.5
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">touch_mcmc &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(touch_jags)
<span class="kw">plot_post</span>(touch_mcmc[, <span class="st">&quot;omega&quot;</span>], <span class="dt">comparison_value =</span> <span class="fl">0.5</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-diag-1.png" width="65%" /></p>
<pre><code>## $posterior
##        ESS   mean median   mode
## var1 14724 0.4354 0.4357 0.4379
## 
## $hdi
##   prob     lo     hi
## 1 0.95 0.3638 0.5091
## 
## $comparison
##   value P(&lt; comp. val.) P(&gt; comp. val.)
## 1   0.5          0.9597         0.04025</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag_mcmc</span>(touch_mcmc, <span class="dt">par =</span> <span class="st">&quot;omega&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-diag-2.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag_mcmc</span>(touch_mcmc, <span class="dt">par =</span> <span class="st">&quot;kappa&quot;</span>)</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-diag-3.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">diag_mcmc</span>(touch_mcmc, <span class="dt">par =</span> <span class="st">&quot;theta[1]&quot;</span>)
<span class="kw">mcmc_pairs</span>(touch_mcmc, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;omega&quot;</span>, <span class="st">&quot;kappa&quot;</span>))</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-diag-4.png" width="65%" /><img src="Redoing_files/figure-html/ch09-touch-diag-5.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r">GGally<span class="op">::</span><span class="kw">ggpairs</span>(<span class="kw">posterior</span>(touch_jags) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(omega, kappa))</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-diag-6.png" width="65%" /></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_point</span>(kappa <span class="op">~</span><span class="st"> </span>omega, <span class="dt">data =</span> <span class="kw">posterior</span>(touch_jags), <span class="dt">alpha =</span> <span class="fl">0.05</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">gf_density2d</span>(kappa <span class="op">~</span><span class="st"> </span>omega, <span class="dt">data =</span> <span class="kw">posterior</span>(touch_jags))</code></pre>
<p><img src="Redoing_files/figure-html/ch09-touch-diag-7.png" width="65%" /></p>
</div>
</div>
<div id="other-parameterizations-we-might-have-tried" class="section level2">
<h2><span class="header-section-number">9.6</span> Other parameterizations we might have tried</h2>
<div id="shape-parameters-for-beta" class="section level3">
<h3><span class="header-section-number">9.6.1</span> Shape parameters for Beta</h3>
<p>Suppose we decided to parameterize the beta distribution with
shape parameters like this?</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_model2 &lt;-<span class="st"> </span><span class="cf">function</span>() {
   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Ntotal) {
     y[i] <span class="op">~</span><span class="st"> </span><span class="kw">dbern</span>(theta[s[i]])
   }
  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Nsubj) {
    theta[s] <span class="op">~</span><span class="st"> </span><span class="kw">dbeta</span>(alpha, beta)
  }
  kappa &lt;-<span class="st"> </span>alpha <span class="op">+</span><span class="st"> </span>beta
  mu &lt;-<span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span>(alpha <span class="op">+</span><span class="st"> </span>beta)
  alpha &lt;-<span class="st"> </span>alphaMinusOne <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  beta  &lt;-<span class="st"> </span>betaMinusOne <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  alphaMinusOne <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)
  betaMinusOne <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)
  }</code></pre>
<p>We’ll run it with the same options we used above to faciliate easy
comparisons.</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags2 &lt;-
<span class="st">  </span><span class="kw">jags.parallel</span>(
  <span class="dt">data =</span> TouchData,
  <span class="dt">model =</span> touch_model2,
  <span class="dt">parameters.to.save =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;alpha&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;omega&quot;</span>, <span class="st">&quot;kappa&quot;</span>),
  <span class="dt">n.burnin =</span> <span class="dv">1000</span>,
  <span class="dt">n.iter =</span> <span class="dv">41000</span>,
  <span class="dt">n.chains =</span> <span class="dv">5</span>,
  <span class="dt">n.thin =</span> <span class="dv">10</span>,
  <span class="dt">jags.seed =</span> <span class="dv">54321</span>
)    </code></pre>
<p>The resuls are disasterous: Rhat values well above 1 and effective sample sizes that
are <em>much</em> smaller than before.</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags2</code></pre>
<pre><code>## Inference for Bugs model at &quot;touch_model2&quot;, fit using jags,
##  5 chains, each with 41000 iterations (first 1000 discarded), n.thin = 10
##  n.sims = 20000 iterations saved
##           mu.vect sd.vect    2.5%     25%     50%     75%   97.5%  Rhat
## alpha      19.586  23.261   1.000   4.833  12.099  24.854  89.225 2.300
## beta       24.922  29.869   1.000   6.200  15.476  31.857 110.226 2.411
## kappa      44.508  52.940   2.000  11.184  27.621  56.852 197.948 2.369
## mu          0.448   0.040   0.369   0.420   0.447   0.482   0.506 1.157
## theta[1]    0.322   0.120   0.056   0.247   0.344   0.409   0.509 1.708
## theta[2]    0.355   0.107   0.112   0.292   0.370   0.431   0.532 1.435
## theta[3]    0.391   0.098   0.172   0.333   0.399   0.455   0.567 1.210
## theta[4]    0.391   0.097   0.175   0.335   0.400   0.455   0.570 1.205
## theta[5]    0.392   0.098   0.176   0.335   0.401   0.457   0.571 1.196
## theta[6]    0.391   0.098   0.170   0.334   0.400   0.456   0.570 1.213
## theta[7]    0.392   0.097   0.176   0.335   0.399   0.455   0.571 1.188
## theta[8]    0.391   0.097   0.174   0.334   0.399   0.456   0.567 1.204
## theta[9]    0.391   0.098   0.171   0.333   0.400   0.455   0.568 1.212
## theta[10]   0.391   0.098   0.175   0.333   0.399   0.455   0.568 1.205
## theta[11]   0.427   0.094   0.233   0.370   0.428   0.484   0.621 1.066
## theta[12]   0.427   0.094   0.233   0.371   0.429   0.485   0.619 1.064
## theta[13]   0.427   0.094   0.231   0.370   0.428   0.484   0.619 1.073
## theta[14]   0.428   0.094   0.229   0.371   0.429   0.485   0.619 1.071
## theta[15]   0.427   0.094   0.230   0.370   0.429   0.483   0.616 1.070
## theta[16]   0.463   0.096   0.286   0.402   0.456   0.517   0.679 1.046
## theta[17]   0.463   0.096   0.285   0.403   0.456   0.517   0.676 1.044
## theta[18]   0.464   0.096   0.286   0.403   0.457   0.518   0.682 1.048
## theta[19]   0.462   0.096   0.282   0.401   0.456   0.517   0.678 1.049
## theta[20]   0.463   0.095   0.288   0.402   0.457   0.517   0.677 1.047
## theta[21]   0.462   0.097   0.283   0.401   0.456   0.516   0.682 1.045
## theta[22]   0.463   0.096   0.287   0.401   0.456   0.518   0.680 1.048
## theta[23]   0.499   0.104   0.325   0.429   0.485   0.554   0.747 1.134
## theta[24]   0.500   0.104   0.325   0.430   0.486   0.555   0.747 1.135
## theta[25]   0.533   0.117   0.353   0.452   0.512   0.597   0.814 1.280
## theta[26]   0.533   0.117   0.354   0.450   0.513   0.597   0.812 1.282
## theta[27]   0.533   0.118   0.353   0.451   0.512   0.597   0.819 1.289
## theta[28]   0.569   0.133   0.373   0.471   0.540   0.644   0.880 1.459
## deviance  378.572   5.644 367.282 374.715 378.780 382.457 389.202 1.034
##           n.eff
## alpha         7
## beta          7
## kappa         7
## mu           27
## theta[1]     10
## theta[2]     14
## theta[3]     30
## theta[4]     30
## theta[5]     31
## theta[6]     30
## theta[7]     33
## theta[8]     30
## theta[9]     29
## theta[10]    31
## theta[11]   250
## theta[12]   260
## theta[13]   180
## theta[14]   220
## theta[15]   190
## theta[16]   260
## theta[17]   330
## theta[18]   270
## theta[19]   280
## theta[20]   260
## theta[21]   290
## theta[22]   280
## theta[23]    35
## theta[24]    35
## theta[25]    17
## theta[26]    17
## theta[27]    16
## theta[28]    12
## deviance    120
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 15.4 and DIC = 394.0
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
</div>
<div id="mean-instead-of-mode" class="section level3">
<h3><span class="header-section-number">9.6.2</span> Mean instead of mode</h3>
<p>This change seems less dramatic. Let’s see how using mean and concentraion
compares to using mode and concentration.</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_model3 &lt;-<span class="st"> </span><span class="cf">function</span>() {
   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Ntotal) {
     y[i] <span class="op">~</span><span class="st"> </span><span class="kw">dbern</span>(theta[s[i]])
   }
  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>Nsubj) {
    theta[s] <span class="op">~</span><span class="st"> </span><span class="kw">dbeta</span>(mu <span class="op">*</span><span class="st"> </span>kappa, (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu) <span class="op">*</span><span class="st"> </span>kappa)
  }
  mu <span class="op">~</span><span class="st"> </span><span class="kw">dbeta</span>(<span class="dv">2</span>, <span class="dv">2</span>)
  kappa &lt;-<span class="st"> </span>kappaMinusTwo <span class="op">+</span><span class="st"> </span><span class="dv">2</span>
  kappaMinusTwo <span class="op">~</span><span class="st"> </span><span class="kw">dgamma</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)
  }</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags3 &lt;-
<span class="st">  </span><span class="kw">jags.parallel</span>(
  <span class="dt">data =</span> TouchData,
  <span class="dt">model =</span> touch_model3,
  <span class="dt">parameters.to.save =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;kappa&quot;</span>),
  <span class="dt">n.burnin =</span> <span class="dv">1000</span>,
  <span class="dt">n.iter =</span> <span class="dv">41000</span>,
  <span class="dt">n.chains =</span> <span class="dv">5</span>,
  <span class="dt">n.thin =</span> <span class="dv">10</span>,
  <span class="dt">jags.seed =</span> <span class="dv">54321</span>
)    </code></pre>
<p>This model seems to perform reasonably well.</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags3</code></pre>
<pre><code>## Inference for Bugs model at &quot;touch_model3&quot;, fit using jags,
##  5 chains, each with 41000 iterations (first 1000 discarded), n.thin = 10
##  n.sims = 20000 iterations saved
##           mu.vect sd.vect    2.5%     25%     50%     75%   97.5%  Rhat
## kappa      58.519  58.419   9.258  22.258  39.046  72.852 222.144 1.001
## mu          0.441   0.033   0.377   0.419   0.441   0.463   0.507 1.001
## theta[1]    0.364   0.087   0.174   0.310   0.373   0.425   0.514 1.001
## theta[2]    0.387   0.082   0.213   0.337   0.392   0.443   0.536 1.001
## theta[3]    0.409   0.078   0.248   0.360   0.412   0.460   0.558 1.001
## theta[4]    0.409   0.078   0.244   0.361   0.412   0.461   0.559 1.001
## theta[5]    0.409   0.079   0.241   0.360   0.412   0.461   0.557 1.001
## theta[6]    0.409   0.080   0.243   0.360   0.412   0.462   0.561 1.001
## theta[7]    0.409   0.079   0.242   0.360   0.412   0.461   0.560 1.001
## theta[8]    0.408   0.079   0.242   0.359   0.411   0.460   0.559 1.001
## theta[9]    0.409   0.079   0.244   0.360   0.413   0.461   0.562 1.001
## theta[10]   0.410   0.079   0.243   0.361   0.412   0.462   0.559 1.001
## theta[11]   0.432   0.078   0.276   0.382   0.432   0.481   0.589 1.001
## theta[12]   0.433   0.078   0.276   0.383   0.433   0.482   0.588 1.001
## theta[13]   0.431   0.077   0.274   0.382   0.432   0.480   0.584 1.001
## theta[14]   0.431   0.078   0.274   0.382   0.432   0.481   0.586 1.001
## theta[15]   0.431   0.078   0.276   0.383   0.431   0.480   0.590 1.001
## theta[16]   0.454   0.078   0.306   0.403   0.451   0.503   0.619 1.001
## theta[17]   0.455   0.078   0.307   0.404   0.452   0.503   0.619 1.001
## theta[18]   0.454   0.079   0.302   0.403   0.451   0.503   0.618 1.001
## theta[19]   0.455   0.077   0.309   0.405   0.452   0.503   0.617 1.001
## theta[20]   0.454   0.079   0.302   0.402   0.451   0.503   0.619 1.001
## theta[21]   0.454   0.078   0.300   0.404   0.452   0.502   0.616 1.001
## theta[22]   0.455   0.079   0.303   0.404   0.452   0.503   0.622 1.001
## theta[23]   0.477   0.082   0.329   0.422   0.471   0.526   0.657 1.001
## theta[24]   0.477   0.081   0.329   0.423   0.472   0.526   0.655 1.001
## theta[25]   0.500   0.086   0.352   0.441   0.491   0.551   0.692 1.001
## theta[26]   0.499   0.085   0.353   0.441   0.491   0.549   0.690 1.001
## theta[27]   0.498   0.084   0.350   0.441   0.491   0.549   0.685 1.001
## theta[28]   0.522   0.091   0.368   0.458   0.512   0.577   0.725 1.001
## deviance  379.246   5.135 368.618 375.817 379.516 382.831 388.728 1.001
##           n.eff
## kappa     16000
## mu         8700
## theta[1]  18000
## theta[2]  20000
## theta[3]  17000
## theta[4]  15000
## theta[5]  19000
## theta[6]  20000
## theta[7]  12000
## theta[8]  11000
## theta[9]  20000
## theta[10] 20000
## theta[11] 13000
## theta[12]  9900
## theta[13] 12000
## theta[14] 20000
## theta[15] 20000
## theta[16] 13000
## theta[17] 20000
## theta[18] 18000
## theta[19] 20000
## theta[20] 15000
## theta[21]  6200
## theta[22] 17000
## theta[23] 20000
## theta[24] 20000
## theta[25] 20000
## theta[26] 20000
## theta[27] 20000
## theta[28] 12000
## deviance  20000
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 13.2 and DIC = 392.4
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">TouchData0 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">Ntotal =</span> <span class="dv">0</span>,
  <span class="dt">Nsubj =</span> <span class="kw">length</span>(<span class="kw">unique</span>(TherapeuticTouch<span class="op">$</span>s)),
  <span class="co"># y = TherapeuticTouch$y,</span>
  <span class="co"># must convert subjects to sequence 1:Nsubj</span>
  <span class="dt">s =</span> <span class="kw">as.numeric</span>(<span class="kw">factor</span>(TherapeuticTouch<span class="op">$</span>s))
)</code></pre>
<p>So why do we prefer the mode to the mean? Let’s take a look at the prior
distribution on one of the <span class="math inline">\(\theta\)</span>s.</p>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags_prior &lt;-
<span class="st">  </span><span class="kw">jags.parallel</span>(
  <span class="dt">data =</span> TouchData0,
  <span class="dt">model =</span> touch_model,
  <span class="dt">parameters.to.save =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;kappa&quot;</span>, <span class="st">&quot;omega&quot;</span>),
  <span class="dt">n.burnin =</span> <span class="dv">1000</span>,
  <span class="dt">n.iter =</span> <span class="dv">41000</span>,
  <span class="dt">n.chains =</span> <span class="dv">5</span>,
  <span class="dt">n.thin =</span> <span class="dv">10</span>,
  <span class="dt">DIC =</span> <span class="ot">FALSE</span>,
  <span class="dt">jags.seed =</span> <span class="dv">54321</span>
)    </code></pre>
<pre class="sourceCode r"><code class="sourceCode r">touch_jags_prior3 &lt;-
<span class="st">  </span><span class="kw">jags.parallel</span>(
  <span class="dt">data =</span> TouchData0,
  <span class="dt">model =</span> touch_model3,
  <span class="dt">parameters.to.save =</span> <span class="kw">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;kappa&quot;</span>, <span class="st">&quot;mu&quot;</span>),
  <span class="dt">n.burnin =</span> <span class="dv">1000</span>,
  <span class="dt">n.iter =</span> <span class="dv">41000</span>,
  <span class="dt">n.chains =</span> <span class="dv">5</span>,
  <span class="dt">n.thin =</span> <span class="dv">10</span>,
  <span class="dt">DIC =</span> <span class="ot">FALSE</span>,
  <span class="dt">jags.seed =</span> <span class="dv">54321</span>
)    </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">gf_dens</span>( <span class="op">~</span><span class="st"> </span>theta<span class="fl">.1</span>, <span class="dt">data =</span> <span class="kw">posterior</span>(touch_jags_prior), <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;mode&quot;</span>) <span class="op">%&gt;%</span>
<span class="kw">gf_dens</span>( <span class="op">~</span><span class="st"> </span>theta<span class="fl">.1</span>, <span class="dt">data =</span> <span class="kw">posterior</span>(touch_jags_prior3), <span class="dt">color =</span> <span class="op">~</span><span class="st">&quot;mean&quot;</span>) </code></pre>
<p><img src="Redoing_files/figure-html/ch09-compare-prioirs-1.png" width="65%" /></p>
<p>Using the mean rather than mode corresponds to an unfortunate prior on <span class="math inline">\(\theta_i\)</span>.</p>
</div>
</div>
<div id="shrinkage" class="section level2">
<h2><span class="header-section-number">9.7</span> Shrinkage</h2>
</div>
<div id="example-baseball-batting-average" class="section level2">
<h2><span class="header-section-number">9.8</span> Example: Baseball Batting Average</h2>
</div>
<div id="ch09-exercises" class="section level2">
<h2><span class="header-section-number">9.9</span> Exerciess</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="jags-just-another-gibbs-sampler.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["Redoing.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
